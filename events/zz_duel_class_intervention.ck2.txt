namespace = zz_duel 

character_event = {
    id = zz_duel.1
    is_triggered_only = yes
    picture = GFX_evt_armory
    border = GFX_event_normal_frame_war

    desc = {
        text = EVTDESC_HFP_10096
    }

    
    option = {
        name = {
            text = EVTOPTA_WOL_11001 #Let's fight!
        }
        event_target:combatant_2 = {
            character_event = { id = zz_duel.3 } #Send hidden set-up of duel (from there: result)
        }
        ai_chance = {
            factor = 80
        }
    }

    option = { #
        name = {
            text = "Choose class options"
        }
        
        #FALLBACK:
        duel_engine_special_menu_setup = yes
        character_event = { id = zz_duel.2 }
    }
}


character_event = { 
    id = zz_duel.2
    desc = "EVTDESC_DUELACTION_2"
    picture = "GFX_evt_generic_duel"
    #border = GFX_event_normal_frame_war
    is_triggered_only = yes
    #This code executes everytime this event is called. It takes the current action number and adds two, and sets this variable to determine the three event options that should be selectable.
    immediate = { 
        set_variable = { which = "local_action_picked_plus_one" which = "local_action_picked"}
        change_variable = { which = "local_action_picked_plus_one" value = "1"}
        set_variable = { which = "local_action_picked_plus_two" which = "local_action_picked_plus_one"}
        change_variable = { which = "local_action_picked_plus_two" value = "1"}
        if = { 
            limit = { 
                check_variable = { which = local_action_picked_plus_one which > local_action_nr} 
            }
            set_variable = { which = local_action_picked_plus_one value = 1}
            set_variable = { which = local_action_picked_plus_two value = 2}
        }
        else_if = { 
            limit = {
                check_variable = { which = local_action_picked_plus_two which > local_action_nr} 
            }
            set_variable = { which = local_action_picked_plus_two value = 1}
        }
    }
    option = {
        name = "NEXT_ACTION"
        if = { 
            limit = { 
                check_variable = { which = "local_action_picked" which >= "local_action_nr" } 
            }
            set_variable = { which = "local_action_picked" value = 1 } # circular menu
            hidden_tooltip = { repeat_event = { id = zz_duel.2 }}
        }
        else_if = {
            limit = {  
                check_variable = { which = "local_action_picked" which < "local_action_nr" } 
            }
            change_variable = { which = "local_action_picked" value = 3 }
            if = { 
                limit = { 
                    check_variable = { which = "local_action_picked" which > "local_action_nr" } 
                }
                set_variable = { which = "local_action_picked" value = 1 } # circular menu
            }
            hidden_tooltip = { repeat_event = { id = zz_duel.2 }}
        }
        ai_chance = { factor = 1 }
    }
    option = {
        name = "I Fight as a Wizard"
        trigger = {
            check_variable = { which = "spells_wizard" value = 1}
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_wiz_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_wiz_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_wiz_book" }
            }
        }
        #hidden_tooltip = { 
            z_wiz_setup = yes
            subtract_variable = { which = "spells_wizard" value = 1}
            change_variable = { which = "wizxp" value = 15}
            set_character_flag = wizardduel
            set_variable = { which = dnum which = wcl_sp }
            z_d10 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_1_class
                which = classpcs
            }
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        #}
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_SORCERER_SPELLS"
        trigger = {
            check_variable = { which = "spells_sorcerer" value = 1}
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_sorc_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_sorc_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_sorc_book" }
            }
        }
        hidden_tooltip = { 
            z_sorc_setup = yes
            subtract_variable = { which = "spells_sorcerer" value = 1}
            change_variable = { which = "sorcxp" value = 15}
            set_character_flag = sorcererduel
            set_variable = { which = dnum which = scl_sp }
            z_d8 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_1_class
                which = classpcs
            }
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    }    
    option = {
        name = "ACTION_BARD_SPELLS"
        trigger = {
            check_variable = { which = "spells_bard" value = 1}
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_bard_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_bard_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_bard_book" }
            }
        }   
        hidden_tooltip = { 
            z_bard_setup = yes
            subtract_variable = { which = "spells_bard" value = 1}
            change_variable = { which = "bardxp" value = 15}
            set_character_flag = bardduel
            set_variable = { which = dnum which = bcl_sp }
            z_d4 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_1_class
                which = classpcs
            }
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_WARLOCK_SPELLS"
        trigger = {
            check_variable = { which = "spells_warlock" value = 1}
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_warl_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_warl_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_warl_book" }
            }
        }   
        hidden_tooltip = { 
            z_warl_setup = yes
            subtract_variable = { which = "spells_warlock" value = 1}
            change_variable = { which = "warlxp" value = 15}
            set_character_flag = warlockduel
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    } 
    option = {
        name = "ACTION_CLERIC_SPELLS"
        trigger = {
            check_variable = { which = "spells_cleric" value = 1}
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_cler_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_cler_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_cler_book" }
            }
        }   
        hidden_tooltip = { 
            z_cler_setup = yes
            subtract_variable = { which = "spells_cleric" value = 1}
            change_variable = { which = "clerxp" value = 15}
            set_character_flag = clericduel
            set_variable = { which = dnum which = ccl_sp }
            z_d6 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_1_class
                which = classpcs
            }
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_DRUID_SPELLS"
        trigger = {
            check_variable = { which = "spells_druid" value = 1}
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_drui_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_drui_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_drui_book" }
            }
        }   
        hidden_tooltip = { 
            z_drui_setup = yes
            subtract_variable = { which = "spells_druid" value = 1}
            change_variable = { which = "druixp" value = 15}
            set_character_flag = druidduel
            set_variable = { which = dnum which = dcl_sp }
            z_d4 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_1_class
                which = classpcs
            }
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_PALADIN_SPELLS"
        trigger = {
            check_variable = { which = "spells_paladin" value = 1}
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_pala_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_pala_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_pala_book" }
            }
        }   
        hidden_tooltip = { 
            z_pala_setup = yes
            subtract_variable = { which = "spells_paladin" value = 1}
            change_variable = { which = "palaxp" value = 15}
            set_character_flag = paladinduel
            set_variable = { which = dnum which = pcl_sp }
            z_d4 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_1_class
                which = classpcs
            }
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_FIGHTER_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_figh_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_figh_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_figh_book" }
            }
        }   
        hidden_tooltip = { 
            z_fighter_setup = yes
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_RANGER_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_rang_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_rang_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_rang_book" }
            }
        }   
        hidden_tooltip = { 
            z_ranger_setup = yes
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_BARBARIAN_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_barb_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_barb_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_barb_book" }
            }
        }   
        hidden_tooltip = { 
            z_barbarian_setup = yes
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_ROGUE_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_rogu_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_rogu_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_rogu_book" }
            }
        }   
        hidden_tooltip = { 
            z_rogue_setup = yes
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_ASSASSIN_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_assa_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_assa_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_assa_book" }
            }
        }   
        hidden_tooltip = { 
            z_assassin_setup = yes
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_SHADOW_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_shad_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_shad_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_shad_book" }
            }
        }   
        hidden_tooltip = { 
            z_shadow_setup = yes
            event_target:combatant_2 = {
                character_event = { id = zz_duel.3 }
            }
        }
        ai_chance = { factor = 0 }      
    }     
    #This action exits the special menu, and returns to the default duel action menu.
    option = {
        name = "ACTION_PREVIOUS_MENU"
        trigger = {
            or = {
                check_variable = { which = "local_action_picked" which == "local_d_action_previous_menu" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_d_action_previous_menu" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_d_action_previous_menu" }
            } 
        }
        hidden_tooltip = { character_event = { id = zz_duel.1 }}
        ai_chance = { factor = 0 }      
    } 
}



character_event = {
    id = zz_duel.3
    is_triggered_only = yes
    picture = GFX_evt_armory
    border = GFX_event_normal_frame_war

    desc = {
        text = EVTDESC_HFP_10096
    }

    
    option = {
        name = {
            text = EVTOPTA_WOL_11001 #Let's fight!
        }
        event_target:combatant_1 = {
            character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
        }
        ai_chance = {
            factor = 80
        }
    }

    option = { #
        name = {
            text = "Choose class options"
        }
        
        #FALLBACK:
        duel_engine_special_menu_setup = yes
        character_event = { id = zz_duel.4 } #Send hidden set-up of duel (from there: result)
        ai_chance = {
            factor = 0
        }
    }
}

character_event = { 
    id = zz_duel.4
    desc = "EVTDESC_DUELACTION_2"
    picture = "GFX_evt_generic_duel"
    #border = GFX_event_normal_frame_war
    is_triggered_only = yes
    #This code executes everytime this event is called. It takes the current action number and adds two, and sets this variable to determine the three event options that should be selectable.
    immediate = { 
        set_variable = { which = "local_action_picked_plus_one" which = "local_action_picked"}
        change_variable = { which = "local_action_picked_plus_one" value = "1"}
        set_variable = { which = "local_action_picked_plus_two" which = "local_action_picked_plus_one"}
        change_variable = { which = "local_action_picked_plus_two" value = "1"}
        if = { 
            limit = { 
                check_variable = { which = local_action_picked_plus_one which > local_action_nr} 
            }
            set_variable = { which = local_action_picked_plus_one value = 1}
            set_variable = { which = local_action_picked_plus_two value = 2}
        }
        else_if = { 
            limit = {
                check_variable = { which = local_action_picked_plus_two which > local_action_nr} 
            }
            set_variable = { which = local_action_picked_plus_two value = 1}
        }
    }
    option = {
        name = "NEXT_ACTION"
        if = { 
            limit = { 
                check_variable = { which = "local_action_picked" which >= "local_action_nr" } 
            }
            set_variable = { which = "local_action_picked" value = 1 } # circular menu
            hidden_tooltip = { repeat_event = { id = zz_duel.4 }}
        }
        else_if = {
            limit = {  
                check_variable = { which = "local_action_picked" which < "local_action_nr" } 
            }
            change_variable = { which = "local_action_picked" value = 3 }
            if = { 
                limit = { 
                    check_variable = { which = "local_action_picked" which > "local_action_nr" } 
                }
                set_variable = { which = "local_action_picked" value = 1 } # circular menu
            }
            hidden_tooltip = { repeat_event = { id = zz_duel.4 }}
        }
        ai_chance = { factor = 1 }
    }
    option = {
        name = "I Fight as a Wizard"
        trigger = {
            check_variable = { which = "spells_wizard" value = 1}
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_wiz_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_wiz_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_wiz_book" }
            }
        }
        #hidden_tooltip = { 
            z_wiz_setup = yes
            subtract_variable = { which = "spells_wizard" value = 1}
            set_character_flag = wizardduel
            set_variable = { which = dnum which = wcl_sp }
            z_d10 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_2_class
                which = classpcs
            }
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
        #}
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_SORCERER_SPELLS"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_sorc_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_sorc_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_sorc_book" }
            }
        }
        hidden_tooltip = { 
            z_sorc_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
            set_variable = { which = dnum which = scl_sp }
            z_d8 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_2_class
                which = classpcs
            }
        }
        ai_chance = { factor = 0 }      
    }    
    option = {
        name = "ACTION_BARD_SPELLS"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_bard_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_bard_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_bard_book" }
            }
        }   
        hidden_tooltip = { 
            z_bard_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
            set_variable = { which = dnum which = bcl_sp }
            z_d4 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_2_class
                which = classpcs
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_WARLOCK_SPELLS"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_warl_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_warl_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_warl_book" }
            }
        }   
        hidden_tooltip = { 
            z_warl_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
        }
        ai_chance = { factor = 0 }      
    } 
    option = {
        name = "ACTION_CLERIC_SPELLS"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_cler_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_cler_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_cler_book" }
            }
        }   
        hidden_tooltip = { 
            z_cler_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
            set_variable = { which = dnum which = ccl_sp }
            z_d6 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_2_class
                which = classpcs
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_DRUID_SPELLS"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_drui_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_drui_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_drui_book" }
            }
        }   
        hidden_tooltip = { 
            z_drui_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
            set_variable = { which = dnum which = dcl_sp }
            z_d6 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_2_class
                which = classpcs
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_PALADIN_SPELLS"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_pala_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_pala_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_pala_book" }
            }
        }   
        hidden_tooltip = { 
            z_pala_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
            set_variable = { which = dnum which = pcl_sp }
            z_d4 = yes
            set_variable = { 
                which = classpcs
                which = dresult
            }
            set_variable = { 
                which = local_combatant_2_class
                which = classpcs
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_FIGHTER_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_figh_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_figh_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_figh_book" }
            }
        }   
        hidden_tooltip = { 
            z_fighter_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_RANGER_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_rang_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_rang_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_rang_book" }
            }
        }   
        hidden_tooltip = { 
            z_ranger_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_BARBARIAN_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_barb_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_barb_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_barb_book" }
            }
        }   
        hidden_tooltip = { 
            z_barbarian_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_ROGUE_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_rogu_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_rogu_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_rogu_book" }
            }
        }   
        hidden_tooltip = { 
            z_rogue_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_ASSASSIN_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_assa_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_assa_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_assa_book" }
            }
        }   
        hidden_tooltip = { 
            z_assassin_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
        }
        ai_chance = { factor = 0 }      
    }
    option = {
        name = "ACTION_SHADOW_ABILITIES"
        trigger = {
            always = no
            or = {
                check_variable = { which = "local_action_picked" which == "local_m_action_shad_book" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_m_action_shad_book" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_m_action_shad_book" }
            }
        }   
        hidden_tooltip = { 
            z_shadow_setup = yes
            event_target:combatant_1 = {
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
            }
        }
        ai_chance = { factor = 0 }      
    }     
    #This action exits the special menu, and returns to the default duel action menu.
    option = {
        name = "ACTION_PREVIOUS_MENU"
        trigger = {
            or = {
                check_variable = { which = "local_action_picked" which == "local_d_action_previous_menu" } 
                check_variable = { which = "local_action_picked_plus_one" which == "local_d_action_previous_menu" }
                check_variable = { which = "local_action_picked_plus_two" which == "local_d_action_previous_menu" }
            } 
        }
        hidden_tooltip = { character_event = { id = zz_duel.3 }}
        ai_chance = { factor = 0 }      
    } 
}