# Faction tags need to start with 'faction_'

# Supported types:
# liege_titles, liege_titles_w_claimant, character

# The succession law factions have hard coded elements to ensure that the correct heir is shown in Plot and
# Faction interfaces and that AI faction members vote for laws in accordance with the faction goal.
# The valid tags correspond to the law name: faction_succ_seniority, faction_succ_primogeniture, etc.
# (faction_succ_ultimogeniture is fully supported by the code, but not currently implemented)

###############
# FACTIONS
###############

# Institute Succession by Seniority in Liege Title
faction_succ_seniority = {
	type = liege_titles

	warning_level = 0.70

	# Plotter scope
	potential = {
		is_landed = yes
		#NOT = { religion_group = muslim }
		higher_real_tier_than = BARON
		is_adult = yes
		independent = no
		prisoner = no
		is_incapable = no
		holy_order = no

		NOR = {
			in_faction = faction_succ_primogeniture
			in_faction = faction_succ_feudal_elective
			in_faction = faction_succ_gavelkind
			has_character_modifier = faction_succ_seniority_ultimatum_timer

			has_opinion_modifier = {
				name = opinion_coerced_into_leaving_faction
				who = liege
			}
		}

		liege = {
			is_feudal = yes
			is_vice_royalty = no

			NOR = {
				government = divine_feudal_government
				has_law = succ_magic_elective
				has_law = succ_magic_wizard
				has_law = succ_magic_warlock
			}

			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
		}

		trigger_if = {
			limit = { has_dlc = "Conclave" }

			OR = {
				is_voter = no
				#is_nomadic = yes
				is_tribal = yes

				liege = {
					NAND = {
						is_council_content = yes
						has_law = war_voting_power_1
					}
				}
			}
		}
		trigger_else_if = {
			limit = {
				# If affected by a Crown Law title not held by my liege
				crownlaw_title = {
					holder_scope = {
						NOT = { is_liege_of = ROOT }
					}
				}
			}

			crownlaw_title = {
				# The Crown Law title allows vassal infighting
				NOR = {
					has_law = crown_authority_2
					has_law = crown_authority_3
					has_law = crown_authority_4
				}
			}
		}
	}

	# Title scope
	# ROOT is title
	# FROM is faction creator
	allow = {
		is_law_potential = succ_seniority
		is_law_allowed = succ_seniority

		OR = {
			is_primary_holder_title = yes
			higher_real_tier_than = DUKE
		}

		NOR = {
			has_law = succ_seniority

			AND = {
				has_law = succession_voting_power_1
				has_law = succ_feudal_elective

				#OR = {
					#has_law = succ_feudal_elective
					#has_law = succ_hre_elective
				#}
			}
		}

		holder_scope = {
			NOT = {
				any_war = {
					war_title = ROOT
					using_cb = change_seniority_succession_law
				}
			}
		}
	}

	# Faction member scope
	# ROOT is joiner
	# FROM is target
	allow_join = {
		ROOT = {
			is_landed = yes
			#NOT = { religion_group = muslim }
			independent = no
			is_adult = yes
			prisoner = no
			is_incapable = no

			NOR = {
				in_faction = faction_succ_primogeniture
				in_faction = faction_succ_feudal_elective
				in_faction = faction_succ_gavelkind
				has_character_modifier = faction_succ_seniority_ultimatum_timer

				has_opinion_modifier = {
					name = opinion_coerced_into_leaving_faction
					who = liege
				}
			}

			trigger_if = {
				limit = { has_dlc = "Conclave" }

				OR = {
					is_voter = no
					#is_nomadic = yes
					is_tribal = yes

					liege = {
						NAND = {
							is_council_content = yes
							has_law = war_voting_power_1
						}
					}
				}
			}
		}
	}

	# AI creation weight
	# FROM is faction creator
	# ROOT is title scope
	chance = {
		factor = 1

		trigger = {
			would_be_heir_under_law = {
				who = FROM
				law = seniority
			}

			FROM = {
				in_seclusion = no
				preparing_invasion = no
				NOT = { is_married = liege }

				# To stay in the faction
				trigger_if = {
					limit = { leads_faction = faction_succ_seniority }

					opinion = {
						who = liege
						value < 75
					}
				}
				# To start the faction
				trigger_else = {
					opinion = {
						who = liege
						value < 50
					}
				}

				trigger_if = {
					limit = {
						OR = {
							trait = envious
							trait = deceitful
							trait = ambitious
						}
					}

					opinion = {
						who = liege
						value < 50
					}
				}
				trigger_else = {
					opinion = {
						who = liege
						value < 25
					}
				}
			}

			current_heir = {
				NOT = { character = FROM }
			}

		#	heir_under_seniority_law = {
		#		NOR = {
		#			ROOT = { current_heir = { character = PREV } }
		#			FROM = {
		#				opinion_diff = {
		#					first = liege
		#					second = PREV
		#					value = -25 # I don't like the pretender enough
		#					as_if_liege = yes
		#				}
		#			}
		#		}
		#	}
		}

		mult_modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}

		mult_modifier = {
			factor = 0.5

			holder_scope = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 1.5

			FROM = {
				opinion = {
					who = liege
					value < 0
				}
			}
		}

		mult_modifier = {
			factor = 2.0

			FROM = {
				opinion = {
					who = liege
					value < -50
				}
			}
		}

		mult_modifier = {
			factor = 4.0

			FROM = {
				opinion = {
					who = liege
					value < -75
				}
			}
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = content }
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}

		mult_modifier = {
			factor = 0.2
			FROM = { is_dumb_trigger = yes }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = just }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}

		mult_modifier = {
			factor = 3.0
			FROM = { is_evil_religion = yes }
		}

		mult_modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
	}

	# AI membership weight
	# ROOT is the prospective member
	# FROM is the faction leader
	# FROMFROM is the target title or character
	membership = {
		factor = 1

		trigger = {
			in_seclusion = no
			preparing_invasion = no

			# The following require spymaster coercion to overrule
			trigger_if = {
				limit = {
					OR = {
						in_faction = faction_succ_feudal_elective
						in_faction = faction_succ_primogeniture
						in_faction = faction_succ_gavelkind

						# I'm the current heir
						is_heir = FROMFROM

						# Hordes should have less problems with this type of faction until ca 1350
						#liege = {
						#	year < 1350
						#	has_horde_culture = yes
						#	culture = ROOT
						#	religion = ROOT
						#}

						# To stay in the faction
						trigger_if = {
							limit = { in_faction = faction_succ_seniority }

							opinion = {
								who = liege
								value >= 75
							}
						}
						# To join the faction
						trigger_else = {
							opinion = {
								who = liege
								value >= 50
							}
						}

						# Try to exclude people who should rather support a claimant
						# Remember: the faction leader is also the person who would inherit under this law
						FROM = {
							liege = {
								any_demesne_title = {
									OR = {
										is_primary_holder_title = yes
										higher_real_tier_than = DUKE
									}

									ROOT = {
										primary_title = {
											de_jure_liege_or_above = PREVPREV
										}
									}

									any_claimant = {
										religion = ROOT

										ROOT = {
											opinion_diff = {
												first = PREV
												second = liege
												value >= 10
												as_if_liege = yes
											}
										}
									}
								}
							}
						}

						FROMFROM = {
							heir_under_seniority_law = {
								ROOT = {
									# To stay in the faction
									trigger_if = {
										limit = { in_faction = faction_succ_seniority }

										opinion_diff = {
											first = liege
											second = PREV
											value >= 10
											as_if_liege = yes
										}
									}
									# To join the faction
									trigger_else = {
										opinion_diff = {
											first = liege
											second = PREV
											value >= -10 # I don't like the pretender enough
											as_if_liege = yes
										}
									}
								}
							}
						}

						trigger_if = {
							limit = {
								OR = {
									trait = envious
									trait = deceitful
									trait = ambitious
								}
							}

							opinion = {
								who = liege
								value >= 50
							}
						}
						trigger_else = {
							opinion = {
								who = liege
								value >= 25
							}
						}
					}
				}

				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			pacifist = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.5

			liege = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 1000

			has_opinion_modifier = {
				name = opinion_coerced_into_joining_faction
				who = FROM
			}
		}

		mult_modifier = {
			factor = 2

			#I like the seniority heir a LOT more than my liege
			FROMFROM = {
				heir_under_seniority_law = {
					ROOT = {
						opinion_diff = {
							first = PREV
							second = liege
							value >= 25
							as_if_liege = yes
						}
					}
				}
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = content

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = imbecile

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = inbred

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = craven

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			is_dumb_trigger = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.5
			trait = kind
		}

		mult_modifier = {
			factor = 0.5
			trait = charitable
		}

		mult_modifier = {
			factor = 0.5
			trait = honest
		}

		mult_modifier = {
			factor = 0.75
			trait = humble
		}

		mult_modifier = {
			factor = 0.75
			trait = just
		}

		mult_modifier = {
			factor = 1.5
			trait = proud
		}

		mult_modifier = {
			factor = 1.5
			trait = brave
		}

		mult_modifier = {
			factor = 1.5
			trait = arbitrary
		}

		mult_modifier = {
			factor = 2.0
			trait = envious
		}

		mult_modifier = {
			factor = 2.0
			trait = greedy
		}

		mult_modifier = {
			factor = 2.0
			trait = impaler
		}

		mult_modifier = {
			factor = 2.0
			trait = deceitful
		}

		mult_modifier = {
			factor = 3.0
			is_evil_religion = yes
		}

		mult_modifier = {
			factor = 4.0
			trait = ambitious
		}
	}

	success = {
		has_law = succ_seniority
	}

	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_succ_seniority

				reverse_opinion = {
					name = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}

	abort = {
		always = no	# Factions will abort if the Potential or Allow trigger is no longer valid
	}
}

# Institute Succession by Primogeniture
faction_succ_primogeniture = {
	type = liege_titles

	warning_level = 0.70

	# Plotter scope
	potential = {
		is_landed = yes
		#NOT = { religion_group = muslim }
		higher_real_tier_than = BARON
		is_adult = yes
		independent = no
		prisoner = no
		is_incapable = no
		holy_order = no

		NOR = {
			in_faction = faction_succ_seniority
			in_faction = faction_succ_feudal_elective
			in_faction = faction_succ_gavelkind
			has_character_modifier = faction_succ_primogeniture_ultimatum_timer

			has_opinion_modifier = {
				name = opinion_coerced_into_leaving_faction
				who = liege
			}
		}

		liege = {
			is_feudal = yes
			is_vice_royalty = no

			NOR = {
				government = divine_feudal_government
				has_law = succ_magic_elective
				has_law = succ_magic_wizard
				has_law = succ_magic_warlock
				government = democratic_feudal_government
			}

			# Hordes should have less problems with this type of faction until ca 1350
			#trigger_if = {
			#	limit = { has_horde_culture = yes }
			#
			#	NAND = {
			#		year < 1350
			#		culture = ROOT
			#		religion = ROOT
			#	}
			#}

			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
		}

		trigger_if = {
			limit = { has_dlc = "Conclave" }

			OR = {
				is_voter = no
				#is_nomadic = yes
				is_tribal = yes

				liege = {
					NAND = {
						is_council_content = yes
						has_law = war_voting_power_1
					}
				}
			}
		}
		trigger_else_if = {
			limit = {
				# If affected by a Crown Law title not held by my liege
				crownlaw_title = {
					holder_scope = {
						NOT = { is_liege_of = ROOT }
					}
				}
			}

			crownlaw_title = {
				# The Crown Law title allows vassal infighting
				NOR = {
					has_law = crown_authority_2
					has_law = crown_authority_3
					has_law = crown_authority_4
				}
			}
		}
	}

	# Target scope
	# ROOT is title
	# FROM is faction creator
	allow = {
		is_law_potential = succ_primogeniture
		is_law_allowed = succ_primogeniture

		OR = {
			is_primary_holder_title = yes
			higher_real_tier_than = DUKE
		}

		NOR = {
			has_law = succ_primogeniture

			trigger_if = {
				limit = { has_law = succession_voting_power_1 }
				has_law = succ_feudal_elective

				#OR = {
				#	has_law = succ_feudal_elective
				#	has_law = succ_hre_elective
				#}
			}
		}

		holder_scope = {
			NOT = {
				any_war = {
					war_title = ROOT
					using_cb = change_primogeniture_succession_law
				}
			}
		}
	}

	# Faction member scope
	# ROOT = joiner
	# FROM = target
	allow_join = {
		ROOT = {
			is_landed = yes
			#NOT = { religion_group = muslim }
			is_adult = yes
			independent = no
			prisoner = no
			is_incapable = no

			NOR = {
				in_faction = faction_succ_seniority
				in_faction = faction_succ_feudal_elective
				in_faction = faction_succ_gavelkind
				has_character_modifier = faction_succ_primogeniture_ultimatum_timer

				has_opinion_modifier = {
					name = opinion_coerced_into_leaving_faction
					who = liege
				}
			}

			trigger_if = {
				limit = { has_dlc = "Conclave" }

				OR = {
					is_voter = no
					#is_nomadic = yes
					is_tribal = yes

					liege = {
						NAND = {
							is_council_content = yes
							has_law = war_voting_power_1
						}
					}
				}
			}
		}
	}

	# AI creation weight
	# FROM is faction creator
	# ROOT is title scope
	chance = {
		factor = 1

		trigger = {
			would_be_heir_under_law = {
				who = FROM
				law = primogeniture
			}

			FROM = {
				in_seclusion = no
				preparing_invasion = no
				NOT = { is_married = liege }

				# To stay in the faction
				trigger_if = {
					limit = { leads_faction = faction_succ_primogeniture }

					opinion = {
						who = liege
						value < 75
					}
				}
				# To join the faction
				trigger_else = {
					opinion = {
						who = liege
						value < 50
					}
				}

				trigger_if = {
					limit = {
						OR = {
							trait = envious
							trait = deceitful
							trait = ambitious
						}
					}

					opinion = {
						who = liege
						value < 50
					}
				}
				trigger_else = {
					opinion = {
						who = liege
						value < 25
					}
				}
			}

			current_heir = {
				NOT = { character = FROM }
			}
		}

		mult_modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}

		mult_modifier = {
			factor = 0.5

			holder_scope = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 1.5

			FROM = {
				opinion = {
					who = liege
					value < 0
				}
			}
		}

		mult_modifier = {
			factor = 2.0

			FROM = {
				opinion = {
					who = liege
					value < -50
				}
			}
		}

		mult_modifier = {
			factor = 4.0

			FROM = {
				opinion = {
					who = liege
					value < -75
				}
			}
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = content }
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}

		mult_modifier = {
			factor = 0.2
			FROM = { is_dumb_trigger = yes }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = just }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}

		mult_modifier = {
			factor = 3.0
			FROM = { is_evil_religion = yes }
		}

		mult_modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
	}

	# AI membership weight
	# ROOT is the prospective member
	# FROM is the faction leader
	# FROMFROM is the target title or character
	membership = {
		factor = 1

		trigger = {
			in_seclusion = no
			preparing_invasion = no

			# The following require spymaster coercion to overrule
			trigger_if = {
				limit = {
					OR = {
						in_faction = faction_succ_feudal_elective
						in_faction = faction_succ_seniority
						in_faction = faction_succ_gavelkind

						# Hordes should have less problems with this type of faction until ca 1350
						#liege = {
						#	year < 1350
						#	has_horde_culture = yes
						#	culture = ROOT
						#	religion = ROOT
						#}

						# I'm the current heir
						is_heir = FROMFROM

						FROMFROM = {
							heir_under_primogeniture_law = {
								ROOT = {
									# To stay in the faction
									trigger_if = {
										limit = { in_faction = faction_succ_primogeniture }

										opinion_diff = {
											first = liege
											second = PREV
											value >= 10
											as_if_liege = yes
										}
									}
									# To join the faction
									trigger_else = {
										opinion_diff = {
											first = liege
											second = PREV
											value >= -10 # I don't like the pretender enough
											as_if_liege = yes
										}
									}
								}
							}
						}

						# To stay in the faction
						trigger_if = {
							limit = { in_faction = faction_succ_primogeniture }

							opinion = {
								who = liege
								value >= 75
							}
						}
						# To join the faction
						trigger_else = {
							opinion = {
								who = liege
								value >= 50
							}
						}

						trigger_if = {
							limit = {
								OR = {
									trait = envious
									trait = deceitful
									trait = ambitious
								}
							}

							opinion = {
								who = liege
								value >= 50
							}
						}
						trigger_else = {
							opinion = {
								who = liege
								value >= 25
							}
						}

						# Try to exclude people who should rather support a claimant
						# Remember: the faction leader is also the person who would inherit under this law
						AND = {
							FROMFROM = {
								heir_under_primogeniture_law = {
									NAND = {
										culture = ROOT
										religion = ROOT
									}
								}
							}

							liege = {
								any_demesne_title = {
									OR = {
										is_primary_holder_title = yes
										higher_real_tier_than = DUKE
									}

									ROOT = {
										primary_title = {
											de_jure_liege_or_above = PREVPREV
										}
									}

									any_claimant = {
										culture = ROOT
										religion = ROOT
									}
								}
							}
						}
					}
				}

				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 1000

			has_opinion_modifier = {
				name = opinion_coerced_into_joining_faction
				who = FROM
			}
		}

		mult_modifier = {
			factor = 0.5

			liege = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			pacifist = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 2

			# I like the primogeniture heir a LOT more than my liege
			FROMFROM = {
				heir_under_primogeniture_law = {
					ROOT = {
						opinion_diff = {
							first = PREV
							second = liege
							value >= 25
							as_if_liege = yes
						}
					}
				}
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = content

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = imbecile

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = inbred

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = craven

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			is_dumb_trigger = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.5
			trait = kind
		}

		mult_modifier = {
			factor = 0.5
			trait = charitable
		}

		mult_modifier = {
			factor = 0.5
			trait = honest
		}

		mult_modifier = {
			factor = 0.75
			trait = humble
		}

		mult_modifier = {
			factor = 0.75
			trait = just
		}

		mult_modifier = {
			factor = 1.5
			trait = proud
		}

		mult_modifier = {
			factor = 1.5
			trait = brave
		}

		mult_modifier = {
			factor = 1.5
			trait = arbitrary
		}

		mult_modifier = {
			factor = 2.0
			trait = envious
		}

		mult_modifier = {
			factor = 2.0
			trait = greedy
		}

		mult_modifier = {
			factor = 2.0
			trait = impaler
		}

		mult_modifier = {
			factor = 2.0
			trait = deceitful
		}

		mult_modifier = {
			factor = 3.0
			is_evil_religion = yes
		}

		mult_modifier = {
			factor = 4.0
			trait = ambitious
		}
	}

	success = {
		has_law = succ_primogeniture
	}

	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_succ_primogeniture

				reverse_opinion = {
					name = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}

	abort = {
		always = no	# Factions will abort if the Potential or Allow trigger is no longer valid
	}
}

# Institute Succession by Gavelkind
faction_succ_gavelkind = {
	type = liege_titles

	warning_level = 0.70

	# Plotter scope
	potential = {
		is_landed = yes
		higher_real_tier_than = BARON
		#NOT = { religion_group = muslim }
		is_adult = yes
		prisoner = no
		independent = no
		is_incapable = no
		holy_order = no

		NOR = {
			in_faction = faction_succ_seniority
			in_faction = faction_succ_primogeniture
			in_faction = faction_succ_feudal_elective
			has_character_modifier = faction_succ_gavelkind_ultimatum_timer

			has_opinion_modifier = {
				name = opinion_coerced_into_leaving_faction
				who = liege
			}
		}

		liege = {
			is_feudal = yes
			is_vice_royalty = no
			NOR = {
				government = divine_feudal_government
				has_law = succ_magic_elective
				has_law = succ_magic_wizard
				has_law = succ_magic_warlock
				government = democratic_feudal_government
			}

			# Hordes should have less problems with this type of faction until ca 1350
			#trigger_if = {
			#	limit = { has_horde_culture = yes }
			#
			#	NAND = {
			#		year < 1350
			#		culture = ROOT
			#		religion = ROOT
			#	}
			#}

			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
		}

		trigger_if = {
			limit = { has_dlc = "Conclave" }

			OR = {
				is_voter = no
				#is_nomadic = yes
				is_tribal = yes

				liege = {
					NAND = {
						is_council_content = yes
						has_law = war_voting_power_1
					}
				}
			}
		}
		trigger_else_if = {
			limit = {
				# If affected by a Crown Law title not held by my liege
				crownlaw_title = {
					holder_scope = {
						NOT = { is_liege_of = ROOT }
					}
				}
			}

			crownlaw_title = {
				# The Crown Law title allows vassal infighting
				NOR = {
					has_law = crown_authority_2
					has_law = crown_authority_3
					has_law = crown_authority_4
				}
			}
		}
	}

	# Target scope
	# ROOT is title
	# FROM is faction creator
	allow = {
		is_law_potential = succ_gavelkind
		is_law_allowed = succ_gavelkind

		OR = {
			is_primary_holder_title = yes
			higher_real_tier_than = DUKE
		}

		NOR = {
			has_law = succ_gavelkind

			AND = {
				has_law = succession_voting_power_1
				has_law = succ_feudal_elective

				#OR = {
				#	has_law = succ_feudal_elective
				#	has_law = succ_hre_elective
				#}
			}
		}

		holder_scope = {
			NOT = {
				any_war = {
					war_title = ROOT
					using_cb = change_gavelkind_succession_law
				}
			}
		}
	}

	# Faction member scope
	# ROOT is joiner
	# FROM is target
	allow_join = {
		ROOT = {
			is_landed = yes
			#NOT = { religion_group = muslim }
			is_adult = yes
			independent = no
			prisoner = no
			is_incapable = no

			NOR = {
				in_faction = faction_succ_seniority
				in_faction = faction_succ_primogeniture
				in_faction = faction_succ_feudal_elective
				has_character_modifier = faction_succ_gavelkind_ultimatum_timer

				has_opinion_modifier = {
					name = opinion_coerced_into_leaving_faction
					who = liege
				}
			}

			trigger_if = {
				limit = { has_dlc = "Conclave" }

				OR = {
					is_voter = no
					is_tribal = yes
					#is_nomadic = yes

					liege = {
						NAND = {
							is_council_content = yes
							has_law = war_voting_power_1
						}
					}
				}
			}
		}
	}

	# AI creation weight
	# FROM is faction creator
	# ROOT is title scope
	chance = {
		factor = 1

		trigger = {
			FROM = {
				in_seclusion = no
				preparing_invasion = no
				NOT = { is_married = liege }

				# To keep leading the faction
				trigger_if = {
					limit = { leads_faction = faction_succ_gavelkind }

					opinion = {
						who = liege
						value < 75
					}
				}
				# To create the faction
				trigger_else = {
					opinion = {
						who = liege
						value < 50
					}
				}

				trigger_if = {
					limit = {
						OR = {
							trait = envious
							trait = deceitful
							trait = ambitious
						}
					}

					opinion = {
						who = liege
						value < 50
					}
				}
				trigger_else = {
					opinion = {
						who = liege
						value < 25
					}
				}
			}

			current_heir = {
				NOT = { character = FROM }
			}

			holder_scope = {
				# Try to exclude people who should rather support a claimant
				trigger_if = {
					limit = {
						NAND = {
							culture = FROM
							religion = FROM
						}
					}

					any_demesne_title = {
						OR = {
							is_primary_holder_title = yes
							higher_real_tier_than = DUKE
						}

						FROM = {
							primary_title = {
								de_jure_liege_or_above = PREVPREV
							}
						}

						any_claimant = {
							culture = FROM
							religion = FROM
						}
					}
				}
			}

			trigger_if = {
				limit = {
					has_law = succ_feudal_elective
					#OR = {
					#	has_law = succ_feudal_elective
					#	has_law = succ_hre_elective
					#}
				}

				holder_scope = {
					NOT = { dynasty = FROM }
				}
			}
		}

		# mult_modifier = { # Removed, we want Vassals to start Gavelkind factions in general
		#	factor = 0
		#	# Is not a child of the title holder, and no need to split the demesne
		#	holder_scope = {
		#		NOT = {
		#			any_demesne_title = {
		#				tier = PREVPREV
		#				NOT = { title = PREVPREV }
		#			}
		#		}
		#		FROM = {
		#			OR = {
		#				NOT = { is_child_of = PREV }
		#				trait = bastard
		#				AND = {
		#					is_female = yes
		#					is_pretender = no
		#				}
		#			}
		#		}
		#	}
		# }

		mult_modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}

		mult_modifier = {
			factor = 0.5

			holder_scope = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 4

			FROM = {
				is_voter = yes

				liege = {
					has_council = yes

					primary_title = {
						NOR = {
							has_law = law_voting_power_1
							has_law = banish_voting_power_1
							has_law = execution_voting_power_1
							has_law = revoke_title_voting_power_1
							has_law = grant_title_voting_power_1
							has_law = imprison_voting_power_1
							has_law = war_voting_power_1
						}
					}
				}
			}
		}

		mult_modifier = {
			factor = 1.5

			FROM = {
				opinion = {
					who = liege
					value < 0
				}
			}
		}

		mult_modifier = {
			factor = 2.0

			FROM = {
				opinion = {
					who = liege
					value < -50
				}
			}
		}

		mult_modifier = {
			factor = 4.0

			FROM = {
				opinion = {
					who = liege
					value < -75
				}
			}
		}

		mult_modifier = {
			factor = 4.0
			FROM = { is_pretender = yes }
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = content }
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}

		mult_modifier = {
			factor = 0.2
			FROM = { is_dumb_trigger = yes }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = just }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}

		mult_modifier = {
			factor = 3.0
			FROM = { is_evil_religion = yes }
		}

		mult_modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
	}

	# AI membership weight
	# ROOT is the prospective member
	# FROM is the faction leader
	# FROMFROM is the target title or character
	membership = {
		factor = 1

		trigger = {
			in_seclusion = no
			preparing_invasion = no

			# The following require spymaster coercion to overrule
			trigger_if = {
				limit = {
					OR = {
						in_faction = faction_succ_feudal_elective
						in_faction = faction_succ_seniority
						in_faction = faction_succ_primogeniture

						# I'm the current heir
						is_heir = FROMFROM

						# Hordes should have less problems with this type of faction until ca 1350
						liege = {
							year < 1350
							has_horde_culture = yes
							culture = ROOT
							religion = ROOT
						}

						# To stay in the faction
						trigger_if = {
							limit = { in_faction = faction_succ_gavelkind }

							opinion_diff = {
								first = liege
								second = FROM
								value >= 25
								as_if_liege = yes
							}
						}
						# To join the faction
						trigger_else = {
							opinion_diff = {
								first = liege
								second = FROM
								value >= 10 # I like my liege rather a lot more than the faction leader
								as_if_liege = yes
							}
						}

						# To stay in the faction
						trigger_if = {
							limit = { in_faction = faction_succ_gavelkind }

							opinion = {
								who = liege
								value >= 75
							}
						}
						# To join the faction
						trigger_else = {
							opinion = {
								who = liege
								value >= 50
							}
						}

						trigger_if = {
							limit = {
								OR = {
									trait = envious
									trait = deceitful
									trait = ambitious
								}
							}

							opinion = {
								who = liege
								value < 50
							}
						}
						trigger_else = {
							opinion = {
								who = liege
								value < 25
							}
						}
					}
				}

				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.5

			liege = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			pacifist = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 4

			is_voter = yes

			liege = {
				has_council = yes

				primary_title = {
					NOR = {
						has_law = law_voting_power_1
						has_law = banish_voting_power_1
						has_law = execution_voting_power_1
						has_law = revoke_title_voting_power_1
						has_law = grant_title_voting_power_1
						has_law = imprison_voting_power_1
						has_law = war_voting_power_1
					}
				}
			}
		}

		mult_modifier = {
			factor = 1000

			has_opinion_modifier = {
				name = opinion_coerced_into_joining_faction
				who = FROM
			}
		}

		mult_modifier = {
			factor = 2.0

			opinion_diff = {
				first = FROM
				second = liege
				value >= 25
				as_if_liege = yes
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = content

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = imbecile

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = inbred

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = craven

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			is_dumb_trigger = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.5
			trait = kind
		}

		mult_modifier = {
			factor = 0.5
			trait = charitable
		}

		mult_modifier = {
			factor = 0.5
			trait = honest
		}

		mult_modifier = {
			factor = 0.75
			trait = humble
		}

		mult_modifier = {
			factor = 0.75
			trait = just
		}

		mult_modifier = {
			factor = 1.5
			trait = proud
		}

		mult_modifier = {
			factor = 1.5
			trait = brave
		}

		mult_modifier = {
			factor = 1.5
			trait = arbitrary
		}

		mult_modifier = {
			factor = 2.0
			trait = envious
		}

		mult_modifier = {
			factor = 2.0
			trait = greedy
		}

		mult_modifier = {
			factor = 2.0
			trait = impaler
		}

		mult_modifier = {
			factor = 2.0
			trait = deceitful
		}

		mult_modifier = {
			factor = 3.0
			is_evil_religion = yes
		}

		mult_modifier = {
			factor = 4.0
			trait = ambitious
		}
	}

	success = {
		has_law = succ_gavelkind
	}

	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_succ_gavelkind

				reverse_opinion = {
					name = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}

	abort = {
		always = no	# Factions will abort if the Potential or Allow trigger is no longer valid
	}
}

# Institute Succession by Feudal Elective
faction_succ_feudal_elective = {
	type = liege_titles

	warning_level = 0.70

	# Plotter scope
	potential = {
		is_landed = yes
		higher_real_tier_than = BARON
		#NOT = { religion_group = muslim }
		is_adult = yes
		independent = no
		prisoner = no
		is_incapable = no
		holy_order = no

		NOR = {
			in_faction = faction_succ_seniority
			in_faction = faction_succ_primogeniture
			in_faction = faction_succ_gavelkind
			has_character_modifier = faction_succ_feudal_elective_ultimatum_timer

			has_opinion_modifier = {
				name = opinion_coerced_into_leaving_faction
				who = liege
			}
		}

		liege = {
			is_feudal = yes
			is_vice_royalty = no
			NOR = {
				government = divine_feudal_government
				government = chinese_imperial_government
			}

			#trigger_if = {
			#	limit = { has_dlc = "Conclave" }
			#
			#	primary_title = {
			#		OR = {
			#			title = e_hre
			#			has_title_flag = alternate_hre
			#
			#			AND = {
			#				has_law = law_voting_power_1
			#				has_law = banish_voting_power_1
			#				has_law = execution_voting_power_1
			#				has_law = revoke_title_voting_power_1
			#				has_law = grant_title_voting_power_1
			#				has_law = imprison_voting_power_1
			#				has_law = war_voting_power_1
			#			}
			#		}
			#	}
			#}

			# Hordes should have less problems with this type of faction until ca 1350
			#trigger_if = {
			#	limit = { has_horde_culture = yes }
			#
			#	NAND = {
			#		year < 1350
			#		culture = ROOT
			#		religion = ROOT
			#	}
			#}

			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
		}

		trigger_if = {
			limit = { has_dlc = "Conclave" }

			OR = {
				is_voter = no

				liege = {
					OR = {
						is_council_content = no
						NOT = { has_law = war_voting_power_1 }

						#primary_title = {
						#	OR = {
						#		title = e_hre
						#		has_title_flag = alternate_hre
						#	}
						#}
					}
				}
			}
		}
		trigger_else_if = {
			limit = {
				# If affected by a Crown Law title not held by my liege
				crownlaw_title = {
					holder_scope = {
						NOT = { is_liege_of = ROOT }
					}
				}
			}

			crownlaw_title = {
				# The Crown Law title allows vassal infighting
				NOR = {
					has_law = crown_authority_2
					has_law = crown_authority_3
					has_law = crown_authority_4
				}
			}
		}
	}

	# Target scope
	# ROOT is title
	# FROM is faction creator
	allow = {
		OR = {
			is_primary_holder_title = yes
			higher_real_tier_than = DUKE
		}

		OR = {
			AND = {
				is_law_potential = succ_feudal_elective
				is_law_allowed = succ_feudal_elective
			}

			#AND = {
			#	is_law_potential = succ_hre_elective
			#	is_law_allowed = succ_hre_elective
			#}
		}

		NOR = {
			has_law = succ_feudal_elective
			#has_law = succ_hre_elective

			AND = {
				has_law = succession_voting_power_1
				has_law = succ_feudal_elective

				#OR = {
				#	has_law = succ_feudal_elective
				#	has_law = succ_hre_elective
				#}
			}
		}

		holder_scope = {
			NOT = {
				any_war = {
					war_title = ROOT
					using_cb = change_feudal_elective_succession_law
				}
			}
		}

	}

	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			is_landed = yes
			#NOT = { religion_group = muslim }
			independent = no
			is_adult = yes
			prisoner = no
			is_incapable = no

			NOR = {
				in_faction = faction_succ_seniority
				in_faction = faction_succ_primogeniture
				in_faction = faction_succ_gavelkind
				has_character_modifier = faction_succ_feudal_elective_ultimatum_timer

				has_opinion_modifier = {
					name = opinion_coerced_into_leaving_faction
					who = liege
				}
			}

			trigger_if = {
				limit = { has_dlc = "Conclave" }

				OR = {
					is_voter = no
					is_tribal = yes
					#is_nomadic = yes

					liege = {
						OR = {
							is_council_content = no
							NOT = { has_law = war_voting_power_1 }

							#primary_title = {
							#	OR = {
							#		title = e_hre
							#		has_title_flag = alternate_hre
							#	}
							#}
						}
					}
				}
			}
		}
	}

	# AI creation weight
	# FROM is faction creator
	# ROOT is title scope
	chance = {
		factor = 1

		trigger = {
			# If next in line under seniority, create that faction instead
			NOT = {
				would_be_heir_under_law = {
					who = FROM
					law = seniority
				}
			}

			FROM = {
				in_seclusion = no
				preparing_invasion = no

				# To keep leading the faction
				trigger_if = {
					limit = { leads_faction = faction_succ_feudal_elective }

					opinion = {
						who = liege
						value >= 75
					}
				}
				# To creat the faction
				trigger_else = {
					opinion = {
						who = liege
						value >= 50
					}
				}

				trigger_if = {
					limit = {
						OR = {
							trait = envious
							trait = deceitful
							trait = ambitious
						}
					}

					opinion = {
						who = liege
						value < 50
					}
				}
				trigger_else = {
					opinion = {
						who = liege
						value < 25
					}
				}
			}

			# Not for the (spouse of) current heir
			current_heir = {
				NOR = {
					character = FROM
					is_married = FROM
				}
			}

			# Not for spouse/children of the current ruler
			holder_scope = {
				NOR = {
					is_married = FROM
					is_parent_of = FROM
				}

				# Try to exclude people who should rather support a claimant
				trigger_if = {
					limit = {
						NAND = {
							culture = FROM
							religion = FROM
						}
					}

					NOT = {
						any_demesne_title = {
							OR = {
								is_primary_holder_title = yes
								higher_real_tier_than = DUKE
							}

							FROM = {
								primary_title = {
									de_jure_liege_or_above = PREVPREV
								}
							}

							any_claimant = {
								culture = FROM
								religion = FROM
							}
						}
					}
				}
			}

			# Not for dynasty members if under seniority law
			trigger_if = {
				limit = { has_law = succ_seniority }

				holder_scope = {
					NOT = { dynasty = FROM }
				}
			}
		}

		#mult_modifier = {
		#	factor = 1.5
		#
		#	holder_scope = {
		#		primary_title = {
		#			OR = {
		#				title = e_hre
		#				has_title_flag = alternate_hre
		#			}
		#		}
		#	}
		#}

		mult_modifier = {
			factor = 0.5

			holder_scope = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}

		mult_modifier = {
			factor = 0.7
			FROM = {
				liege = {
					has_law = succ_gavelkind
				}
			}
		}

		mult_modifier = {
			factor = 0.7

			FROM = {
				NOR = {
					has_opinion_modifier = {
						name = opinion_evil_tyrant
						who = liege
					}

					has_opinion_modifier = {
						name = opinion_tyrant
						who = liege
					}
				}
			}
		}

		mult_modifier = {
			factor = 3

			FROM = {
				is_voter = yes

				liege = {
					has_council = yes
				}
			}
		}

		mult_modifier = {
			factor = 1.5

			FROM = {
				opinion = {
					who = liege
					value < 0
				}
			}
		}

		mult_modifier = {
			factor = 2.0

			FROM = {
				opinion = {
					who = liege
					value < -50
				}
			}
		}

		mult_modifier = {
			factor = 4.0

			FROM = {
				opinion = {
					who = liege
					value < -75
				}
			}
		}

		mult_modifier = {
			factor = 4.0
			FROM = { is_pretender = yes }
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = content }
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}

		mult_modifier = {
			factor = 0.2
			FROM = { is_dumb_trigger = yes }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = just }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}

		mult_modifier = {
			factor = 3.0
			FROM = { is_evil_religion = yes }
		}

		mult_modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
	}

	# AI membership weight
	# ROOT is the prospective member
	# FROM is the faction leader
	# FROMFROM is the target title or character
	membership = {
		factor = 1

		trigger = {
			in_seclusion = no
			preparing_invasion = no

			trigger_if = {
				limit = {
					OR = {
						in_faction = faction_succ_seniority
						in_faction = faction_succ_primogeniture
						in_faction = faction_succ_gavelkind

						# I'm the current heir
						is_heir = FROMFROM

						# To stay in the faction
						trigger_if = {
							limit = { in_faction = faction_succ_feudal_elective }

							opinion_diff = {
								first = liege
								second = FROM
								value >= 25
								as_if_liege = yes
							}
						}
						# To join the faction
						trigger_else = {
							opinion_diff = {
								first = liege
								second = FROM
								value >= 10 # I like my liege rather a lot more than the faction leader
								as_if_liege = yes
							}
						}

						# To stay in the faction
						trigger_if = {
							limit = { in_faction = faction_succ_feudal_elective }

							opinion = {
								who = liege
								value >= 75
							}
						}
						# To join the faction
						trigger_else = {
							opinion = {
								who = liege
								value >= 50
							}
						}

						# Hordes should have less problems with this type of faction until ca 1350
						#liege = {
						#	year < 1350
						#	has_horde_culture = yes
						#	culture = ROOT
						#	religion = ROOT
						#}

						trigger_if = {
							limit = {
								OR = {
									trait = envious
									trait = deceitful
									trait = ambitious
								}
							}

							opinion = {
								who = liege
								value >= 50
							}
						}
						trigger_else = {
							opinion = {
								who = liege
								value >= 25
							}
						}
					}
				}

				has_opinion_modifier = {
					name  = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.5

			liege = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			pacifist = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.7

			liege = {
				has_law = succ_gavelkind
			}
		}

		mult_modifier = {
			factor = 0.7

			NOR = {
				has_opinion_modifier = {
					name = opinion_evil_tyrant
					who = liege
				}

				has_opinion_modifier = {
					name = opinion_tyrant
					who = liege
				}
			}
		}

		mult_modifier = {
			factor = 3

			is_voter = yes

			liege = {
				has_council = yes
			}
		}

		mult_modifier = {
			factor = 1000

			has_opinion_modifier = {
				name = opinion_coerced_into_joining_faction
				who = FROM
			}
		}

		mult_modifier = {
			factor = 2.0

			opinion_diff = {
				first = FROM
				second = liege
				value >= 25
				as_if_liege = yes
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = content

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = imbecile

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = inbred

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = craven

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			is_dumb_trigger = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.5
			trait = kind
		}

		mult_modifier = {
			factor = 0.5
			trait = charitable
		}

		mult_modifier = {
			factor = 0.5
			trait = honest
		}

		mult_modifier = {
			factor = 0.75
			trait = humble
		}

		mult_modifier = {
			factor = 0.75
			trait = just
		}

		mult_modifier = {
			factor = 1.5
			trait = proud
		}

		mult_modifier = {
			factor = 1.5
			trait = brave
		}

		mult_modifier = {
			factor = 1.5
			trait = arbitrary
		}

		mult_modifier = {
			factor = 2.0
			trait = envious
		}

		mult_modifier = {
			factor = 2.0
			trait = greedy
		}

		mult_modifier = {
			factor = 2.0
			trait = impaler
		}

		mult_modifier = {
			factor = 2.0
			trait = deceitful
		}

		mult_modifier = {
			factor = 3.0
			is_evil_religion = yes
		}

		mult_modifier = {
			factor = 4.0
			trait = ambitious
		}
	}

	success = {
		has_law = succ_feudal_elective
		#OR = {
		#	has_law = succ_feudal_elective
		#	has_law = succ_hre_elective
		#}
	}

	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_succ_feudal_elective

				reverse_opinion = {
					name = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}

	abort = {
		always = no	# Factions will abort if the Potential or Allow trigger is no longer valid
	}
}

# Lower Crown Authority
faction_lower_crown_authority = {
	type = liege_titles

	warning_level = 0.70

	# Plotter scope
	potential = {
		is_landed = yes
		higher_real_tier_than = BARON
		is_adult = yes
		NOT = { has_dlc = "Conclave" }
		prisoner = no
		independent = no
		is_incapable = no
		holy_order = no

		NOR = {
			has_character_modifier = faction_lower_CA_ultimatum_timer

			has_opinion_modifier = {
				name = opinion_coerced_into_leaving_faction
				who = liege
			}
		}

		liege = {
			is_feudal = yes

			# Hordes should have less problems with this type of faction until ca 1350
			#trigger_if = {
			#	limit = { has_horde_culture = yes }
			#
			#	NAND = {
			#		year < 1350
			#		culture = ROOT
			#		religion = ROOT
			#	}
			#}

			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
		}
	}

	# Target scope
	# ROOT is title
	# FROM is faction creator
	allow = {
		higher_real_tier_than = DUKE

		trigger_if = {
			limit = { is_titular = yes }
			is_primary_holder_title = yes
		}

		NOT = { has_law = crown_authority_0 }

		holder_scope = {
			independent = yes

			NOT = {
				any_war = {
					war_title = ROOT
					using_cb = lower_crown_authority_law
				}
			}
		}
	}

	# Faction member scope
	# ROOT is joiner
	# FROM is target
	allow_join = {
		ROOT = {
			is_landed = yes
			is_adult = yes
			NOT = { has_dlc = "Conclave" }
			independent = no
			prisoner = no
			is_incapable = no

			NOR = {
				has_character_modifier = faction_lower_CA_ultimatum_timer

				has_opinion_modifier = {
					name = opinion_coerced_into_leaving_faction
					who = liege
				}
			}
		}
	}

	# AI creation weight
	# FROM is faction creator
	# ROOT is title scope
	chance = {
		factor = 1

		trigger = {
			FROM = {
				crownlaw_title = { title = ROOT }

				in_seclusion = no
				preparing_invasion = no
				NOT = { is_married = liege }

				trigger_if = {
					limit = {
						OR = {
							trait = envious
							trait = deceitful
							trait = ambitious
						}
					}

					opinion = {
						who = liege
						value < 50
					}
				}
				trigger_else = {
					opinion = {
						who = liege
						value < 25
					}
				}
			}

			current_heir = {
				NOT = { character = FROM }
			}

			holder_scope = {
				# Try to exclude people who should rather support a claimant
				trigger_if = {
					limit = {
						NAND = {
							culture = FROM
							religion = FROM
						}
					}

					NOT = {
						any_demesne_title = {
							OR = {
								is_primary_holder_title = yes
								higher_real_tier_than = DUKE
							}

							FROM = {
								primary_title = {
									de_jure_liege_or_above = PREVPREV
								}
							}

							any_claimant = {
								culture = FROM
								religion = FROM
							}
						}
					}
				}

				FROM = {
					NOT = {
						has_opinion_modifier = {
							name = opinion_lowered_crown_authority
							who = PREV
						}
					}
				}
			}
		}

		mult_modifier = {
			factor = 0.5

			holder_scope = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}

		mult_modifier = {
			factor = 0.1
			has_law = crown_authority_1
		}

		mult_modifier = {
			factor = 1.5
			has_law = crown_authority_3
		}

		mult_modifier = {
			factor = 2.25
			has_law = crown_authority_4
		}

		mult_modifier = {
			factor = 1.5

			FROM = {
				opinion = {
					who = liege
					value < -10
				}
			}
		}

		mult_modifier = {
			factor = 2.0

			FROM = {
				opinion = {
					who = liege
					value < -50
				}
			}
		}

		mult_modifier = {
			factor = 4.0

			FROM = {
				opinion = {
					who = liege
					value < -75
				}
			}
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = content }
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}

		mult_modifier = {
			factor = 0.2
			FROM = { is_dumb_trigger = yes }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = just }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}

		mult_modifier = {
			factor = 3.0
			FROM = { is_evil_religion = yes }
		}

		mult_modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
	}

	# AI membership weight
	# ROOT is the prospective member
	# FROM is the faction leader
	# FROMFROM is the target title or character
	membership = {
		factor = 1

		trigger = {
			in_seclusion = no
			preparing_invasion = no

			# The following require spymaster coercion to overrule
			trigger_if = {
				limit = {
					OR = {
						# I'm the current heir
						is_heir = FROMFROM

						# Doesn't affect me personally
						crownlaw_title = {
							NOT = { title = FROMFROM }
						}

						# I don't like the faction leader
						opinion = {
							who = FROM
							value >= -40
						}

						# I like my liege
						opinion = {
							who = liege
							value >= 25
						}

						# Hordes should have less problems with this type of faction until ca 1350
						#liege = {
						#	year < 1350
						#	has_horde_culture = yes
						#	culture = ROOT
						#	religion = ROOT
						#}
					}
				}

				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.5

			liege = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			pacifist = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 1000

			has_opinion_modifier = {
				name = opinion_coerced_into_joining_faction
				who = FROM
			}
		}

		mult_modifier = {
			factor = 1.5

			opinion = {
				who = liege
				value < -10
			}
		}

		mult_modifier = {
			factor = 2.0

			opinion = {
				who = liege
				value < -50
			}
		}

		mult_modifier = {
			factor = 4.0

			opinion = {
				who = liege
				value < -75
			}
		}

		mult_modifier = {
			factor = 0.1

			FROMFROM = {
				has_law = crown_authority_1
			}

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 1.5

			FROMFROM = {
				has_law = crown_authority_3
			}
		}

		mult_modifier = {
			factor = 2.25

			FROMFROM = {
				has_law = crown_authority_4
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = content

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = imbecile

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = inbred

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = craven

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			is_dumb_trigger = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.5
			trait = kind
		}

		mult_modifier = {
			factor = 0.5
			trait = charitable
		}

		mult_modifier = {
			factor = 0.5
			trait = honest
		}

		mult_modifier = {
			factor = 0.75
			trait = humble
		}

		mult_modifier = {
			factor = 0.75
			trait = just
		}

		mult_modifier = {
			factor = 1.5
			trait = proud
		}

		mult_modifier = {
			factor = 1.5
			trait = brave
		}

		mult_modifier = {
			factor = 1.5
			trait = arbitrary
		}

		mult_modifier = {
			factor = 2.0
			trait = envious
		}

		mult_modifier = {
			factor = 2.0
			trait = greedy
		}

		mult_modifier = {
			factor = 2.0
			trait = impaler
		}

		mult_modifier = {
			factor = 2.0
			trait = deceitful
		}

		mult_modifier = {
			factor = 3.0
			is_evil_religion = yes
		}

		mult_modifier = {
			factor = 4.0
			trait = ambitious
		}
	}

	success = {
		holder_scope = {
			FROM = {
				has_opinion_modifier = {
					name = opinion_lowered_crown_authority
					who = PREV
				}
			}
		}
	}

	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_lower_crown_authority

				reverse_opinion = {
					name = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}

	abort = {
		always = no	# Factions will abort if the Potential or Allow trigger is no longer valid
	}
}

# Lower Tribal Organization
faction_lower_tribal_organization = {
	type = liege_titles

	warning_level = 0.70

	# Plotter scope
	potential = {
		is_landed = yes
		higher_real_tier_than = BARON
		is_adult = yes
		independent = no
		prisoner = no
		is_incapable = no
		holy_order = no

		NOR = {
			has_character_modifier = faction_lower_TO_ultimatum_timer

			has_opinion_modifier = {
				name = opinion_coerced_into_leaving_faction
				who = liege
			}
		}

		liege = {
			is_tribal = yes
			independent = yes
			NOT = { government = nomadic_tribal_government } 

			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
		}

		trigger_if = {
			limit = { has_dlc = "Conclave" }

			OR = {
				is_voter = no
				#is_nomadic = yes

				liege = {
					NAND = {
						is_council_content = yes
						has_law = war_voting_power_1
					}
				}
			}
		}
		trigger_else = {
			AND = {
				is_tribal = yes
				NOT = { government = nomadic_tribal_government } 
			}
		}
	}

	# Target scope
	# ROOT is title
	# FROM is faction creator
	allow = {
		is_primary_holder_title = yes
		higher_real_tier_than = COUNT
		NOT = { has_law = tribal_organization_0 }

		holder_scope = {
			NOT = {
				any_war = {
					war_title = ROOT
					using_cb = lower_tribal_organization_law
				}
			}
		}
	}

	# Faction member scope
	# ROOT is joiner
	# FROM is target
	allow_join = {
		ROOT = {
			is_landed = yes
			is_adult = yes
			independent = no
			prisoner = no
			is_incapable = no

			trigger_if = {
				limit = { has_dlc = "Conclave" }

				OR = {
					is_voter = no
					#is_nomadic = yes

					liege = {
						NAND = {
							is_council_content = yes
							has_law = war_voting_power_1
						}
					}
				}
			}
			trigger_else = {
				AND = {
					is_tribal = yes
					NOT = { government = nomadic_tribal_government } 
				}
			}

			NOR = {
				has_character_modifier = faction_lower_TO_ultimatum_timer

				has_opinion_modifier = {
					name = opinion_coerced_into_leaving_faction
					who = liege
				}
			}
		}
	}

	# AI creation weight
	# FROM is faction creator
	# ROOT is title scope
	chance = {
		factor = 1

		trigger = {
			FROM = {
				dislike_tribal_organization = yes
				in_seclusion = no
				preparing_invasion = no
				NOT = { is_married = liege }

				trigger_if = {
					limit = {
						OR = {
							trait = envious
							trait = deceitful
							trait = ambitious
						}
					}

					opinion = {
						who = liege
						value < 50
					}
				}
				trigger_else = {
					opinion = {
						who = liege
						value < 25
					}
				}
			}

			holder_scope = {
				FROM = {
					NOT = {
						has_opinion_modifier = {
							name = opinion_lowered_tribal_organization
							who = PREV
						}
					}
				}

				# Try to exclude people who should rather support a claimant
				trigger_if = {
					limit = {
						NAND = {
							culture = FROM
							religion = FROM
						}
					}

					NOT = {
						any_demesne_title = {
							OR = {
								is_primary_holder_title = yes
								higher_real_tier_than = COUNT
							}

							FROM = {
								primary_title = {
									de_jure_liege_or_above = PREVPREV
								}
							}

							any_claimant = {
								culture = FROM
								religion = FROM
							}
						}
					}
				}
			}

			current_heir = {
				NOT = { character = FROM }
			}
		}

		mult_modifier = {
			factor = 0.5

			holder_scope = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}

		mult_modifier = {
			factor = 0.1
			has_law = tribal_organization_1
		}

		mult_modifier = {
			factor = 1.5
			has_law = tribal_organization_3
		}

		mult_modifier = {
			factor = 2.25
			has_law = tribal_organization_4
		}

		mult_modifier = {
			factor = 1.5

			FROM = {
				opinion = {
					who = liege
					value < -10
				}
			}
		}

		mult_modifier = {
			factor = 2.0

			FROM = {
				opinion = {
					who = liege
					value < -50
				}
			}
		}

		mult_modifier = {
			factor = 4.0

			FROM = {
				opinion = {
					who = liege
					value < -75
				}
			}
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = content }
		}

		mult_modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}

		mult_modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}

		mult_modifier = {
			factor = 0.2
			FROM = { is_dumb_trigger = yes }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}

		mult_modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}

		mult_modifier = {
			factor = 0.75
			FROM = { trait = just }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}

		mult_modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}

		mult_modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}

		mult_modifier = {
			factor = 3.0
			FROM = { is_evil_religion = yes }
		}

		mult_modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
	}

	# AI membership weight
	# ROOT is the prospective member
	# FROM is the faction leader
	# FROMFROM is the target title or character
	membership = {
		factor = 1

		trigger = {
			in_seclusion = no
			preparing_invasion = no

			# The following require spymaster coercion to overrule
			trigger_if = {
				limit = {
					OR = {
						dislike_tribal_organization = no

						# I'm the current heir
						is_heir = FROMFROM

						# don't like the faction leader
						opinion = {
							who = FROM
							value < -40
						}

						# I like my liege
						opinion = {
							who = liege
							value >= 25
						}
					}
				}

				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.5

			liege = {
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_less_factions
					bloodline_is_active_for = PREV
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			pacifist = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 1000

			has_opinion_modifier = {
				name = opinion_coerced_into_joining_faction
				who = FROM
			}
		}

		mult_modifier = {
			factor = 1.5

			opinion = {
				who = liege
				value < -10
			}
		}

		mult_modifier = {
			factor = 2.0

			opinion = {
				who = liege
				value < -50
			}
		}

		mult_modifier = {
			factor = 4.0

			opinion = {
				who = liege
				value < -75
			}
		}

		mult_modifier = {
			factor = 0.1

			FROMFROM = {
				has_law = tribal_organization_1
			}

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 1.5

			FROMFROM = {
				has_law = tribal_organization_3
			}
		}

		mult_modifier = {
			factor = 2.25
			FROMFROM = {
				has_law = tribal_organization_4
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = content

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.01

			trait = imbecile

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = inbred

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.1

			trait = craven

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.2

			is_dumb_trigger = yes

			NOT = {
				has_opinion_modifier = {
					name = opinion_coerced_into_joining_faction
					who = FROM
				}
			}
		}

		mult_modifier = {
			factor = 0.5
			trait = kind
		}

		mult_modifier = {
			factor = 0.5
			trait = charitable
		}

		mult_modifier = {
			factor = 0.5
			trait = honest
		}

		mult_modifier = {
			factor = 0.75
			trait = humble
		}

		mult_modifier = {
			factor = 0.75
			trait = just
		}

		mult_modifier = {
			factor = 1.5
			trait = proud
		}

		mult_modifier = {
			factor = 1.5
			trait = brave
		}

		mult_modifier = {
			factor = 1.5
			trait = arbitrary
		}

		mult_modifier = {
			factor = 2.0
			trait = envious
		}

		mult_modifier = {
			factor = 2.0
			trait = greedy
		}

		mult_modifier = {
			factor = 2.0
			trait = impaler
		}

		mult_modifier = {
			factor = 2.0
			trait = deceitful
		}

		mult_modifier = {
			factor = 3.0
			is_evil_religion = yes
		}

		mult_modifier = {
			factor = 4.0
			trait = ambitious
		}
	}

	success = {
		holder_scope = {
			FROM = {
				has_opinion_modifier = {
					name = opinion_lowered_tribal_organization
					who = PREV
				}
			}
		}
	}

	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_lower_tribal_organization

				reverse_opinion = {
					name = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}

	abort = {
		always = no	# Factions will abort if the Potential or Allow trigger is no longer valid
	}
}

# Independence
faction_independence = {
	type = character

	warning_level = 0.70

	# Plotter scope
	potential = {
		is_landed = yes
		higher_real_tier_than = BARON
		is_adult = yes
		independent = no
		prisoner = no
		is_incapable = no
		mercenary = no
		holy_order = no

		NOR = {
			has_character_modifier = faction_independence_ultimatum_timer
			#has_landed_title = k_orthodox

			has_opinion_modifier = {
				name = opinion_coerced_into_leaving_faction
				who = liege
			}
		}

		trigger_if = {
			limit = { ai = no }

			OR = {
				is_feudal = yes
				is_tribal = yes
				#is_nomadic = yes
				higher_real_tier_than = COUNT
			}
		}

		liege = {
			independent = yes

			NOT = {
				any_war = {
					using_cb = cb_faction_independence
				}
			}

			## Hordes should have less problems with this type of faction until ca 1350
			#trigger_if = {
			#	limit = { has_horde_culture = yes }
			#
			#	NAND = {
			#		year < 1350
			#		culture = ROOT
			#		religion = ROOT
			#	}
			#}

			# Not allowed to start factions like this if our capital borders the liege's capital
			NOT = {
				capital_scope = {
					any_neighbor_province = {
						ROOT = {
							capital_scope = {
								province = PREVPREV
							}
						}
					}
				}
			}

			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
		}

		trigger_if = {
			limit = { has_dlc = "Conclave" }

			OR = {
				is_voter = no
				#is_nomadic = yes
				is_tribal = yes

				liege = {
					OR = {
						is_council_content = no
						has_landed_title = e_shou_lung_west_governor
						NOT = { has_law = war_voting_power_1 }
					}
				}
			}
		}

		# Can't join factions when in blood oath with liege
		#trigger_if = {
		#	limit = { is_nomadic = yes }
		#
		#	NOT = { has_blood_oath_with = liege }
		#
		#	clan_opinion = {
		#		who = liege
		#		value < 0
		#	}
		#}

		# No independence factions in merchant republics
		trigger_if = {
			limit = { is_patrician = yes }

			liege = {
				is_merchant_republic = no
			}
		}
	}

	# Target scope
	allow = {
		prisoner = no
	}

	# Faction member scope
	# ROOT is joiner
	# FROM is target
	allow_join = {
		ROOT = {
			is_landed = yes
			is_adult = yes
			independent = no
			prisoner = no
			mercenary = no
			is_incapable = no

			NOR = {
				has_character_modifier = faction_independence_ultimatum_timer
				#has_landed_title = k_orthodox

				has_opinion_modifier = {
					name = opinion_coerced_into_leaving_faction
					who = liege
				}
			}

			trigger_if = {
				limit = { has_dlc = "Conclave" }

				OR = {
					is_voter = no
					#is_nomadic = yes
					is_tribal = yes

					liege = {
						OR = {
							is_council_content = no
							has_landed_title = e_shou_lung_west_governor
							NOT = { has_law = war_voting_power_1 }
						}
					}
				}
			}

			#trigger_if = {
			#	limit = { is_nomadic = yes }
			#
			#	clan_opinion = {
			#		who = liege
			#		value < 0
			#	}
			#
			#	NOT = { has_blood_oath_with = liege }
			#}

			# No independence factions in merchant republics
			trigger_if = {
				limit = { is_patrician = yes }

				liege = {
					is_merchant_republic = no
				}
			}
		}
	}

	# AI creation weight
	# ROOT is faction creator
	chance = {
		factor = 4
		
		modifier = {
			factor = 0.5
			liege = {  
				any_owned_bloodline = { 
					has_bloodline_flag = bloodline_less_factions 
					bloodline_is_active_for = PREV
				}
			}
		}
		modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}
		
		modifier = {
			factor = 0
			FROM = {
				has_character_modifier = in_seclusion
			}
		}
		
		modifier = {
			factor = 0
			war = yes
		}
		
		modifier = {
			factor = 0
			is_patrician = yes
			is_merchant_republic = no
		}
		
		modifier = {
			factor = 0
			liege = {
				religion = ROOT
				culture = ROOT
				OR = {
					NOT = { distance = { who = ROOT distance = 100 } }
					AND = {
						NOT = { distance = { who = ROOT distance = 200 } }
						ROOT = {
							OR = {
								NOT = { religion_group = pagan_group }
								is_reformed_religion = yes
							}
						}
						OR = {
							NOT = { ROOT = { religion_group = pagan_group } }
							ROOT = { is_reformed_religion = yes }
						}
					}
					AND = {
						de_jure_vassal_or_below = ROOT
						NOT = { ROOT = { tier = KING } }
					}
				}
			}
		}
		
		modifier = {
			factor = 0
			liege = {
				current_heir = {
					character = ROOT
				}
			}
		}
		
		modifier = {
			factor = 0
			lower_tier_than = KING
			OR = {
				NOT = { religion_group = pagan_group }
				is_reformed_religion = yes
			}
			liege = {
				culture_group = ROOT
				religion_group = ROOT
				OR = {
					religion = ROOT
					culture = ROOT
				}
				NOT = { distance = { who = ROOT distance = 200 } }
			}
		}
		
		# Try to exclude people who should rather support a claimant
		modifier = {
			factor = 0
			lower_tier_than = KING
			liege = {
				OR = {
					NOT = { culture = ROOT }
					NOT = { religion = ROOT }
				}
				any_demesne_title = {
					OR = {
						is_primary_holder_title = yes
						higher_tier_than = DUKE
					}
					ROOT = {
						primary_title = {
							de_jure_liege_or_above = PREVPREV
						}
					}
					any_claimant = {
						culture = ROOT
						religion = ROOT
					}
				}
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				AND = {
					NOT = { leads_faction = faction_independence }
					opinion = { who = LIEGE value = 60 }
				}
				AND = {
					leads_faction = faction_independence
					opinion = { who = LIEGE value = 80 } 
				}
			}
		}
		
		modifier = {
			factor = 0
			preparing_invasion = yes
		}
		
		modifier = {
			factor = 0.1
			OR = {
				NOT = { religion_group = pagan_group }
				is_reformed_religion = yes
			}
			liege = {
				NOT = { distance = { who = ROOT distance = 200 } }
			}
		}
		
		modifier = {
			factor = 0.25
			liege = {
				religion = ROOT
				culture = ROOT
			}
		}
		
		modifier = {
			factor = 1.5
			liege = {
				distance = { who = ROOT distance = 300 }
			}
		}
		modifier = {
			factor = 2.0
			liege = {
				distance = { who = ROOT distance = 400 }
			}
		}
		
		modifier = {
			factor = 2.0
			religion_group = pagan_group
			is_reformed_religion = no
		}
		
		modifier = {
			factor = 2.0
			liege = {
				NOT = { religion_group = ROOT }
			}
		}
		
		modifier = {
			factor = 1.5
			liege = {
				NOT = { culture_group = ROOT }
			}
		}
		
		modifier = {
			factor = 0.5
			opinion = { who = LIEGE value = 20 } 			
		}
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 40 } 
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}			
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -20 } } 
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } } 
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } } 
		}
		
		modifier = {
			factor = 0.025
			trait = content
		}
		modifier = {
			factor = 0.025
			trait = imbecile
		}
		modifier = {
			factor = 0.025
			trait = craven
		}
		modifier = {
			factor = 0.1
			trait = inbred
		}
		modifier = {
			factor = 0.1
			OR = {
				trait = slow
				trait = dull
			}
		}
		modifier = {
			factor = 0.5
			trait = kind
		}
		modifier = {
			factor = 0.5
			trait = charitable
		}
		modifier = {
			factor = 0.5
			trait = honest
		}
		modifier = {
			factor = 0.75
			trait = humble
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 3.0
			is_evil_religion = yes
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
		modifier = {
			factor = 1.5
			primary_title = {
				is_vice_royalty = yes
			}
		}
		modifier = {
			factor = 2
			OR = {
				has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
				has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
			}
		}
		modifier = { # More likely to want to go independent from the WP if China is unstable
			factor = 10.0
			liege = {
				government = celestial_bureaucracy
			}
			shou_lung = {
				NOR = {
					has_status = shou_lung_stable
					has_status = shou_lung_golden_age
				}
			}
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 4
		
		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = { 
						has_bloodline_flag = bloodline_less_factions 
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0.2
			pacifist = yes
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}		
		
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				trait = incapable
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		
		modifier = {
			factor = 0
			is_patrician = yes
			is_merchant_republic = no
		}
		
		modifier = {
			factor = 0
			liege = {
				religion = ROOT
				culture = ROOT
				OR = {
					NOT = { distance = { who = ROOT distance = 100 } }
					AND = {
						NOT = { distance = { who = ROOT distance = 200 } }
						ROOT = {
							OR = {
								NOT = { religion_group = pagan_group }
								is_reformed_religion = yes
							}
						}
					}
					AND = {
						de_jure_vassal_or_below = ROOT
						NOT = { ROOT = { tier = KING } }
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			lower_tier_than = KING
			OR = {
				NOT = { religion_group = pagan_group }
				is_reformed_religion = yes
			}
			liege = {
				culture_group = ROOT
				religion_group = ROOT
				OR = {
					religion = ROOT
					culture = ROOT
				}
				NOT = { distance = { who = ROOT distance = 200 } }
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			liege = {
				current_heir = {
					character = ROOT
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_character_modifier = faction_independence_ultimatum_timer
		}
		
		# Try to exclude people who should rather support a claimant
		modifier = {
			factor = 0
			
			liege = {
				OR = {
					NOT = { culture = ROOT }
					NOT = { religion = ROOT }
				}
				any_demesne_title = {
					OR = {
						is_primary_holder_title = yes
						higher_tier_than = DUKE
					}
					ROOT = {
						primary_title = {
							de_jure_liege_or_above = PREVPREV
						}
					}
					any_claimant = {
						culture = ROOT
						religion = ROOT
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				AND = {
					NOT = { in_faction = faction_independence }
					opinion = { who = LIEGE value = 60 }
				}
				AND = {
					in_faction = faction_independence
					opinion = { who = LIEGE value = 80 }
				}
			}
			
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			liege = { 
				NOT = { year = 1350 }
				primary_title = { is_tribal_type_title = yes }
				culture = ROOT
				religion = ROOT
			}
		}
		
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}
		
		modifier = {
			factor = 0
			
			# Won't join this type of faction if our capital borders the liege's capital
			liege = {
				capital_scope = {
					any_neighbor_province = {
						ROOT = {
							capital_scope = {
								province = PREVPREV
							}
						}
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		
		modifier = {
			factor = 0.1
			OR = {
				NOT = { religion_group = pagan_group }
				is_reformed_religion = yes
			}
			liege = {
				NOT = { distance = { who = ROOT distance = 200 } }
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		# Clans are very unlikely to join Independence factions led by non-nomads
		# modifier = {
			# factor = 0.01
			# is_nomadic = yes
			# FROM = {
				# is_nomadic = no
			# }
			# NOT = {	
				# has_opinion_modifier = {
					# who = FROM
					# modifier = opinion_coerced_into_joining_faction
				# }
			# }
		# }
		
		modifier = {
			factor = 0.25
			liege = {
				religion = ROOT
				culture = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 1.5
			liege = {
				distance = { who = ROOT distance = 300 }
			}
		}
		modifier = {
			factor = 2.0
			liege = {
				distance = { who = ROOT distance = 400 }
			}
		}
		
		modifier = {
			factor = 2.0
			religion_group = pagan_group
			is_reformed_religion = no
		}
		
		modifier = {
			factor = 2.0
			liege = {
				NOT = { religion_group = ROOT }
			}
		}
		
		modifier = {
			factor = 1.5
			liege = {
				NOT = { culture_group = ROOT }
			}
		}
		
		modifier = {
			factor = 0.5
			opinion = { who = LIEGE value = 20 } 
		}
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 40 } 
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}			
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -20 } } 
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } } 
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } } 
		}
		
		modifier = {
			factor = 0.025
			trait = content
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.025
			trait = imbecile
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.025
			trait = craven
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.5
			trait = kind
		}
		modifier = {
			factor = 0.5
			trait = charitable
		}
		modifier = {
			factor = 0.5
			trait = honest
		}
		modifier = {
			factor = 0.75
			trait = humble
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 3.0
			is_evil_religion = yes
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
		modifier = {
			factor = 2
			OR = {
				has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
				has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
			}
		}
		modifier = { # More likely to want to go independent from the WP if China is unstable
			factor = 10.0
			liege = {
				government = celestial_bureaucracy
			}
			shou_lung = {
				NOR = {
					has_status = shou_lung_stable
					has_status = shou_lung_golden_age
				}
			}
		}
	}
	
	success = {
		independent = yes
	}
	
	abort = {
		always = no
	}
	
	abort_effect = {
	}
	
	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_independence
				reverse_opinion = {
					modifier = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}
}

# Support Claimant to Liege Title
faction_claimant = {
	type = liege_titles_w_claimant # 'new_character' is a Claimant, or, if the title is Elective, anyone eligible for election
	exclusive = yes # Can only lead or be in one faction of this type
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	# Plotter scope
	potential = {
		prisoner = no
		is_ruler = yes
		independent = no
		is_landed = yes
		is_adult = yes
		primary_title = { holy_order = no }
		OR = {
			NOT = { has_dlc = "Zeus" }
			is_voter = no
			# is_nomadic = yes
			is_tribal = yes
			liege = { 
				OR = {
					is_council_content = no
					NOT = { primary_title = { has_law = war_voting_power_1 } }
					#has_council = no
				}
			}
		}
		NOT = { trait = incapable }
		liege = {
			is_vice_royalty = no
			OR = {
				is_feudal = yes
				is_tribal = yes
				# is_nomadic = yes
			}
			# OR = {
				# Hordes should have less problems with this type of faction until ca 1350
				# year = 1350
				# primary_title = { is_tribal = no }
				# NOT = { culture = ROOT }
				# NOT = { religion = ROOT }
			# }		
			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}			
		}
		primary_title = { higher_tier_than = BARON }
		
		OR = {
			# Is not affected by a Crown Law title
			NOT = {
				crownlaw_title = {
					always = yes
				}
			}
			
			# The Crown Law title holder is my liege
			crownlaw_title = {
				holder_scope = {
					ROOT = {
						liege = {
							character = PREVPREV
						}
					}
				}
			}
			
			# The Crown Law title allows vassal infighting
			crownlaw_title = {
				NOT = {
					OR = {
						has_law = crown_authority_2
						has_law = crown_authority_3
						has_law = crown_authority_4
					}
				}
			}
		}
		# OR = {
			# liege = {
				# is_nomadic = no
			# }
			# AND = {
				# liege = {
					# is_nomadic = yes
					# NOT = { has_blood_oath_with = PREV }
				# }
				# is_nomadic = yes
				# new_character = {
					# character = PREV
				# }
				# has_dlc = "Horse Lords"
			# }
		# }
		
		NOT = { has_character_modifier = faction_claimant_timer }
	}
	
	# Target scope
	allow = {
		OR = {
			is_primary_holder_title = yes
			higher_tier_than = DUKE
		}
		new_character = {
			NOT = { has_landed_title = PREV }
			
			NOT = { is_vassal_or_below = FROM }
			
			OR = {
				same_realm = FROM
				FROM = {
					liege = { independent = yes }
				}
			}
			
			OR = {
				OR = {
					is_female = no
					AND = {
						#NOT = { is_muslim_trigger = yes } 
						NOT = { ROOT = { succ_law_title = { has_law = agnatic_succession } } }
						NOT = { has_religion_feature = religion_patriarchal }
					}
				}
				OR = {
					is_female = yes
					AND = {
						#NOT = { is_muslim_trigger = yes } 
						NOT = { ROOT = { succ_law_title = { has_law = enatic_succession } } }
						NOT = { has_religion_feature = religion_matriarchal }
					}
				}
			}
			
			OR = {
				ROOT = { has_law = succ_feudal_elective }
				ROOT = { has_law = succ_hre_elective }
				has_claim = ROOT
			}
			
			OR = {
				is_ruler = no
				primary_title = {
					OR = {
						is_primary_type_title = no # Static Mercs, the Pope, Holy Orders, etc
						higher_tier_than = ROOT
						tier = ROOT
					}
				}
			}

			ROOT = {
				holder_scope = {
					NOT = {
						defending_against_claimant = {
							character = PREVPREV
							title = ROOT
						}
					}
				}
			}

			OR = {
				is_ruler = no
				is_tribal = no
				AND = {
					is_tribal = yes
					FROM = {
						liege = { is_tribal = yes }
					}
				}
			}

		}

		NOT = {
			holder_scope = {
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_leaving_faction
				}
			}
		}
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			is_ruler = yes
			independent = no
			is_landed = yes
			is_adult = yes
			NOT = { trait = incapable }
			prisoner = no
			OR = {
				NOT = { has_dlc = "Zeus"}
				is_voter = no
				# is_nomadic = yes
				is_tribal = yes
				liege = { 
					OR = {
						is_council_content = no
						NOT = { primary_title = { has_law = war_voting_power_1 } }
						#has_council = no
					}
				}
			}
			
			# Can't join factions when in blood oath with liege
			# OR = {
				# is_nomadic = no
				# NOT = { has_dlc = "Horse Lords" }
				# liege = {
					# NOT = { has_blood_oath_with = PREV }
				# }
			# }
		}
	}
	
	# AI creation weight
	chance = {
		factor = 1
		
		modifier = {
			factor = 0.5
			FROM = {
				liege = {
					any_owned_bloodline = { 
						has_bloodline_flag = bloodline_less_factions 
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}	
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					prisoner = yes
					has_character_modifier = in_seclusion
				}
			}
		}
		
		modifier = {
			factor = 0
			holder_scope = {
				any_spouse = { character = FROM }
			}
		}
		
		# Will not install old women
		modifier = {
			factor = 0
			new_character = {
				is_female = yes
				age = 40
			}
		}
		
		# Will not install a parent of the current ruler's
		modifier = {
			factor = 0
			new_character = {
				FROM = {
					liege = {
						or = {
							is_father = PREVPREV
							is_mother = PREVPREV
						}
					}
				}
			}
		}
		
		modifier = { # Title does NOT have Elective and the current heir is me
			factor = 0
			NOT = { has_law = succ_feudal_elective }
			NOT = { has_law = succ_hre_elective }
			current_heir = {
				OR = {
					character = FROM
					ROOT = {
						new_character = {
							character = PREVPREV
						}
					}
				}
			}
		}
		
		modifier = { # Do not push non-dynasty claimants if liege is my dynasty
			factor = 0
			holder_scope = {
				dynasty = FROM
				religion = FROM
				culture = FROM
			}
			new_character = {
				NOT = { dynasty = FROM }
			}
		}
		
		modifier = {
			factor = 0
			new_character = {
				ROOT = {
					holder_scope = {
						is_child_of = PREVPREV
					}
				}
			}
		}
		
		#If claimaint's sex is incompatible with religious dogma.
		modifier = {
			factor = 0
			has_religion_feature = religion_patriarchal
			new_character = {
				is_female = yes
			}
		}
		modifier = {
			factor = 0
			has_religion_feature = religion_matriarchal
			new_character = {
				is_female = no
			}
		}
		#Or if vassal is under the yoke of the wrong kind of liege.
		modifier = {
			factor = 3
			has_religion_feature = religion_patriarchal
			FROM = {
				is_female = yes
			}
			new_character = {
				is_female = no
			}
		}
		modifier = {
			factor = 3
			has_religion_feature = religion_matriarchal
			FROM = {
				is_female = no
			}
			new_character = {
				is_female = yes
			}
		}
		modifier = {
			factor = 0
			new_character = {
				OR = { 
					NOT = { religion = FROM }
					NOT = { culture_group = FROM }
					trait = blinded
					trait = eunuch
					trait = incapable
					trait = imbecile
					trait = inbred
				}
			}
		}
		
		modifier = {
			factor = 0
			OR = { has_law = succ_hre_elective has_law = succ_feudal_elective }
			new_character = {
				character = FROM
				NOT = { trait = ambitious }
				NOT = { trait = deceitful }
				NOT = { trait = proud }
				NOT = { has_strong_claim = PREV }
			}
		}
		
		#modifier = {
		#	factor = 0
		#	NOT = { has_law = succ_feudal_elective }
		#	holder_scope = {
		#		culture_group = FROM
		#		religion = FROM
		#		
		#		any_war = {
		#			war_title = ROOT
		#			defender = { character = THIS } 
		#			attacker = {
		#				OR = {
		#					NOT = { culture_group = FROM }
		#					NOT = { religion = FROM }
		#				}
		#			}
		#		}
		#	}
		#}
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					AND = {
						NOT = { leads_faction = faction_claimant }
						opinion = { who = LIEGE value = 50 } 
					}
					AND = {
						leads_faction = faction_claimant
						opinion = { who = LIEGE value = 75 } 
					}
				}
			}
		}
		
		modifier = {
			factor = 0
			NOT = { new_character = { character = FROM } }
			FROM = {
				has_claim = ROOT
			}
		}
		
		modifier = {
			factor = 0
			NOT = { de_jure_vassal_or_below = FROM }
			holder_scope = {
				any_demesne_title = {
					is_primary_holder_title_tier = yes
					de_jure_vassal_or_below = FROM
					NOT = { title = ROOT }
				}
			}
		}
		
		modifier = {
			factor = 0
			is_conquered = yes
			#NOT = { conquest_culture = FROM }
			NOT = { new_character = { culture = FROM } }
		}
		
		modifier = {
			factor = 0
			NOT = {
				new_character = {
					character = FROM
				}
			}
			NOT = {
				new_character = {
					FROM = {
						OR = {
							AND = {
								NOT = { in_faction = faction_claimant }
								opinion_diff = {
									first = PREV
									second = LIEGE
									value = 5 # I like the Claimant more than the current ruler
									as_if_liege = yes
								}
							}
							AND = {
								in_faction = faction_claimant
								opinion_diff = {
									first = PREV
									second = LIEGE
									value = -25
									as_if_liege = yes
								}
							}
						}
					}
				}
			}
		}
		
		modifier = {
			factor = 0
			FROM = { preparing_invasion = yes }
		}
		
		modifier = {
			factor = 0.1
			is_conquered = yes
			NOT = { conquest_culture = FROM }
			holder_scope = {
				any_vassal = {
					NOT = { character = FROM }
					in_faction = faction_claimant
					faction_claimant = {
						new_character = {
							culture = FROM # If we are subjugated, tend to unite behind one single claimant
							FROM = {
								opinion_diff = {
									first = PREV
									second = LIEGE
									value = 10 # I like the Claimant more than the current ruler
									as_if_liege = yes
								}
							}
						}
					}
				}
			}
		}
		
		modifier = {
			factor = 0
			FROM = { 
				opinion = { who = LIEGE value = 25 } 
				NOR = {
					trait = deceitful
					trait = ambitious
					trait = envious
				}
			}
		}		
		
		modifier = {
			factor = 0
			FROM = {
				opinion = { who = LIEGE value = 50 } 
				OR = {
					trait = deceitful
					trait = ambitious
					trait = envious
				}			
			}
		}
		
		modifier = {
			factor = 0.7
			NAND = {
				has_dlc = "Zeus"
				OR = {
					has_religion_feature = religion_matriarchal
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_earthmother
					has_religion_feature = religion_feature_yuir
					has_law = status_of_women_4
					has_game_rule = {
						name = gender
						value = all
					}
				}
			}
			new_character = {
				is_female = yes
			}
		}
		
		modifier = {
			factor = 0.5
			new_character = {
				NOT = { age = 13 }
			}
		}
		
		modifier = {
			factor = 0.5
			new_character = {
				NOT = { age = 10 }
			}
		}
		
		modifier = {
			factor = 0.5
			new_character = {
				NOT = { age = 5 }
			}
		}
		
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = 0 } } }
		}
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = -25 } } }
		}
		modifier = {
			factor = 2.0
			NOT = { FROM = { opinion = { who = LIEGE value = -50 } } }
		}
		modifier = {
			factor = 4.0
			NOT = { FROM = { opinion = { who = LIEGE value = -75 } } }
		}
		
		modifier = {
			factor = 3.0
			new_character = {
				character = FROM
			}
		}
		
		modifier = {
			factor = 1.5
			new_character = {
				dynasty = FROM
			}
		}
		
		modifier = {
			factor = 4.0
			is_conquered = yes
			NOT = { conquest_culture = FROM }
			new_character = { culture = FROM }
		}
		
		modifier = {
			factor = 2.0
			holder_scope = {
				dynasty_realm_power = 0.25
			}
			new_character = {
				ROOT = {
					holder_scope = { 
						NOT = { dynasty = PREVPREV }
					}
				}
			}
		}
		modifier = {
			factor = 2.0
			holder_scope = {
				dynasty_realm_power = 0.4
			}
			new_character = {
				ROOT = {
					holder_scope = { 
						NOT = { dynasty = PREVPREV }
					}
				}
			}
		}
		
		modifier = {
			factor = 0.01
			FROM = { trait = content }
			OR = {
				is_conquered = no
				conquest_culture = FROM
			}
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = { 
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}
		modifier = {
			factor = 3.0
			FROM = { is_evil_religion = yes }
		}
		modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
		modifier = {
			factor = 5
			new_character = {
				same_society_as = FROM
			}
		}
		modifier = {
			factor = 2
			FROM = {
				OR = {
					has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
					has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
				}
			}
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1
		
		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = { 
						has_bloodline_flag = bloodline_less_factions 
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0.2
			pacifist = yes
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				trait = incapable
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		
		modifier = { # I do not join factions if I am the heir, unless the claimant is myself
			factor = 0
			FROMFROM = {
				current_heir = {
					character = ROOT
				}
			}
			new_character = {
				NOT = { character = ROOT }
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # If my liege is my dynasty, only push claimants of my dynasty
			factor = 0
			liege = {
				dynasty = ROOT
				religion = ROOT
				culture = ROOT
			}
			new_character = {
				NOT = { dynasty = ROOT }
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # Exclude heretics and obviously bad rulers
			factor = 0
			new_character = {
				OR = {
					NOT = { religion = ROOT }
					#NOT = { culture_group = ROOT }
					trait = blinded
					trait = eunuch
					trait = incapable
					trait = imbecile
					trait = inbred
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		#modifier = {
		#	factor = 0
		#	liege = {
		#		culture_group = ROOT
		#		religion = ROOT
		#		any_war = {
		#			war_title = FROMFROM
		#			defender = { character = THIS } 
		#			attacker = {
		#				OR = {
		#					NOT = { culture_group = ROOT }
		#					NOT = { religion = ROOT }
		#				}
		#			}
		#		}
		#	}
		#	NOT = {	
		#		has_opinion_modifier = {
		#			who = FROM
		#			modifier = opinion_coerced_into_joining_faction
		#		}
		#	}
		#}
		
		modifier = { # If the title is not my De Jure liege, and my liege holds my De Jure title, don't push claimants
			factor = 0
			FROMFROM = {
				NOT = { de_jure_vassal_or_below = ROOT }
				holder_scope = {
					any_demesne_title = {
						is_primary_holder_title_tier = yes
						de_jure_vassal_or_below = ROOT
						NOT = { title = PREVPREV }
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # If the title is conquered only push claimants of my exact culture
			factor = 0
			FROMFROM = {
				is_conquered = yes
			}
			NOT = { new_character = { culture = ROOT } }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # Lower chance of joining if I myself has a claim on the same title
			factor = 0.1
			FROMFROM = {
				claimed_by = ROOT
			}
			NOT = { new_character = { character = ROOT } }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_character_modifier = faction_claimant_timer
		}
		
		modifier = {
			factor = 0
			liege = { 
				NOT = { year = 1350 }
				primary_title = { is_tribal_type_title = yes }
				culture = ROOT
				religion = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 40 }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = { # If the claimant is not me, make sure I like the claimant more than my current liege
			factor = 0
			NOT = {
				new_character = {
					character = ROOT
				}
			}
			
			NOT = {
				new_character = {
					ROOT = {
						OR = {
							AND = {
								NOT = { in_faction = faction_claimant }
								opinion_diff = {
									first = PREV
									second = LIEGE
									value = 10 # I like the Claimant more than the current ruler
									as_if_liege = yes
								}
							}
							AND = {
								in_faction = faction_claimant
								opinion_diff = {
									first = PREV
									second = LIEGE
									value = -25
									as_if_liege = yes
								}
							}
						}
					}
				}
			}
			
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}
		
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		
		modifier = {
			factor = 3.0
			new_character = {
				character = ROOT
			}
		}
		
		modifier = {
			factor = 1.5
			new_character = {
				dynasty = ROOT
			}
		}
		
		modifier = {
			factor = 0.7
			NAND = {
				has_dlc = "Zeus"
				OR = {
					has_law = status_of_women_4
					has_religion_feature = religion_equal
					has_religion_feature = religion_feature_earthmother
					has_religion_feature = religion_feature_yuir
					has_religion_feature = religion_matriarchal
					has_game_rule = {
						name = gender
						value = all
					}
				}
			}
			new_character = {
				is_female = yes
				NOT = { character = ROOT }
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0.5
			new_character = {
				NOT = { age = 13 }
				NOT = { character = ROOT }
			}
		}
		
		modifier = {
			factor = 0.5
			new_character = {
				NOT = { age = 10 }
				NOT = { character = ROOT }
			}
		}
		
		modifier = {
			factor = 0.5
			new_character = {
				NOT = { age = 5 }
				NOT = { character = ROOT }
			}
		}
		
		modifier = {
			factor = 2.0
			new_character = {
				ROOT = {
					opinion_diff = {
						first = PREV
						second = LIEGE
						value = 20
						as_if_liege = yes
					}
				}
			}
		}
		
		modifier = {
			factor = 2.0
			new_character = {
				ROOT = {
					opinion_diff = {
						first = PREV
						second = LIEGE
						value = 30
						as_if_liege = yes
					}
				}
			}
		}
		
		modifier = {
			factor = 2.0
			new_character = {
				ROOT = {
					opinion_diff = {
						first = PREV
						second = LIEGE
						value = 40
						as_if_liege = yes
					}
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = content
			FROMFROM = {
				OR = {
					is_conquered = no
					conquest_culture = ROOT
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 2.0
			liege = {
				dynasty_realm_power = 0.25
			}
			new_character = {
				ROOT = {
					liege = { 
						NOT = { dynasty = PREVPREV }
					}
				}
			}
		}
		
		modifier = {
			factor = 2.0
			liege = {
				dynasty_realm_power = 0.4
			}
			new_character = {
				ROOT = {
					liege = { 
						NOT = { dynasty = PREVPREV }
					}
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 3.0
			is_evil_religion = yes
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
		modifier = {
			factor = 5
			FROMFROM = {
				new_character = {
					same_society_as = ROOT
				}
			}
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = 0 } }
		}
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -25 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		modifier = {
			factor = 2
			OR = {
				has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
				has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
			}
		}
	}
	
	success = {
		always = no
	}
	
	abort = {
		always = no		# Factions will abort if the Potential or Allow triggers are no longer valid
	}
	
	abort_effect = {
	}
	
	effect = {
	}
}

# Antiking Faction - removed

# Overthrow a weak Khan faction
faction_overthrow = {

	type = liege_titles
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	cancel_on_leader_death = yes # The faction will not automatically continue under a new leader
	
	# Plotter scope
	potential = {
		prisoner = no
		independent = no
		is_landed = yes
		is_adult = yes
		government = nomadic_tribal_government
		primary_title = { holy_order = no }
		OR = {
			NOT = { has_dlc = "Zeus" }
			is_voter = no
            government = nomadic_tribal_government
			is_tribal = yes
			liege = { 
				OR = {
					is_council_content = no
					NOT = { primary_title = { has_law = war_voting_power_1 } }
					government = nomadic_tribal_government 
					#has_council = no
				}
			}
		}
		NOT = { trait = incapable }
	}
	
	# Target scope
	allow = {
		is_primary_holder_title = yes


		holder_scope = {
			# independent = yes
			government = nomadic_tribal_government
			
			NOT = {
				OR = {
					reverse_has_opinion_modifier = {
						who = FROM
						modifier = opinion_coerced_into_leaving_faction
					}
				}
			}
		}
	}
	
	# If false, shows the faction entry for players, but disabled
	player_allow = {
		FROM = { government = nomadic_tribal_government }
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			independent = no
			is_landed = yes
			is_adult = yes
			# government = nomadic_tribal_government
			NOT = { trait = incapable }
			prisoner = no
			OR = {
				NOT = { has_dlc = "Zeus"}
				is_voter = no
				# is_nomadic = yes
				is_tribal = yes
				liege = { 
					OR = {
						is_council_content = no
						NOT = { primary_title = { has_law = war_voting_power_1 } }
						government = nomadic_tribal_government
						#has_council = no
					}
				}
			}
		}
	}	
	
	# AI creation weight
	chance = {
		factor = 1
		
		modifier = {
			factor = 0.5
			FROM = {
				liege = {
					any_owned_bloodline = { 
						has_bloodline_flag = bloodline_less_factions 
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}		
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					prisoner = yes
					has_character_modifier = in_seclusion
				}
			}
		}
		
		modifier = {
			factor = 0
			holder_scope = {
				any_spouse = { character = FROM }
			}
		}
		
		modifier = {
			factor = 0
			current_heir = {
				character = FROM
			}
		}
		
		modifier = {
			factor = 0
			FROM = { 
				opinion = { who = LIEGE value = 50 } 
				NOT = {
					trait = deceitful
					trait = ambitious
					trait = envious
				}
				liege = {
					NOT = { is_weak_trigger = yes }
					health = 4
				}
			}
		}		
		
		modifier = {
			factor = 0
			FROM = {
				opinion = { who = LIEGE value = 75 } 
				OR = {
					trait = deceitful
					trait = ambitious
					trait = envious
				}
				liege = {
					NOT = { is_weak_trigger = yes }
					health = 4
				}		
			}
		}

		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = -10 } } }
		}
		modifier = {
			factor = 2.0
			NOT = { FROM = { opinion = { who = LIEGE value = -50 } } }
		}
		modifier = {
			factor = 4.0
			NOT = { FROM = { opinion = { who = LIEGE value = -75 } } }
		}

		modifier = {
			factor = 0.25
			FROM = { opinion = { who = LIEGE value = 10 } }
		}
		modifier = {
			factor = 0.05
			FROM = { opinion = { who = LIEGE value = 50 } }
		}
		modifier = {
			factor = 0.01
			FROM = { opinion = { who = LIEGE value = 75 } }
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					trait = content
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					trait = imbecile
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					trait = inbred
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					OR = {
						trait = slow
						trait = dull
					}
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					trait = kind
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					trait = humble
				}
			}
		}

		modifier = {
			factor = 2
			FROM = {
				liege = {
					trait = craven
				}
			}
		}

		modifier = {
			factor = 3
			FROM = {
				liege = {
					is_weak_trigger = yes
				}
			}
		}

		modifier = {
			factor = 5
			FROM = {
				liege = {
					OR = {
					is_incapable = yes
					trait = infirm
					}
				}
			}
		}

		modifier = {
			factor = 0.01
			FROM = {
				liege = {
					OR = {
						trait = strong
						trait = robust
					}
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					NOT = { health = 5 }
				}
			}
		}

		modifier = {
			factor = 2
			FROM = {
				liege = {
					NOT = { health = 3 }
				}
			}
		}
		
		modifier = {
			factor = 0.01
			FROM = { trait = content }
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = { 
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = just }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}
		modifier = {
			factor = 3.0
			FROM = { is_evil_religion = yes }
		}
		modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1
		
		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = { 
						has_bloodline_flag = bloodline_less_factions 
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				trait = incapable
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		
		modifier = {
			factor = 0
			FROMFROM = {
				current_heir = {
					character = ROOT
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			NOT = { opinion = { who = FROM value = -40 } }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}
		
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 50 }
			liege = {
				NOT = { is_weak_trigger = yes }
				health = 4
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0.2
			pacifist = yes
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}	

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					trait = content
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					trait = imbecile
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					trait = inbred
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					OR = {
						trait = slow
						trait = dull
					}
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					trait = kind
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					trait = humble
				}
			}
		}

		modifier = {
			factor = 2
			FROM = {
				liege = {
					trait = craven
				}
			}
		}

		modifier = {
			factor = 3
			FROM = {
				liege = {
					is_weak_trigger = yes
				}
			}
		}

		modifier = {
			factor = 5
			FROM = {
				liege = {
					OR = {
					trait = infirm
					is_incapable = yes
					}
				}
			}
		}

		modifier = {
			factor = 0.01
			FROM = {
				liege = {
					OR = {
						trait = strong
						trait = robust
					}
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}

		modifier = {
			factor = 1.5
			FROM = {
				liege = {
					NOT = { health = 5 }
				}
			}
		}

		modifier = {
			factor = 2
			FROM = {
				liege = {
					NOT = { health = 3 }
				}
			}
		}
		
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -10 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		modifier = {
			factor = 0.25
			opinion = { who = LIEGE value = 10 }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.05
			opinion = { who = LIEGE value = 50 }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.01
			opinion = { who = LIEGE value = 75 }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0.01
			trait = content
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.5
			trait = kind
		}
		modifier = {
			factor = 0.5
			trait = charitable
		}
		modifier = {
			factor = 0.5
			trait = honest
		}
		modifier = {
			factor = 0.75
			trait = humble
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 3.0
			is_evil_religion = yes
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
	}
	
	success = {
		always = no
	}
	
	abort = {
		always = no
	}
	
	abort_effect = {
	}
	
	effect = {
	}
}

# Increase Council Power
faction_increase_council_power = {
	type = liege_titles
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	# Plotter scope
	potential = {
		has_dlc = "Zeus"
		prisoner = no
		is_ruler = yes
		independent = no
		is_landed = yes
		is_adult = yes
		primary_title = { holy_order = no }
		OR = {
			is_voter = no
			is_tribal = yes
			liege = { 
				OR = {
					is_council_content = no
					NOT = { primary_title = { has_law = war_voting_power_1 } }
				}
			}
		}
		NOT = { trait = incapable }
		liege = { 
			NOT = {
				# is_nomadic = yes
				government = nomadic_tribal_government
			}
			OR = {
				year = 1350
				primary_title = { is_tribal_type_title = no }
				NOT = { culture = ROOT }
				NOT = { religion = ROOT }
			}
			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}			
		}
		primary_title = { higher_tier_than = BARON }
		
		NOT = { has_character_modifier = faction_council_power_ultimatum_timer }
	}
	
	# Target scope
	allow = {
		higher_tier_than = COUNT
		is_primary_holder_title = yes
		holder_scope = {
			primary_title = {
				ROOT = {
					tier = PREV
				}
			}

			NOT = {
				any_vassal = {
					higher_tier_than = BARON
					NOT = {	character = FROM }
					num_of_faction_backers = {
						faction = faction_increase_council_power
						value = 0
					}
				}
			}
		}
		
		holder_scope = {
			primary_title = {
				OR = {
					has_law = law_voting_power_0
					has_law = banish_voting_power_0
					has_law = execution_voting_power_0
					has_law = revoke_title_voting_power_0
					has_law = grant_title_voting_power_0
					has_law = imprison_voting_power_0
					has_law = war_voting_power_0
				}
			}
			NOT = {
				any_war = {
					war_title = ROOT
					using_cb = increase_council_power_war
				}
			}
			
			NOT = {
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_leaving_faction
				}
			}
		}
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			is_ruler = yes
			independent = no
			is_landed = yes
			is_adult = yes
			NOT = { trait = incapable }
			prisoner = no
			NOT = { has_character_modifier = faction_council_power_ultimatum_timer }
			OR = {
				is_voter = no
				is_tribal = yes
				liege = { 
					OR = {
						is_council_content = no
						NOT = { primary_title = { has_law = war_voting_power_1 } }
					}
				}
			}
		}
	}		
	
	# AI creation weight
	chance = {
		factor = 1
		
		modifier = {
			factor = 0.5
			FROM = {
				liege = {
					any_owned_bloodline = { 
						has_bloodline_flag = bloodline_less_factions 
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}		
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					prisoner = yes
					has_character_modifier = in_seclusion
				}
			}
		}
		
		modifier = {
			factor = 0
			holder_scope = {
				any_spouse = { character = FROM }
			}
		}
		
		modifier = {
			factor = 0
			current_heir = {
				character = FROM
			}
		}
		
		# Try to exclude people who should rather support a claimant
		modifier = {
			factor = 0
			holder_scope = {
				OR = {
					NOT = { culture = FROM }
					NOT = { religion = FROM }
				}
				any_demesne_title = {
					OR = {
						is_primary_holder_title = yes
						higher_tier_than = DUKE
					}
					FROM = {
						primary_title = {
							de_jure_liege_or_above = PREVPREV
						}
					}
					any_claimant = {
						culture = FROM
						religion = FROM
					}
				}
			}
		}
		
		modifier = {
			factor = 0
			FROM = { preparing_invasion = yes }
		}
		
		modifier = {
			factor = 0
			FROM = { 
				opinion = { who = LIEGE value = 25 } 
				NOR = {
					trait = deceitful
					trait = ambitious
					trait = envious
				}
				is_voter = no
			}
		}		
		
		modifier = {
			factor = 0
			FROM = {
				opinion = { who = LIEGE value = 50 } 			
			}
		}
		
		modifier = {
			factor = 1.5
			FROM = { is_voter = yes }
			calc_true_if = {
				amount = 6
				NOT = { has_law = law_voting_power_1 }
				NOT = { has_law = banish_voting_power_1 }
				NOT = { has_law = execution_voting_power_1 }
				NOT = { has_law = revoke_title_voting_power_1 }
				NOT = { has_law = grant_title_voting_power_1 }
				NOT = { has_law = imprison_voting_power_1 }
				NOT = { has_law = war_voting_power_1 }
			}
		}
		
		modifier = {
			factor = 1.5
			FROM = { is_voter = yes }
			calc_true_if = {
				amount = 4
				NOT = { has_law = law_voting_power_1 }
				NOT = { has_law = banish_voting_power_1 }
				NOT = { has_law = execution_voting_power_1 }
				NOT = { has_law = revoke_title_voting_power_1 }
				NOT = { has_law = grant_title_voting_power_1 }
				NOT = { has_law = imprison_voting_power_1 }
				NOT = { has_law = war_voting_power_1 }
			}
		}
		
		modifier = {
			factor = 1.5
			FROM = { is_voter = yes }
			calc_true_if = {
				amount = 2
				NOT = { has_law = law_voting_power_1 }
				NOT = { has_law = banish_voting_power_1 }
				NOT = { has_law = execution_voting_power_1 }
				NOT = { has_law = revoke_title_voting_power_1 }
				NOT = { has_law = grant_title_voting_power_1 }
				NOT = { has_law = imprison_voting_power_1 }
				NOT = { has_law = war_voting_power_1 }
			}
		}

		modifier = {
			factor = 10
			FROM = {
				is_voter = yes
				has_position = malcontent
			}
		}
		
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = -10 } } }
		}
		modifier = {
			factor = 2.0
			NOT = { FROM = { opinion = { who = LIEGE value = -50 } } }
		}
		modifier = {
			factor = 4.0
			NOT = { FROM = { opinion = { who = LIEGE value = -75 } } }
		}
		
		modifier = {
			factor = 0.01
			FROM = { trait = content }
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = { 
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = just }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}
		modifier = {
			factor = 3.0
			FROM = { is_evil_religion = yes }
		}
		modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1			
		
		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = { 
						has_bloodline_flag = bloodline_less_factions 
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				trait = incapable
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		
		modifier = {
			factor = 0
			FROMFROM = {
				current_heir = {
					character = ROOT
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_character_modifier = faction_council_power_ultimatum_timer
		}
		
		modifier = {
			factor = 0
			NOT = { opinion = { who = FROM value = -40 } }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			liege = { 
				NOT = { year = 1350 }
				primary_title = { is_tribal_type_title = yes }
				culture = ROOT
				religion = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}
		
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 25 } 
			NOR = {
				trait = deceitful
				trait = ambitious
				trait = envious
			}
			is_voter = no
		}		
		
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = 50 } 
		}
		
		modifier = {
			factor = 2
			FROMFROM= {
				OR = {
					has_law = vassal_wars_law_1
					has_law = vassal_wars_law_2
				}
			}
		}
		
		modifier = {
			factor = 0.8
			is_voter = no
			FROMFROM = {
				calc_true_if = {
					amount = 2
					has_law = law_voting_power_1
					has_law = banish_voting_power_1
					has_law = execution_voting_power_1
					has_law = revoke_title_voting_power_1
					has_law = grant_title_voting_power_1
					has_law = imprison_voting_power_1
					has_law = war_voting_power_1
				}
			}
		}
		
		modifier = {
			factor = 0.5
			is_voter = no
			FROMFROM = {
				calc_true_if = {
					amount = 4
					has_law = law_voting_power_1
					has_law = banish_voting_power_1
					has_law = execution_voting_power_1
					has_law = revoke_title_voting_power_1
					has_law = grant_title_voting_power_1
					has_law = imprison_voting_power_1
					has_law = war_voting_power_1
				}
			}
		}
		
		modifier = {
			factor = 0.3
			is_voter = no
			FROMFROM = {
				calc_true_if = {
					amount = 6
					has_law = law_voting_power_1
					has_law = banish_voting_power_1
					has_law = execution_voting_power_1
					has_law = revoke_title_voting_power_1
					has_law = grant_title_voting_power_1
					has_law = imprison_voting_power_1
					has_law = war_voting_power_1
				}
			}
		}
		
		modifier = {
			factor = 1.5
			is_voter = yes
			FROMFROM = {
				calc_true_if = {
					amount = 6
					NOT = { has_law = law_voting_power_1 }
					NOT = { has_law = banish_voting_power_1 }
					NOT = { has_law = execution_voting_power_1 }
					NOT = { has_law = revoke_title_voting_power_1 }
					NOT = { has_law = grant_title_voting_power_1 }
					NOT = { has_law = imprison_voting_power_1 }
					NOT = { has_law = war_voting_power_1 }
				}
			}
		}
		
		modifier = {
			factor = 1.5
			is_voter = yes
			FROMFROM = {
				calc_true_if = {
					amount = 4
					NOT = { has_law = law_voting_power_1 }
					NOT = { has_law = banish_voting_power_1 }
					NOT = { has_law = execution_voting_power_1 }
					NOT = { has_law = revoke_title_voting_power_1 }
					NOT = { has_law = grant_title_voting_power_1 }
					NOT = { has_law = imprison_voting_power_1 }
					NOT = { has_law = war_voting_power_1 }
				}
			}
		}
		
		modifier = {
			factor = 1.5
			is_voter = yes
			FROMFROM = {
				calc_true_if = {
					amount = 2
					NOT = { has_law = law_voting_power_1 }
					NOT = { has_law = banish_voting_power_1 }
					NOT = { has_law = execution_voting_power_1 }
					NOT = { has_law = revoke_title_voting_power_1 }
					NOT = { has_law = grant_title_voting_power_1 }
					NOT = { has_law = imprison_voting_power_1 }
					NOT = { has_law = war_voting_power_1 }
				}
			}
		}

		modifier = {
			factor = 10
			is_voter = yes
			has_position = malcontent
		}
		
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -10 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		
		modifier = {
			factor = 0.01
			trait = content
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.5
			trait = kind
		}
		modifier = {
			factor = 0.5
			trait = charitable
		}
		modifier = {
			factor = 0.5
			trait = honest
		}
		modifier = {
			factor = 0.75
			trait = humble
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
	}
	
	success = {
		holder_scope = {
			FROM = {
				has_opinion_modifier = { who = PREV modifier = opinion_increased_council_power }
			}
		}
	}
	
	abort = {
	}
	
	abort_effect = {
	}
	
	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_increase_council_power
				reverse_opinion = {
					modifier = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}
}

# Powerful vassals overthrow their liege
faction_powerful_vassal_takeover = {
	type = liege_titles
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	# Plotter scope
	potential = {
		has_dlc = "Zeus"
		prisoner = no
		is_ruler = yes
		independent = no
		is_landed = yes
		is_adult = yes
		is_feudal = yes
		primary_title = { holy_order = no }
		OR = {
			is_voter = no
			liege = {
				OR = {
					is_council_content = no
					NOT = { primary_title = { has_law = war_voting_power_1 } }
				}
			}
		}
		NOT = { trait = incapable }
		liege = {
			is_feudal = yes
			NOT = { government = chinese_imperial_government }
			NOT = { controls_religion = yes }
			NOT = {
				any_demesne_title = {
					temporary = yes
				}
			}
		}
		primary_title = { higher_tier_than = BARON }
		
		NOT = { has_character_modifier = faction_powerful_vassal_takeover_ultimatum_timer }
	}
	
	# Target scope
	allow = {
		higher_tier_than = DUKE
		is_primary_holder_title = yes
		holder_scope = {
			primary_title = {
				ROOT = {
					tier = PREV
				}
			}

			NOT = {
				any_vassal = {
					higher_tier_than = COUNT
					NOT = {	character = FROM }
					num_of_faction_backers = {
						faction = faction_powerful_vassal_takeover
						value = 0
					}
				}
			}
		}
		
		holder_scope = {
			NOT = {
				any_war = {
					war_title = ROOT
					using_cb = powerful_vassal_takeover_war
				}
			}
			
			NOR = {
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_leaving_faction
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_replaced_bad_ruler
				}
			}
		}
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			is_ruler = yes
			independent = no
			is_landed = yes
			is_adult = yes
			NOT = { trait = incapable }
			prisoner = no
			NOT = { has_character_modifier = faction_powerful_vassal_takeover_ultimatum_timer }
			OR = {
				is_voter = no
				liege = { 
					OR = {
						is_council_content = no
						NOT = { primary_title = { has_law = war_voting_power_1 } }
						#has_council = no
					}
				}
			}
		}
	}		
	
	# AI creation weight
	chance = {
		factor = 1
		
		modifier = {
			factor = 0.5
			FROM = {
				liege = {
					any_owned_bloodline = { 
						has_bloodline_flag = bloodline_less_factions 
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0.2
			FROM = { pacifist = yes }
		}		

		modifier = {
			factor = 0
			FROM = {
				OR = {
					leads_faction = faction_claimant
					in_faction = faction_claimant 
				}
			}
		}	
		
		modifier = {
			factor = 0
			FROM = {
				OR = {
					prisoner = yes
					has_character_modifier = in_seclusion
				}
			}
		}
		
		modifier = {
			factor = 0
			holder_scope = {
				any_spouse = { character = FROM }
			}
		}
		
		modifier = {
			factor = 0
			current_heir = {
				character = FROM
			}
		}
		
		# Try to exclude people who should rather support a claimant
		modifier = {
			factor = 0
			holder_scope = {
				any_demesne_title = {
					OR = {
						is_primary_holder_title = yes
						higher_tier_than = DUKE
					}
					FROM = {
						primary_title = {
							de_jure_liege_or_above = PREVPREV
						}
					}
					any_claimant = {
						religion = FROM
						opinion_diff = {
							first = FROM
							second = LIEGE
							value = 10 # I like the Claimant more than the current ruler
							as_if_liege = yes
						}
					}
				}
			}
		}
		
		modifier = {
			factor = 0
			FROM = { preparing_invasion = yes }
		}
		
		modifier = {
			factor = 0
			FROM = { 
				opinion = { who = LIEGE value = 0 } 
				NOR = {
					trait = deceitful
					trait = ambitious
					trait = envious
				}
				is_voter = no
			}
		}		
		
		modifier = {
			factor = 0
			FROM = {
				opinion = { who = LIEGE value = -15 } 			
			}
		}
		
		modifier = {
			factor = 1.5
			NOT = { FROM = { opinion = { who = LIEGE value = -25 } } }
		}
		modifier = {
			factor = 2.0
			NOT = { FROM = { opinion = { who = LIEGE value = -50 } } }
		}
		modifier = {
			factor = 4.0
			NOT = { FROM = { opinion = { who = LIEGE value = -75 } } }
		}
		modifier = {
			factor = 0
			FROM = {
				NOR = {
					has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
					has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
				}
			}
		}
		modifier = {
			factor = 0.01
			FROM = { trait = content }
		}
		modifier = {
			factor = 0.01
			FROM = { trait = imbecile }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = inbred }
		}
		modifier = {
			factor = 0.1
			FROM = { trait = craven }
		}
		modifier = {
			factor = 0.2
			FROM = { 
				OR = {
					trait = slow
					trait = dull
				}
			}
		}
		modifier = {
			factor = 0.5
			FROM = { trait = kind }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = charitable }
		}
		modifier = {
			factor = 0.5
			FROM = { trait = honest }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = humble }
		}
		modifier = {
			factor = 0.75
			FROM = { trait = just }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = proud }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = brave }
		}
		modifier = {
			factor = 1.5
			FROM = { trait = arbitrary }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = envious }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = greedy }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = impaler }
		}
		modifier = {
			factor = 2.0
			FROM = { trait = deceitful }
		}
		modifier = {
			factor = 3.0
			FROM = { is_evil_religion = yes }
		}
		modifier = {
			factor = 4.0
			FROM = { trait = ambitious }
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1

		modifier = {
			factor = 0.5
			ROOT = {  
				liege = { 
					any_owned_bloodline = { 
						has_bloodline_flag = bloodline_less_factions 
						bloodline_is_active_for = PREV
					}
				}
			}
		}
		modifier = {
			factor = 0
			OR = {
				leads_faction = faction_claimant
				in_faction = faction_claimant 
			}
		}
		
		modifier = {
			factor = 0
			OR = {
				prisoner = yes
				trait = incapable
				is_adult = no
				is_landed = no
				preparing_invasion = yes
			}
		}
		
		modifier = {
			factor = 0
			FROMFROM = {
				current_heir = {
					character = ROOT
				}
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_character_modifier = faction_powerful_vassal_takeover_ultimatum_timer
		}

		modifier = {
			factor = 0
			opinion = { who = FROMFROM value = 0 }
		}
		
		modifier = {
			factor = 0
			NOT = { opinion = { who = FROM value = -40 } }
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			liege = { 
				NOT = { year = 1350 }
				primary_title = { is_tribal_type_title = yes }
				culture = ROOT
				religion = ROOT
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0
			has_opinion_modifier = {
				who = LIEGE
				modifier = opinion_coerced_into_leaving_faction
			}
		}
		
		modifier = {
			factor = 0
			opinion = { who = LIEGE value = -40 }
			is_voter = no
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}

		modifier = {
			factor = 0
			opinion = { who = LIEGE value = -20 }
			is_voter = yes
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 0.2
			pacifist = yes
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		
		modifier = {
			factor = 1000
			has_opinion_modifier = {
				who = FROM
				modifier = opinion_coerced_into_joining_faction
			}
		}
		
		modifier = {
			factor = 1.5
			NOT = { opinion = { who = LIEGE value = -10 } }
		}
		modifier = {
			factor = 2.0
			NOT = { opinion = { who = LIEGE value = -50 } }
		}
		modifier = {
			factor = 4.0
			NOT = { opinion = { who = LIEGE value = -75 } }
		}
		
		modifier = {
			factor = 0
			NOR = {
				has_opinion_modifier = { who = LIEGE modifier = opinion_evil_tyrant }
				has_opinion_modifier = { who = LIEGE modifier = opinion_tyrant }
			}
		}
		
		modifier = {
			factor = 0.01
			trait = content
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.01
			trait = imbecile
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = inbred
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.1
			trait = craven
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.2
			OR = {
				trait = slow
				trait = dull
			}
			NOT = {	
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_coerced_into_joining_faction
				}
			}
		}
		modifier = {
			factor = 0.5
			trait = kind
		}
		modifier = {
			factor = 0.5
			trait = charitable
		}
		modifier = {
			factor = 0.5
			trait = honest
		}
		modifier = {
			factor = 0.75
			trait = humble
		}
		modifier = {
			factor = 0.75
			trait = just
		}
		modifier = {
			factor = 1.5
			trait = proud
		}
		modifier = {
			factor = 1.5
			trait = brave
		}
		modifier = {
			factor = 1.5
			trait = arbitrary
		}
		modifier = {
			factor = 2.0
			trait = envious
		}
		modifier = {
			factor = 2.0
			trait = greedy
		}
		modifier = {
			factor = 2.0
			trait = impaler
		}
		modifier = {
			factor = 2.0
			trait = deceitful
		}
		modifier = {
			factor = 3.0
			is_evil_religion = yes
		}
		modifier = {
			factor = 4.0
			trait = ambitious
		}
	}
	
	success = {
		holder_scope = {
			FROM = {
				has_opinion_modifier = { who = PREV modifier = opinion_abdicated }
			}
		}
	}
	
	abort = {
	}
	
	abort_effect = {
	}
	
	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_powerful_vassal_takeover
				reverse_opinion = {
					modifier = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}
}

faction_true_belivers = {
	type = character
	
	warning_level = 0.7 # At this level of faction power we give player an alert. Set to 0 for no alerts.
	
	# Plotter scope
	potential = {
		prisoner = no
		is_ruler = yes
		independent = no
		is_landed = yes
		is_adult = yes
		primary_title = { holy_order = no }
		NOT = { trait = incapable }
		has_character_flag = ai_flag_refuse_conversion
		religion_group = pagan_group
		is_reformed_religion = no
		liege = { 
			NOT = { religion = PREV	}			
		}
		primary_title = { higher_tier_than = BARON }
		has_character_flag = flag_truebelievers_revolter

		#NOT = { has_character_modifier = faction_lower_TO_ultimatum_timer }
	}
	
	# Target scope
	allow = {
		prisoner = no
	}
	
	# Faction member scope (ROOT = joiner, FROM = target)
	allow_join = {
		ROOT = {
			is_ruler = yes
		#	independent = no
		#	is_landed = yes
		#	is_adult = yes
		#	NOT = { trait = incapable }
		#	prisoner = no
			religion_group = pagan_group
			is_reformed_religion = no
		}
	}
	
	# AI creation weight
	chance = {
		factor = 1
		modifier = {
			factor = 1000
			FROM = { has_character_flag = ai_flag_refuse_conversion }
		}
		
		modifier = {
			factor = 0
			FROM = { NOT = { has_character_flag = ai_flag_refuse_conversion } }
		}
	}
	
	# AI membership weight: ROOT is the prospective member. FROM is the faction leader. FROMFROM is the target title or character.
	membership = {
		factor = 1

		modifier = {
			factor = 1000
			has_character_flag = ai_flag_refuse_conversion
		}
		modifier = {
			factor = 0
			NOT = { religion = FROM }
		}
		modifier = {
			factor = 0
			NOT = { has_character_flag = ai_flag_refuse_conversion }
		}
	}
	
	success = {
		independent = yes
	}
	
	abort = {
		always = no
	}
	
	abort_effect = {
	}
	
	effect = {
		FROM = {
			any_faction_backer = {
				faction = faction_true_belivers
				reverse_opinion = {
					modifier = opinion_grateful
					who = FROM
					years = 5
				}
			}
		}
	}
}
