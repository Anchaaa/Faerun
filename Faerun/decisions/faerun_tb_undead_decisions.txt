decisions = {
	
	shun_the_living = {
		is_high_prio = yes
		ai_check_interval = 100
		
		potential = {
			not_casting = yes
			is_undead = yes
			NOT = { has_character_modifier = undead_realm_lord }
		}
	}
	
}

settlement_decisions = {
	undead_animate_dead_prov = {
		is_high_prio = yes
		ai_check_interval = 10
		filter = realm_owned
		ai_target_filter = realm_owned
		
		from_potential = {
			is_undead = yes
			NOR = {
				has_character_modifier = wiz_necromancy
				has_character_flag = knows_spell_animate_dead
			}
		}
		potential = {
			location = {
				holder_scope = {
					character = FROM
				}
			}
		}
		allow = {
			location = {
				NOT = { has_province_modifier = empty_graves_mod }
			}
			FROM = {
				piety = 100
				custom_tooltip = {
					text = SPELL_ON_COOLDOWN
					hidden_tooltip = {
						OR = {
							NOT = { has_character_flag = spell_animate_dead_cooldown }
							had_character_flag = { flag = spell_animate_dead_cooldown months = 1 }
						}
					}
				}
			}
		}
		effect = {
			FROM = { set_character_flag = spell_animate_dead_cooldown }
			FROM = { piety = -100 }
			location = {
				FROM = {
					spawn_unit = {
						province = PREV
						home = PREV
						owner = FROM
						troops = {
							undead_troops = { 100 100 }
						}
						scaled_by_biggest_garrison = 1
						cannot_inherit = yes
						attrition = 0.1
						can_toggle_looting = no
						reinforces = no
					}
				}
			}
			location = {
				add_province_modifier = {
					name = empty_graves_mod
					years = 3
				}
				if = {
					limit = {
						NOT = { 
							has_province_modifier = undead_province
						}
					}
					add_province_modifier = {
						name = raised_dead_in_prov
						years = 3
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.5
		}
	}
}