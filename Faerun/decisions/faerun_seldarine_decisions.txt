decisions = {

	highmagic_celestial_army = {
		only_playable = yes
		ai_check_interval = 100
		potential = {
			OR = {
				ai = yes
				AND = {
					NOT = { not_casting = yes }
					has_character_flag = rituals_open
				}
			}
			has_character_flag = has_high_mage
			is_adult = yes
			prisoner = no
			is_incapable = no
			NOT = { is_inaccessible_trigger = yes }
			NOT = { has_character_flag = do_not_disturb }
		}
		allow = {
			piety = 400
			scaled_wealth = {
				value = 0.05
				min = 100
			}
			custom_tooltip = {
				text = CELESTIALARMY_CD
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = celestial_army }
						had_character_flag = { flag = celestial_army months = 12 }
					}
				}
			}
			OR = {
				is_primary_war_defender = yes
				AND = {
					is_primary_war_attacker = yes
					any_current_enemy = {
						is_primary_war_defender = yes
						custom_tooltip = {
							text = enemy_of_seldarine
							OR = {
								trait = patron_malar
								trait = patron_ghaunadaur
								religion = ghaunadaur
								religion = vhaeraun
								religion = kiaransalee
								trait = patron_talos
								trait = patron_auppenser
								religion = lolth_cult
								orc_religion_trigger = yes
								goblin_religion_trigger = yes
								religion = vaprak
								religion = infernal
								religion = abyssal_cult
								religion = entropy
								religion = faithless
								trait = patron_hyrsam
							}
						}
					}
				}
			}
		}
		effect = {
			clr_character_flag = celestial_army
			set_character_flag = celestial_army
			piety = -400
			scaled_wealth = {
				value = -0.05
				min = 100
			}
			set_character_flag = celestial_army_roll_flag
			high_magic_haywire_roll = yes
			if = {
				limit = {
					has_character_flag = high_magic_success
				}
				capital_scope = {
					ROOT = {
						spawn_unit = {
							province = PREV
							home = PREV
							owner = ROOT
							earmark = celestial_army
							troops = {
								warpriests = { 100 100 }
								mages_troops = { 100 100 }
								light_infantry = { 1250 1250 }
								heavy_infantry = { 500 500 }
								archers = { 500 500 }
							}
							disband_on_peace = yes
							attrition = 0
							maintenance_multiplier = 0
							can_toggle_looting = no
							cannot_inherit = yes
							reinforces = no
						}
					}
				}
				hidden_tooltip = {
					character_event = { id = seldarine.1 months = 6 }
				}
			}
			clr_character_flag = high_magic_success
		}
		ai_will_do = {
			factor = 0.7
		}
	}

	highmagic_reverend_one = {
		only_playable = yes
		is_high_prio = yes
		ai_check_interval = 10
		potential = {
			OR = {
				ai = yes
				AND = {
					NOT = { not_casting = yes }
					has_character_flag = rituals_open
				}
			}
			has_character_flag = has_high_mage
			is_adult = yes
			prisoner = no
			is_incapable = no
			NOT = { is_inaccessible_trigger = yes }
			NOT = { has_character_flag = do_not_disturb }
			OR = {
				is_primary_war_defender = yes
				AND = {
					is_primary_war_attacker = yes
					any_current_enemy = {
						is_primary_war_defender = yes
						custom_tooltip = {
							text = enemy_of_seldarine
							OR = {
								trait = patron_malar
								trait = patron_ghaunadaur
								religion = ghaunadaur
								religion = vhaeraun
								religion = kiaransalee
								trait = patron_talos
								trait = patron_auppenser
								religion = lolth_cult
								orc_religion_trigger = yes
								goblin_religion_trigger = yes
								religion = vaprak
								religion = infernal
								religion = abyssal_cult
								religion = entropy
								religion = faithless
								trait = patron_hyrsam
							}
						}
					}
				}
			}
		}
		allow = {
			piety = 100
			scaled_wealth = {
				value = 0.01
				min = 50
			}
			custom_tooltip = {
				text = CELESTIALARMY_CD
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = reverend_one_cd }
						had_character_flag = { flag = reverend_one_cd months = 12 }
					}
				}
			}
		}
		effect = {
			clr_character_flag = reverend_one_cd
			set_character_flag = reverend_one_cd
			piety = -100
			scaled_wealth = {
				value = -0.01
				min = 50
			}
			high_magic_haywire_roll = yes
			if = {
				limit = {
					has_character_flag = high_magic_success
				}
				create_character = {
					age = 500
					attributes = {
						martial = 7
					}
					trait = creature_elf
					trait = skilled_tactician
					trait = celibate
					trait = tb_sterile # Just in case
					trait = duelist
					random_traits = yes
					female = random
					religion = elven_pantheon
					culture = ROOT
					dynasty = actually_culture
					immortal_age = 30
				}
				new_character = {
					set_character_flag = reverend_one
					culture = einheriar
					add_character_modifier = {
						name = reverend_one_mod
						duration = -1
					}
					random_list = {
						1 = {
							remove_trait = skilled_tactician
							add_trait = brilliant_strategist
						}
						5 = {
						}
					}
					random_list = {
						1 = {
							add_trait = master_fighter
						}
						1 = {
							add_trait = master_ranger
						}
						1 = {
							add_trait = master_paladin
						}
						5 = {
							add_trait = expert_fighter
						}
						5 = {
							add_trait = expert_ranger
						}
						5 = {
							add_trait = expert_paladin
						}
						9 = {
							add_trait = journeyman_fighter
						}
						9 = {
							add_trait = journeyman_ranger
						}
						9 = {
							add_trait = journeyman_paladin
						}
					}
					random_list = {
						1 = {
							add_trait = aggressive_leader
						}
						1 = {
							add_trait = narrow_flank_leader
						}
						1 = {
							add_trait = defensive_leader
						}
						1 = {
							add_trait = experimenter
						}
						1 = {
							add_trait = flanker
						}
						1 = {
							add_trait = holy_warrior
						}
						1 = {
							add_trait = inspiring_leader
						}
						1 = {
							add_trait = trickster
						}
						1 = {
							add_trait = unyielding_leader
						}
						1 = {
							add_trait = winter_soldier
						}
						1 = {
							add_trait = light_foot_leader
						}
					}
					give_minor_title = title_commander
				}
			}
			hidden_tooltip = {
				character_event = { id = seldarine.6 months = 6 }
			}
			clr_character_flag = high_magic_success
		}
		ai_will_do = {
			factor = 0.7
		}
	}

	highmagic_nymphs_aura = {
		only_playable = yes
		ai_check_interval = 10
		potential = {
			OR = {
				ai = yes
				AND = {
					NOT = { not_casting = yes }
					has_character_flag = rituals_open
				}
			}
			has_character_flag = has_high_mage
			is_adult = yes
			prisoner = no
			is_incapable = no
			NOT = { is_inaccessible_trigger = yes }
			NOT = { has_character_flag = do_not_disturb }
		}
		allow = {
			NOR = {
				trait = creature_hag
				trait = beautiful
			}
			piety = 50
			scaled_wealth = {
				value = 0.01
				min = 50
				max = 150
			}
			custom_tooltip = {
				text = CELESTIALARMY_CD
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = nymph_aura_cd }
						had_character_flag = { flag = nymph_aura_cd months = 12 }
					}
				}
			}
		}
		effect = {
			clr_character_flag = nymph_aura_cd
			set_character_flag = nymph_aura_cd
			piety = -50
			scaled_wealth = {
				value = -0.01
				min = 50
				max = 150
			}
			high_magic_haywire_roll = yes
			if = {
				limit = {
					has_character_flag = high_magic_success
				}
				if = {
					limit = {
						NOR = {
							trait = pretty
							trait = fair
							trait = beautiful
							trait = plain
							trait = ugly
							trait = unsightly
						}
					}
					add_trait = fair
				}
				else_if = {
					limit = {
						OR = {
							trait = pretty
							trait = fair
							trait = plain
							trait = ugly
							trait = unsightly
						}
					}
					trigger_switch = {
						on_trigger = trait
						unsightly = {
							remove_trait = unsightly
							add_trait = ugly
						}
						ugly = {
							remove_trait = ugly
							add_trait = plain
						}
						plain = {
							remove_trait = plain
						}
						pretty = {
							remove_trait = pretty
							add_trait = beautiful
						}
						fair = {
							remove_trait = fair
							add_trait = pretty
						}
					}
				}
			}
			clr_character_flag = high_magic_success
		}
	}

	highmagic_baelnorn = {
		only_playable = yes
		ai_check_interval = 200
		potential = {
			OR = {
				ai = yes
				AND = {
					NOT = { not_casting = yes }
					has_character_flag = rituals_open
				}
			}
			has_character_flag = has_high_mage
			is_adult = yes
			prisoner = no
			is_incapable = no
			NOT = { is_inaccessible_trigger = yes }
			NOT = { has_character_flag = do_not_disturb }
		}
		allow = {
			piety = 250
			scaled_wealth = {
				value = 0.05
				min = 50
				max = 300
			}
			age = 500
			learning = 7
			trait = creature_elf
			is_undead = no
			NOR = {
				trait = immortal
				trait = avatar
			}
			custom_tooltip = {
				text = HIGHCLASSLEVEL
				OR = {
					trait = master_bard
					trait = master_wizard
					trait = master_sorcerer
					trait = master_warlock
					trait = master_cleric
					trait = master_druid
					trait = master_ranger
					trait = master_monk
					trait = master_fighter
					trait = master_barbarian
					trait = master_rogue
					trait = master_shadow
					trait = master_paladin
					trait = renowned_bard
					trait = renowned_wizard
					trait = renowned_sorcerer
					trait = renowned_warlock
					trait = renowned_cleric
					trait = renowned_druid
					trait = renowned_ranger
					trait = renowned_monk
					trait = renowned_fighter
					trait = renowned_barbarian
					trait = renowned_rogue
					trait = renowned_shadow
					trait = renowned_paladin
					trait = legendary_bard
					trait = legendary_wizard
					trait = legendary_sorcerer
					trait = legendary_warlock
					trait = legendary_cleric
					trait = legendary_druid
					trait = legendary_ranger
					trait = legendary_monk
					trait = legendary_fighter
					trait = legendary_barbarian
					trait = legendary_rogue
					trait = legendary_shadow
					trait = legendary_paladin
				}
			}
			is_pregnant = no
		}
		effect = {
			piety = -250
			scaled_wealth = {
				value = -0.05
				min = 50
				max = 300
			}
			high_magic_haywire_roll = yes
			if = {
				limit = {
					has_character_flag = high_magic_success
				}
				add_trait = lich_baelnorn
				add_trait = disinherited
				set_graphical_culture = lichelf
				player_heir = {
					if = {
						limit = {
							OR = {
								dynasty = ROOT
								is_close_relative = ROOT
							}
						}
						add_character_modifier = {
							name = mod_baelnorn_predecessor
							years = 10
						}
					}
				}
				abdicate = { move = no }
			}
			clr_character_flag = high_magic_success
		}
		ai_will_do = {
			factor = 0.01
			modifier = {
				factor = 2
				trait = zealous
			}
			modifier = {
				factor = 2
				trait = charitable
			}
			modifier = {
				factor = 2
				trait = content
			}
		}
	}

	highmagic_worldweave = {
		only_playable = yes
		ai_check_interval = 50
		potential = {
			OR = {
				ai = yes
				AND = {
					NOT = { not_casting = yes }
					has_character_flag = rituals_open
				}
			}
			has_character_flag = has_high_mage
			is_adult = yes
			prisoner = no
			is_incapable = no
			NOT = { is_inaccessible_trigger = yes }
			NOT = { has_character_flag = do_not_disturb }
		}
		allow = {
			piety = 500
			scaled_wealth = {
				value = 0.1
				min = 300
			}
			custom_tooltip = {
				text = CELESTIALARMY_CD
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = worldweave }
						had_character_flag = { flag = worldweave months = 12 }
					}
				}
			}
			custom_tooltip = {
				text = WORLDWEAVE_NUM
				any_demesne_province = {
					num_of_max_settlements < 7
				}
			}
		}
		effect = {
			piety = -500
			scaled_wealth = {
				value = 0.1
				min = -300
			}
			clr_character_flag = worldweave
			set_character_flag = worldweave
			high_magic_haywire_roll = yes
			if = {
				limit = {
					has_character_flag = high_magic_success
				}
				random_demesne_province = {
					limit = {
						num_of_max_settlements < 7
					}
					province_event = { id = seldarine.8 }
				}
			}
			clr_character_flag = high_magic_success
		}
		ai_will_do = {
			factor = 0.33
			modifier = {
				factor = 2
				trait = diligent
			}
			modifier = {
				factor = 0.5
				trait = slothful
			}
			modifier = {
				factor = 0.5
				trait = content
			}
		}
	}


	highmagic_mythal = {
		only_playable = yes
		ai_check_interval = 150
		potential = {
			OR = {
				ai = yes
				AND = {
					NOT = { not_casting = yes }
					has_character_flag = rituals_open
				}
			}
			has_character_flag = has_high_mage
			is_adult = yes
			prisoner = no
			is_incapable = no
			NOT = { is_inaccessible_trigger = yes }
			NOT = { has_character_flag = do_not_disturb }
		}
		allow = {
			piety = 350
			scaled_wealth = {
				value = 0.07
				min = 150
			}
			custom_tooltip = {
				text = CELESTIALARMY_CD
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = mythal }
						had_character_flag = { flag = mythal months = 12 }
					}
				}
			}
			any_demesne_province = {
				NOT = {
					has_province_modifier = mythal_mod
				}
			}
		}
		effect = {
			piety = -350
			scaled_wealth = {
				value = 0.07
				min = -150
			}
			clr_character_flag = mythal
			set_character_flag = mythal
			high_magic_haywire_roll = yes
			if = {
				limit = {
					has_character_flag = high_magic_success
				}
				capital_scope = {
					add_province_modifier = {
						name = mythal_mod
						duration = -1
					}
				}
			}
			clr_character_flag = high_magic_success
		}
		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 2
				trait = diligent
			}
			modifier = {
				factor = 0.5
				trait = slothful
			}
			modifier = {
				factor = 0.5
				trait = content
			}
		}
	}

	seld_invite_fey = {
		ai_check_interval = 30
		only_playable = yes

		potential = {
			prisoner = no
			is_incapable = no
			NOT = { is_inaccessible_trigger = yes }
			NOT = { has_character_flag = do_not_disturb }
			religion = elven_pantheon
		}

		allow = {
			piety = 15
			custom_tooltip = {
				text = INVITEFEY_CD
				OR = {
					NOT = { has_character_flag = invitefey }
					had_character_flag = { flag = invitefey months = 3 }
				}
			}
		}
		effect = {
			clr_character_flag = invitefey
			set_character_flag = invitefey
			piety = -15
			random_list = {
				1 = {
					create_character = {
						random_traits = yes
						dynasty = actually_culture
						religion = sylvan
						culture = satyr
						female = random
						age = 35
						trait = creature_satyr
					}
				}
				1 = {
					create_character = {
						random_traits = yes
						dynasty = actually_culture
						religion = sylvan
						culture = treant
						female = random
						age = 150
						trait = creature_treant
						immortal_age = 30
					}
				}
				1 = {
					create_character = {
						random_traits = yes
						dynasty = actually_culture
						religion = sylvan
						culture = centaur
						female = random
						age = 35
						trait = creature_centaur
						immortal_age = 30
					}
				}
				1 = {
					create_character = {
						random_traits = yes
						dynasty = actually_culture
						religion = sylvan
						culture = eladrin
						female = random
						age = 150
						trait = creature_elf
						trait = feytouched
						immortal_age = 30
					}
				}
				1 = {
					create_character = {
						random_traits = yes
						dynasty = actually_culture
						religion = sylvan
						culture = hengeyokai
						female = random
						age = 35
						trait = creature_hengeyokai
						immortal_age = 30
					}
				}
			}
			new_character = {
				random_list = {
					1 = {
						religion = elven_pantheon
					}
					1 = {
						# empty!
					}
				}
				opinion = {
					modifier = invited_fey
					who = ROOT
					years = 5
				}
				character_event = { id = seldarine.11 }
			}
		}
		ai_will_do = {
			factor = 0.1
		}
	}

	invite_high_mage = {
		ai_check_interval = 30
		only_playable = yes

		potential = {
			prisoner = no
			is_incapable = no
			NOT = { is_inaccessible_trigger = yes }
			NOT = { has_character_flag = do_not_disturb }
			religion = elven_pantheon
			higher_tier_than = DUKE
			any_courtier_or_vassal = {
				has_minor_title = title_high_mage
			}
		}

		allow = {
			piety = 100
			scaled_wealth = {
				value = 0.2
				min = 250
				max = 1000
			}
			custom_tooltip = {
				text = NOHIGHMAGE
				any_courtier_or_vassal = {
					NOT = { has_character_flag = invited_selutaar }
				}
			}
		}
		effect = {
			piety = -100
			scaled_wealth = {
				value = -0.2
				min = 250
				max = 1000
			}
			random_list = {
				1 = {
					create_character = {
						random_traits = yes
						dynasty = actually_culture
						religion = elven_pantheon
						culture = sun_elf
						female = random
						age = 550
						trait = creature_elf
						trait = scholarly_theologian
						attributes = { learning = 8 }
						immortal_age = 30
					}
				}
				1 = {
					create_character = {
						random_traits = yes
						dynasty = actually_culture
						religion = elven_pantheon
						culture = moon_elf
						female = random
						age = 550
						trait = creature_elf
						trait = scholarly_theologian
						attributes = { learning = 8 }
						immortal_age = 30
					}
				}
			}
			new_character = {
				set_character_flag = invited_selutaar
				give_minor_title = title_high_mage
				random = {
					chance = 20
					remove_trait = scholarly_theologian
					add_trait = mastermind_theologian
				}
				random_list = {
					1 = {
						add_trait = legendary_sorcerer
					}
					3 = {
						add_trait = legendary_wizard
					}
					10 = {
						add_trait = renowned_sorcerer
					}
					30 = {
						add_trait = renowned_wizard
					}
					50 = {
						add_trait = master_sorcerer
					}
					150 = {
						add_trait = master_wizard
					}
				}
				ROOT = {
					character_event = { id = seldarine.10 }
				}
			}
		}
		ai_will_do = {
			factor = 0.05
		}
	}

	join_retreat = {
		only_playable = yes
		potential = {
			prisoner = no
			is_incapable = no
			NOT = { is_inaccessible_trigger = yes }
			NOT = { has_character_flag = do_not_disturb }
			religion = elven_pantheon
			is_adult = yes
			NOT = {
				location = {
					region = evermeet_region
				}
			}
		}
		allow = {
			trait = creature_elf
			custom_tooltip = {
				text = ELVENEVERMEET
				e_evermeet = { # to avoid any_title
					any_de_jure_vassal_title = {
						region = evermeet_region
						holder_scope = {
							religion = elven_pantheon
							OR = {
								culture_group = high_elf_group
								culture_group = sylvan_elf_group
								culture_group = eladrin_group
							}
						}
					}
				}
			}
		}
		effect = {
			player_heir = {
				prestige = 30
				piety = 30
			}
			abdicate = yes
			add_trait = disinherited
			random_landed_title = {
				limit = {
					has_holder = yes
					capital_scope = { region = evermeet_region }
					holder_scope = {
						religion = elven_pantheon
						OR = {
							culture_group = high_elf_group
							culture_group = sylvan_elf_group
							culture_group = eladrin_group
						}
					}
				}
				holder_scope = {
					ROOT = { move_character = PREV }
				}
			}
		}
		ai_will_do = {
			factor = 0.05
			modifier = {
				factor = 3
				trait = content
			}
			modifier = {
				factor = 10
				trait = depressed
			}
			modifier = {
				factor = 3
				age = 700
			}
		}
	}
}

society_decisions = { #for the elven warrior lodge
	elven_lodge_fighting_style = {
		is_in_society = yes
		is_high_prio = yes
		ai_check_interval = 60

		potential = {
			not_casting = yes
			is_adult = yes
			OR = {
				society_rank = {
					society = warrior_lodge_elven
					rank >= 3
				}
			}
			NOT = { has_character_flag = chose_elven_style_flag }
		}

		allow = {
			has_society_currency_major_trigger = yes
		}

		effect = {
			set_character_flag = chose_elven_style_flag
			character_event = { id = seldarine.12 }
			detract_society_currency_major_effect = yes
		}

		revoke_allowed = { always = no }

		ai_will_do = {
			factor = 1
		}
	}
}
