decisions = {

	see_tutorials = {
		#ai_check_interval = 0
		ai = no
		potential = {
			not_casting = yes
			has_game_rule = {
				name = tutorials
				value = on
			}
		}
		allow = {
			always = yes
		}
		effect = {
			character_event = { id = frtut.12 }
		}
	}

	same_gender_marry_fake = { # This is basically a reminder that this decisions is available
		ai = no
		ai_check_interval = 6000
		is_high_prio = yes
		potential = {
			OR = {
				trait = homosexual
				trait = bisexual
			}
			OR = {
				OR = {
					is_married = no
					is_married_matrilineally = no
				}
				OR = {
					AND = {
						NOT = { num_of_spouses = 4 }
						OR = {
							religion = calishite_faith
							religion = mulhorandi_faith
							religion = ten_thousand_gods
							religion = qisma
							religion = pantheist_league
							religion = muhjari
							religion = kahin
						}
					}
					AND = {
						NOT = { num_of_spouses = 3 }
						OR = {
							religion = lapal_faith
							religion = geomancy
						}
					}
				}
			}
		}
		allow = {
			always = no
		}
		effect = {
			break = yes
		}
		ai_will_do = {
			factor = 0 # Just to be sure
		}
	}

	adopt_heir_fake = { # This is basically a reminder that this decisions is available
		ai = no
		ai_check_interval = 6000
		is_high_prio = yes
		potential = {
			not_casting = yes
			age = 40
			has_living_children = no
			OR = {
				fertility <= 0
				AND = {
					fertility <= 0.25
					age >= 50
					olrox_not_immortals_trigger = yes
				}
				AND = {
					age >= 60
					olrox_not_immortals_trigger = yes
				}
			}
			NAND = {
				trait = celibate
				is_monastic_member_trigger = yes
			}
		}
		allow = {
			always = no
			NOT = { num_of_children = 4 } # children are not expendable
			NOT = { has_character_modifier = recoveringfromchildbirth }
		}
		effect = {
			break = yes
		}
		ai_will_do = {
			factor = 0 # Just to be sure
		}
	}

	foster_child = {
		only_rulers = yes
		ai_check_interval = 36
		is_high_prio = yes
		potential = {
			not_casting = yes
			NOT = { primary_title = { has_law = succ_open_elective } }
			NAND = {
				OR = {
					government = divine_feudal_government # lineage determines rule
					government = chinese_imperial_government
					government = confucian_bureaucracy
				}
				independent = yes # not as much for their vassals
			}
			NOT = { has_character_flag = adopting_child }
			OR = {
				ai = no
				NOT = {
					any_child = {
						count = 3
						is_alive = yes
					}
				}
			}
		}
		allow = {
			NOT = { num_of_children = 4 } # children are not expendable
			prisoner = no
			is_incapable = no
			custom_tooltip = {
				text = adoption_cooldown_tt
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = adopted_foundling }
						had_character_flag = {
							flag = adopted_foundling
							years = 2
						}
					}
				}
			}
			OR = {
				AND = {
					OR = {
						fertility <= 0
						AND = {
							fertility <= 0.25
							age >= 40
							olrox_not_immortals_trigger = yes
						}
						AND = {
							age >= 50
							olrox_not_immortals_trigger = yes
						}
					}
					NOT = { has_character_modifier = recoveringfromchildbirth }
					NAND = {
						trait = celibate
						is_monastic_member_trigger = yes
					}
				}
				OR = {
					AND = {
						is_female = yes
						any_spouse = { is_female = yes }
					}
					AND = {
						is_female = no
						any_spouse = { is_female = no }
					}
				}
				AND = {
					can_marry = no
					NOR = {
						is_married = yes
						is_betrothed = yes
						is_consort = yes
					}
				}
				custom_tooltip = {
					text = burgher_5_years_childless_tt
					hidden_tooltip = {
						AND = {
							OR = {
								government = democratic_feudal_government
								government = merchant_republic_government
							}
							ruled_years = 5
							NOT = {
								any_child = {
									is_alive = yes
								}
							}
						}
					}
				}
			}
			conditional_tooltip = {
				trigger = { 
					real_tier = EMPEROR
				}
				prestige = 400
			}
			conditional_tooltip = {
				trigger = { 
					real_tier = KING
				}
				prestige = 300
			}
			conditional_tooltip = {
				trigger = { 
					real_tier = DUKE
				}
				prestige = 200
			}
			conditional_tooltip = {
				trigger = { 
					real_tier = COUNT
				}
				prestige = 100
			}
			conditional_tooltip = {
				trigger = { 
					real_tier = BARON
				}
				prestige = 10
			}
			custom_tooltip = {
				text = adopt_capital_or_culture_tt
				hidden_tooltip = {
					OR = {
						NOR = {
							trait = creature_dragon
							trait = creature_treant
							trait = creature_construct
							trait = creature_fiend
							trait = creature_illithid
							trait = creature_ulitharid
							trait = creature_beholder
							trait = creature_aboleth
							trait = creature_monster
							trait = creature_genie
							trait = creature_angel
						}
						NOT = {
							capital_scope = {
								OR = {
									culture_group = monster_group
									culture_group = fiendish_group
									culture_group = aberration_culture_group
									culture_group = construct_group
									culture = treant
									AND = {
										culture_group = draconic_culture_group
										NOR = {
											culture = dragonspawn
											culture = dragonborn
											culture = strixiki
											culture = vayemniri
											culture = thymari
											culture = kobold
										}
									}
									culture_group = celestial_group 
									culture_group = genie_group
								}
							}		
						}
					}
				}
			}
		}
		effect = {
			character_event = { id = fradoption.1 }
			set_character_flag = adopting_child # to prevent spamming
			clr_character_flag = adopted_foundling # for cooldown
			set_character_flag = adopted_foundling
		}
		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0.5
				trait = proud 
			}
			modifier = {
				factor = 0.5
				trait = paranoid 
			}
			modifier = {
				factor = 2
				trait = humble
			}
			modifier = {
				factor = 2
				trait = trusting
			}
		}
	}
	
	lay_on_hands = {
		ai_check_interval = 24
		potential = {
			not_casting = yes
			z_paladin = yes
		}
		allow = {
			trait = wounded
			OR = {
				AND = {
					trait = paladin
					piety = 80
				}
				AND = {
					trait = trained_paladin
					piety = 70
				}
				AND = {
					trait = journeyman_paladin
					piety = 60
				}
				AND = {
					trait = expert_paladin
					piety = 50
				}
				AND = {
					trait = master_paladin
					piety = 40
				}
				AND = {
					trait = renowned_paladin
					piety = 30
				}
				AND = {
					trait = legendary_paladin
					piety = 20
				}
			}
		}
		effect = {
			if = {
				limit = {
					trait = paladin
				}
				piety = -80
			}
			else_if = {
				limit = {
					trait = trained_paladin
				}
				piety = -70
			}
			else_if = {
				limit = {
					trait = journeyman_paladin
				}
				piety = -60
			}
			else_if = {
				limit = {
					trait = expert_paladin
				}
				piety = -50
			}
			else_if = {
				limit = {
					trait = master_paladin
				}
				piety = -40
			}
			else_if = {
				limit = {
					trait = renowned_paladin
				}
				piety = -30
			}
			else = {
				piety = -20
			}
			remove_trait = wounded
		}
		ai_will_do = {
			factor = 1
		}
	}
	
	paladin_oaths = {
		ai_check_interval = 36
		potential = {
			not_casting = yes
			z_paladin = yes
			NOR = {
				has_character_modifier = oath_of_the_ancients
				has_character_modifier = oath_of_conquest
				has_character_modifier = oath_of_the_crown
				has_character_modifier = oath_of_devotion
				has_character_modifier = oath_of_redemption
				has_character_modifier = oath_of_vengeance
			}
		}
		allow = {
			always = yes
		}
		effect = {
			character_event = { id = generalmisc.5 }
		}
		ai_will_do = {
			factor = 1
		}
	}
	
	buy_instrument = {
		ai_check_interval = 36
		potential = {
			not_casting = yes
			z_bard = yes
			NOT = {
				any_artifact = {
					has_artifact_flag = instrument
				}
			}
		}
		allow = {
			wealth = 10
		}
		effect = {
			wealth = -10
			random_list = {
				10 = {
					add_artifact = bandore
				}
				10 = {
					add_artifact = harp
				}
				1 = {
					add_artifact = kazoo
				}
				10 = {
					add_artifact = lute
				}
				10 = {
					add_artifact = mandolin
				}
				10 = {
					add_artifact = cittern
				}
				10 = {
					add_artifact = lyre
				}
			}
		}
		ai_will_do = {
			factor = 0.7
		}
	}
	
	ranger_pick_terrain = {
		ai_check_interval = 36
		potential = {
			not_casting = yes
			z_ranger = yes
			can_have_more_leadership_traits = yes
			NAND = {
				trait = desert_terrain_leader
				trait = flat_terrain_leader
				trait = jungle_terrain_leader
				trait = mountain_terrain_leader
				trait = rough_terrain_leader
				trait = winter_soldier
			}
			NOT = { has_character_flag = picked_favoured_terrain }
		}
		allow = {
			always = yes
		}
		effect = {
			character_event = { id = generalmisc.7 }
			set_character_flag = picked_favoured_terrain
		}
		ai_will_do = {
			factor = 0.5
			modifier = {
				factor = 1.5
				trait = brave
			}
			modifier = {
				factor = 0.5
				trait = craven
			}
		}
	}
	
	get_animal_companion = {
		ai_check_interval = 36
		potential = {
			not_casting = yes
			OR = {
				z_ranger = yes
				z_druid = yes
			}
			NOT = {
				any_artifact = {
					has_artifact_flag = animal_companion
				}
			}
		}
		allow = {
			piety = 50
		}
		effect = {
			piety = -50
			add_artifact = animal_companion
		}
		ai_will_do = {
			factor = 0.8
		}
	}
	
	monk_contemplate = {
		ai = no # They can't handle it
		ai_check_interval = 1000
		potential = {
			not_casting = yes
			z_monk = yes
			is_incapable = no
		}
		allow = {
			custom_tooltip = {
				text = CONTEMPLATECD
				OR = {
					NOT = { has_character_flag = monkcont }
					had_character_flag = {
						flag = monkcont
						months = 3
					}
				}
			}
		}
		effect = {
			clr_character_flag = monkcont
			set_character_flag = monkcont
			character_event = { id = generalmisc.9 }
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	monk_abandon_focus = {
		ai = no # They can't handle it
		ai_check_interval = 1000
		potential = {
			not_casting = yes
			OR = {
				has_character_modifier = monk_diplo
				has_character_modifier = monk_martial
				has_character_modifier = monk_stewardship
				has_character_modifier = monk_intrigue
				has_character_modifier = monk_learning
			}
		}
		allow = {
			always = yes
		}
		effect = {
			remove_character_modifier = monk_diplo
			remove_character_modifier = monk_martial
			remove_character_modifier = monk_stewardship
			remove_character_modifier = monk_intrigue
			remove_character_modifier = monk_learning
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	monk_longevity = {
		ai_check_interval = 150
		potential = {
			z_monk = yes
			not_casting = yes
			NOR = {
				faerun_immortal_race_trigger = yes
				trait = longevity
			}
		}
		allow = {
			OR = {
				trait = master_monk
				trait = renowned_monk
				trait = legendary_monk
			}
			OR = {
				AND = {
					trait = master_monk
					piety = 800
				}
				AND = {
					trait = renowned_monk
					piety = 600
				}
				AND = {
					trait = legendary_monk
					piety = 300
				}
			}
		}
		effect = {
			if = {
				limit = {
					trait = master_monk
				}
				piety = -800
			}
			else_if = {
				limit = {
					trait = renowned_monk
				}
				piety = -600
			}
			else_if = {
				limit = {
					trait = legendary_monk
					piety = -300
				}
			}
			add_trait = longevity
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
				trait = depressed
			}
		}
	}
	
	monk_mob = {
		ai_check_interval = 50
		only_playable = yes
		potential = {
			z_monk = yes
			not_casting = yes
		}
		allow = {
			is_primary_war_defender = yes
			piety = 70
			custom_tooltip = {
				text = MONKMOB_CD
				OR = {
					NOT = { has_character_flag = monkmob }
					had_character_flag = { flag = monkmob months = 5 }
				}
			}
		}
		effect = {
			clr_character_flag = monkmob
			set_character_flag = monkmob
			piety = -70
			capital_scope = {
				ROOT = {
					spawn_unit = {
						province = PREV
						home = PREV
						owner = ROOT
						earmark = monkmob
						troops = {
							mob_troops = { 1000 1000 }
						}
						disband_on_peace = yes
						attrition = 1
						maintenance_multiplier = 1
						can_toggle_looting = no
						cannot_inherit = yes
						reinforces = no
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.7
		}
	}
	
	hire_brigands = {
		ai_check_interval = 12
		only_playable = yes
		potential = {
			z_rogue = yes
			is_incapable = no
		}
		allow = {
			hidden_tooltip = {
				OR = {
					ai = no
					AND = {
						ai = yes
						OR = {
							location = {
								is_island = no
							}
							any_demesne_title = {
								tier = COUNT
								count = 3
							}
						}
					}
				}
			}
			wealth = 70
			prestige = 150
			custom_tooltip = {
				text = BARBARMYCD
				OR = {
					NOT = { has_character_flag = spawned_rogue_raiders }
					had_character_flag = {
						flag = spawned_rogue_raiders
						months = 4
					}
				}
			}
			custom_tooltip = {
				text = BARBHASARMY
				NOT = {
					any_army = {
						has_earmarked_regiments = rogue_raiders
					}
				}
			}
		}
		effect = {
			wealth = -70
			prestige = -150
			capital_scope = {
				trigger_switch = {
					on_trigger = trait
					rogue = {
						spawn_unit = {
							province = THIS
							owner = ROOT
							earmark = rogue_raiders
							troops = {
								light_infantry = { 350 350 }
								archers = { 100 100 }
								mob_troops = { 400 400 }
							}
							cannot_inherit = yes
							maintenance_multiplier = 0.75
							reinforces = no
							can_toggle_looting = no
							is_looter = yes
						}
					}
					trained_rogue = {
						spawn_unit = {
							province = THIS
							owner = ROOT
							earmark = rogue_raiders
							troops = {
								light_infantry = { 400 400 }
								archers = { 120 120 }
								mob_troops = { 500 500 }
							}
							cannot_inherit = yes
							maintenance_multiplier = 0.75
							reinforces = no
							can_toggle_looting = no
							is_looter = yes
						}
					}
					journeyman_rogue = {
						spawn_unit = {
							province = THIS
							owner = ROOT
							earmark = rogue_raiders
							troops = {
								light_infantry = { 500 500 }
								archers = { 140 140 }
								mob_troops = { 600 600 }
							}
							cannot_inherit = yes
							maintenance_multiplier = 0.75
							reinforces = no
							can_toggle_looting = no
							is_looter = yes
						}
					}
					expert_rogue = {
						spawn_unit = {
							province = THIS
							owner = ROOT
							earmark = rogue_raiders
							troops = {
								light_infantry = { 700 700 }
								archers = { 180 180 }
								mob_troops = { 700 700 }
							}
							cannot_inherit = yes
							maintenance_multiplier = 0.75
							reinforces = no
							can_toggle_looting = no
							is_looter = yes
						}
					}
					master_rogue = {
						spawn_unit = {
							province = THIS
							owner = ROOT
							earmark = rogue_raiders
							troops = {
								light_infantry = { 900 900 }
								archers = { 250 250 }
								mob_troops = { 800 800 }
							}
							cannot_inherit = yes
							maintenance_multiplier = 0.75
							reinforces = no
							can_toggle_looting = no
							is_looter = yes
						}
					}
					renowned_rogue = {
						spawn_unit = {
							province = THIS
							owner = ROOT
							earmark = rogue_raiders
							troops = {
								light_infantry = { 1100 1100 }
								archers = { 300 300 }
								mob_troops = { 900 900 }
							}
							cannot_inherit = yes
							maintenance_multiplier = 0.75
							reinforces = no
							can_toggle_looting = no
							is_looter = yes
						}
					}
					legendary_rogue = {
						spawn_unit = {
							province = THIS
							owner = ROOT
							earmark = rogue_raiders
							troops = {
								light_infantry = { 1300 1300 }
								archers = { 350 350 }
								mob_troops = { 1000 1000 }
							}
							cannot_inherit = yes
							maintenance_multiplier = 0.75
							reinforces = no
							can_toggle_looting = no
							is_looter = yes
						}
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.4
			modifier = {
				factor = 0.5
				olrox_is_good_religion_trigger = yes
			}
			modifier = {
				factor = 2
				is_evil_religion = yes
			}
			modifier = {
				factor = 2
				trait = greedy
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 0.1
				is_island = yes
			}
		}
	}
	
	increase_alertness = {
		ai_check_interval = 250
		potential = {
			z_shadow = yes
			not_casting = yes
		}
		allow = {
			piety = 35
			prestige = 35
			custom_tooltip = {
				text = ALERTCD
				OR = {
					NOT = { has_character_flag = alertness }
					had_character_flag = {
						flag = alertness
						years = 7
					}
				}
			}
		}
		effect = {
			clr_character_flag = alertness
			set_character_flag = alertness
			piety = -35
			prestige = -35
			add_character_modifier = {
				name = shadow_alertness
				years = 5
			}
			random = {
				chance = 20
				add_trait = stressed
			}
			random = {
				chance = 2
				if = {
					limit = {
						trait = trusting
					}
					remove_trait = trusting
				}
				else = {
					add_trait = paranoid
				}
			}
		}
		ai_will_do = {
			factor = 0.4
			modifier = {
				factor = 0.5
				trait = trusting
			}
			modifier = {
				factor = 0.5
				trait = slothful
			}
			modifier = {
				factor = 2
				trait = paranoid
			}
			modifier = {
				factor = 1.5
				trait = diligent
			}
		}
	}
	
	launder_cash = {
		ai_check_interval = 250
		only_playable = yes
		potential = {
			z_shadow = yes
			not_casting = yes
		}
		allow = {
			prestige = 100
			custom_tooltip = {
				text = LAUNDERCD
				OR = {
					NOT = { has_character_flag = laundered_cash }
					had_character_flag = {
						flag = laundered_cash
						years = 5
					}
				}
			}
		}
		effect = {
			clr_character_flag = laundered_cash
			set_character_flag = laundered_cash
			prestige = -100
			if = {
				limit = {
					trait = shadow
				}
				wealth = 35
			}
			else_if = {
				limit = {
					trait = trained_shadow
				}
				wealth = 45
			}
			else_if = {
				limit = {
					trait = journeyman_shadow
				}
				wealth = 70
			}
			else_if = {
				limit = {
					trait = expert_shadow
				}
				wealth = 85
			}
			else_if = {
				limit = {
					trait = master_shadow
				}
				wealth = 100
			}
			else_if = {
				limit = {
					trait = renowned_shadow
				}
				wealth = 125
			}
			else_if = {
				limit = {
					trait = legendary_shadow
				}
				wealth = 150
			}
			random = {
				chance = 50
				modifier = {
					factor = 0
					NOT = { trait = just }
				}
				remove_trait = just
			}
			random = {
				chance = 100
				modifier = { # these are meant to stack!
					factor = 0.7
					intrigue = 5
				}
				modifier = {
					factor = 0.7
					intrigue = 8
				}
				modifier = {
					factor = 0.6
					intrigue = 10
				}
				modifier = {
					factor = 0.6
					intrigue = 13
				}
				modifier = {
					factor = 0.6
					intrigue = 15
				}
				modifier = {
					factor = 0.4
					intrigue = 20
				}
				add_character_modifier = {
					name = corrupt_ruler
					years = 10
					stacking = yes
				}
			}
		}
		ai_will_do = {
			factor = 0.3
			modifier = {
				factor = 0.1
				trait = charitable
			}
			modifier = {
				factor = 0.1
				trait = just
			}
			modifier = {
				factor = 3
				trait = greedy
			}
			modifier = {
				factor = 1.5
				trait = arbitrary
			}
		}
	}

}

targeted_decisions = {

	same_gender_marry = {
		only_rulers = yes
		ai_check_interval = 24
		filter = all
		ai_target_filter = realm # wish there was a better way, don't want to use "all" for the AI

		from_potential = {
			OR = {
				trait = homosexual
				trait = bisexual
			}
			OR = {
				OR = {
					is_married = no
					is_married_matrilineally = no
				}
				OR = {
					AND = {
						NOT = { num_of_spouses = 4 }
						OR = {
							religion = calishite_faith
							religion = mulhorandi_faith
							religion = ten_thousand_gods
							religion = qisma
							religion = pantheist_league
							religion = muhjari
							religion = kahin
							has_religion_feature = religion_harems
							has_religion_feature = religion_feature_nogari
						}
					}
					AND = {
						NOT = { num_of_spouses = 3 }
						OR = {
							religion = lapal_faith
							religion = geomancy
						}
					}
				}
			}
			NOT = {
				any_spouse = {
					character = ROOT
				}
			}
		}
		potential = {
			OR = {
				AND = {
					is_female = yes
					FROM = { is_female = yes }
				}
				AND = {
					is_female = no
					FROM = { is_female = no }
				}
			}
			ai = yes
			is_betrothed = no
			OR = {
				AND = {
					is_married = no
					is_married_matrilineally = no
				}
				OR = {
					is_married = no
					OR = {
						AND = {
							NOT = { num_of_spouses = 4 }
							OR = {
								religion = calishite_faith
								religion = mulhorandi_faith
								religion = ten_thousand_gods
								religion = qisma
								religion = pantheist_league
								religion = muhjari
								religion = kahin
								religion = orc_pantheon
							}
						}
						AND = {
							NOT = { num_of_spouses = 3 }
							OR = {
								religion = lapal_faith
								AND = {
									religion = geomancy
									NOT = { num_of_consorts = 1 }
								}
							}
						}
					}
				}
			}
		}
		allow = {
			is_lover = FROM
			OR = {
				trait = homosexual
				trait = bisexual
			}
			liege= {
				ROOT = {
					NOT = { is_primary_heir = PREV }
				}
			}
		}
		effect = {
			FROM = { add_spouse = ROOT }
			FROM = { character_event = { id = 500 } }
			FROM = {
				if = {
					limit = { real_tier = EMPEROR }
					prestige = -400
				}
				if = {
					limit = { real_tier = KING }
					prestige = -300
				}
				if = {
					limit = { real_tier = DUKE }
					prestige = -200
				}
				if = {
					limit = { real_tier = COUNT }
					prestige = -100
				}
				if = {
					limit = { real_tier = BARON }
					prestige = -10
				}
			}
		}
		ai_will_do = {
			factor = 1 # Will tweak later
			modifier = {
				factor = 0.1
				any_child = {
					count == 0
				}
			}
		}
	}

	same_gender_consort = {
		only_rulers = yes
		ai_check_interval = 24
		filter = all
		ai_target_filter = realm # wish there was a better way, don't want to use "all" for the AI

		from_potential = {
			OR = {
				trait = homosexual
				trait = bisexual
			}
			OR = {
				AND = {
					NOT = { num_of_consorts = 1 }
					OR = {
						religion = deities_of_fury
						religion = dead_three
						religion = church_of_cyric
						religion = beholder_pantheon
					}
				}
				AND = {
					NOT = { num_of_consorts = 2 }
					OR = {
						religion = joyful
						religion = shadow_gods
						religion = scale_cult
						religion = kiaransalee
						religion = draconic_pantheon
						religion = goblin_pantheon
						AND = {
							religion = goblin_reformed
							NOT = {
								has_religion_feature = religion_harems
							}
						}
					}
				}
				AND = {
					NOT = { num_of_consorts = 3 }
					OR = {
						government = tribal_government
						government = nomadic_tribal_government
						religion = kossuth
						religion = primordial
						uthgardt_faith_trigger = yes
						religion = ubtao_worship
						religion = ghaunadaur
						religion = abyssal_cult
						religion = infernal
						religion = thasmudyanic
						religion = vaprak
						religion = ulutiuan
						religion = toteteohuan
						religion = yuir
						religion = orc_pantheon
						AND = {
							OR = {
								religion = ulutiuan_reformed
								religion = toteteohuan_reformed
								religion = yuir_reformed
								religion = orc_reformed
							}
							NOT = {
								has_religion_feature = religion_harems
							}
						}
						AND = {
							religion_group = karaturan_group
							NOT = { religion = adama }
						}
						AND = {
							OR = {
								religion = geomancy
								religion = lolth_cult
							}
							is_female = yes
						}
						AND = {
							religion = tuigan_shamanism
							is_female = no
						}
					}
				}
			}
			NOR = {
				any_spouse = {
					character = ROOT
				}
				any_consort = {
					character = ROOT
				}
			}
		}
		potential = {
			OR = {
				AND = {
					is_female = yes
					FROM = { is_female = yes }
				}
				AND = {
					is_female = no
					FROM = { is_female = no }
				}
			}
			is_ruler = no
			ai = yes
			is_married = no
			is_married_matrilineally = no
			is_consort = no
			is_betrothed = no
		}
		allow = {
			is_lover = FROM
			OR = {
				trait = homosexual
				trait = bisexual
			}
			liege= {
				ROOT = {
					NOT = { is_primary_heir = PREV }
				}
			}
			liege= {
				has_concubinage = yes
			}
		}
		effect = {
			custom_tooltip = {
				text = same_gender_consort_effect_tt
				set_gender = opposite # needs to be the opposite gender for CK2 to allow the interaction 
				FROM = { add_consort = ROOT }
				set_gender = opposite # setting gender back
			}
			FROM = {
				if = {
					limit = { real_tier = EMPEROR }
					prestige = -400
				}
				if = {
					limit = { real_tier = KING }
					prestige = -300
				}
				if = {
					limit = { real_tier = DUKE }
					prestige = -200
				}
				if = {
					limit = { real_tier = COUNT }
					prestige = -100
				}
				if = {
					limit = { real_tier = BARON }
					prestige = -10
				}
			}
		}
		ai_will_do = {
			factor = 1 # Will tweak later
			modifier = {
				factor = 0.1
				any_child = {
					count == 0
				}
			}
		}
	}

	adopt_heir = {
		only_playable = yes
		ai_check_interval = 36
		filter = home_court
		ai_target_filter = home_court

		from_potential = {
			age = 40
			has_living_children = no
			NOT = { primary_title = { has_law = succ_open_elective } }
			NOR = { 
				government = divine_feudal_government # lineage determines rule
				government = chinese_imperial_government
				government = confucian_bureaucracy
			}
		}
		potential = {
			NOT = { trait = adopted }
			NOR = {
				any_dynasty_member = { is_alive = yes NOT = { character = ROOT } }
				any_close_relative = { is_alive = yes }
			}
			is_ruler = no
		}
		allow = {
			FROM = {
				NOT = { num_of_children = 4 } # children are not expendable
				custom_tooltip = {
					text = adoption_cooldown_tt
					hidden_tooltip = {
						OR = {
							NOT = { has_character_flag = adopted_foundling }
							had_character_flag = {
								flag = adopted_foundling
								years = 2
							}
						}
					}
				}
				OR = {
					fertility <= 0
					AND = {
						fertility <= 0.25
						age >= 50
						olrox_not_immortals_trigger = yes
					}
					AND = {
						age >= 60
						olrox_not_immortals_trigger = yes
					}
				}
				NOT = {
					has_character_modifier = recoveringfromchildbirth
				}
				NAND = {
					trait = celibate
					is_monastic_member_trigger = yes
				}
			}
			OR = {
				AND = {
					age <= 15
					opinion = {
						who = FROM
						value >= 25
					}
					NOT = { is_foe = FROM }
				}
				AND = {
					FROM = {
						is_older_than = ROOT
						age_diff = {
							who = ROOT
							years >= 25
						}
					}
					NOT = { is_foe = FROM }
					is_friend = FROM
				}
			}
			OR = {
				is_lowborn = yes
				dynastic_prestige <= 0
			}
			NOR = {
				is_married = yes
				is_betrothed = yes
				is_consort = yes
			}
			prisoner = no
			is_incapable = no
			custom_tooltip = {
				text = burgher_5_years_childless_tt
				hidden_tooltip = {
					FROM = {
						AND = {
							OR = {
								government = democratic_feudal_government
								government = merchant_republic_government
							}
							ruled_years = 5
							NOT = {
								any_child = {
									is_alive = yes
								}
							}
						}
					}
				}
			}
		}
		effect = {
			if = {
				limit = { FROM = { is_female = no } }
				set_father = FROM
			}
			else_if = {
				limit = { FROM = { is_female = yes } }
				set_mother = FROM
			}
			add_trait = adopted
			dynasty = FROM
			clear_wealth = yes
			any_owned_bloodline = {
				remove_bloodline_member = ROOT
			}
			FROM = {
				recalc_succession = yes
				clr_character_flag = adopted_foundling # for cooldown
				set_character_flag = adopted_foundling
				if = {
					limit = { real_tier = EMPEROR }
					prestige = -400
				}
				else_if = {
					limit = { real_tier = KING }
					prestige = -300
				}
				else_if = {
					limit = { real_tier = DUKE }
					prestige = -200
				}
				else_if = {
					limit = { real_tier = COUNT }
					prestige = -100
				}
				else_if = {
					limit = { real_tier = BARON }
					prestige = -10
				}
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.5
				FROM = { trait = proud }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = paranoid }
			}
			modifier = {
				factor = 2
				FROM = { trait = humble }
			}
			modifier = {
				factor = 2
				FROM = { trait = trusting }
			}
		}
	}
}

settlement_decisions = {

	rogue_take_over_crime = {
		is_high_prio = yes
		ai_check_interval = 100
		only_playable = yes
		filter = sub_realm_owned
		ai_target_filter = sub_realm_owned
		from_potential = {
			z_rogue = yes
		}
		potential = {
			location = {
				OR = {
					has_province_modifier = thieves_guild
					has_province_modifier = smugglers_ring
					has_province_modifier = highway_robber_band
				}
			}
		}
		allow = {
			FROM = { prestige = 50 }
		}
		effect = {
			FROM = { prestige = -50 }
			location = {
				add_province_modifier = {
					name = organized_crime
					months = 4
				}
				if = {
					limit = {
						has_province_modifier = thieves_guild
					}
					wealth = 50
					remove_province_modifier = thieves_guild
				}
				if = {
					limit = {
						has_province_modifier = smugglers_ring
					}
					wealth = 50
					remove_province_modifier = smugglers_ring
				}
				if = {
					limit = {
						has_province_modifier = highway_robber_band
					}
					wealth = 50
					remove_province_modifier = highway_robber_band
				}
			}
		}
		ai_will_do = {
			factor = 0.5
			modifier = {
				factor = 0.01
				trait = just
			}
			modifier = {
				factor = 1.7
				trait = greedy
			}
			modifier = {
				factor = 1.5
				trait = arbitrary
			}
		}
	}

}
