namespace = generalmisc


#On_death: mulhorandi kings and emperors get death masks
character_event = {
	id = generalmisc.1
	hide_window = yes

	only_rulers = yes

	is_triggered_only = yes

	trigger = { 
		higher_real_tier_than = DUKE
		culture = mulhorandi
		age = 16
	}
	immediate = { 
		add_trait = deathmask
	}
}

character_event = { #disease immune remove disease
	id = generalmisc.2
	desc = evilcatlocbugevent
	hide_window = yes
	is_triggered_only = yes


	trigger = {
		has_disease_trigger = yes
	}

	immediate = {
		remove_disease_trait_effect = yes
	}
}

character_event = { #lower fertility every child for true immortal characters
	id = generalmisc.3
	hide_window = yes
	is_triggered_only = yes #on_birth
	desc = evilcatlocbugevent

	trigger = {
		OR = {
			father = {
				faerun_immortal_race_trigger = yes
			}
			mother = {
				faerun_immortal_race_trigger = yes
			}
		}
	}

	immediate = {
		mother = {
			if = {
				limit = {
					faerun_immortal_race_trigger = yes
				}
				random = {
					chance = 50
					fertility = -0.1
				}
			}
		}
		father = {
			if = {
				limit = {
					faerun_immortal_race_trigger = yes
				}
				random = {
					chance = 50
					fertility = -0.1
				}
			}
		}
	}
}

#Thayan nobles get tattoos.
character_event = {
	id = generalmisc.4
	hide_window = yes

	is_triggered_only = yes
	min_age = 15
	culture = thayan
	prisoner = no

	trigger = { 
		is_lowborn = no
		z_tattooed = no
	}

	immediate = { 
		random_list = {
			1 = {
				add_trait = thayan_tattoo_1
			}
			1 = {
				add_trait = thayan_tattoo_2
			}
			1 = {
				add_trait = thayan_tattoo_3
			}
			1 = {
				add_trait = thayan_tattoo_4
			}
			1 = {
				add_trait = thayan_tattoo_5
			}
			1 = {
				add_trait = thayan_tattoo_6
			}
			1 = {
				add_trait = thayan_tattoo_7
			}
			1 = {
				add_trait = thayan_tattoo_8
			}
			1 = {
				add_trait = thayan_tattoo_9
			}
			1 = {
				add_trait = thayan_tattoo_10
			}
			1 = {
				add_trait = thayan_tattoo_11
			}
			1 = {
				add_trait = thayan_tattoo_12
			}
			1 = {
				add_trait = thayan_tattoo_13
			}
			1 = {
				add_trait = thayan_tattoo_14
			}
		}
	}
}


#Paladin Oaths
character_event = {
	id = generalmisc.5
	desc = GENMISC.5
	picture = GFX_evt_angels_1
	
	is_triggered_only = yes
	
	option = {
		name = GENMISC.5a
		add_character_modifier = {
			name = oath_of_the_ancients
			duration = -1
		}
	}
	
	option = {
		name = GENMISC.5b
		add_character_modifier = {
			name = oath_of_the_crown
			duration = -1
		}
	}
	
	option = {
		name = GENMISC.5c
		add_character_modifier = {
			name = oath_of_devotion
			duration = -1
		}
	}
	
	option = {
		trigger = { ai = no }
		name = TB_OPT_MORE
		character_event = { id = generalmisc.6 }
	}
	
	option = {
		trigger = { ai = yes }
		name = GENMISC.5c
		add_character_modifier = {
			name = oath_of_vengeance
			duration = -1
		}
	}
	
	option = {
		trigger = {
			ai = yes
			is_evil_religion = no
		}
		name = GENMISC.5c
		add_character_modifier = {
			name = oath_of_redemption
			duration = -1
		}
	}
	
	option = {
		trigger = {
			ai = yes
			is_evil_religion = yes
		}
		name = GENMISC.5c
		add_character_modifier = {
			name = oath_of_conquest
			duration = -1
		}
	}
}

character_event = {
	id = generalmisc.6
	desc = GENMISC.5
	picture = GFX_evt_angels_1
	
	is_triggered_only = yes
	
	option = {
		name = GENMISC.6a
		add_character_modifier = {
			name = oath_of_vengeance
			duration = -1
		}
	}
	
	option = {
		trigger = {
			is_evil_religion = no
		}
		name = GENMISC.6b
		add_character_modifier = {
			name = oath_of_redemption
			duration = -1
		}
	}
	
	option = {
		trigger = {
			is_evil_religion = yes
		}
		name = GENMISC.6c
		add_character_modifier = {
			name = oath_of_conquest
			duration = -1
		}
	}
	
	option = {
		trigger = { ai = no }
		name = TB_OPT_BACK
		character_event = { id = generalmisc.5 }
	}
}

#Ranger Terrain Pick
character_event = {
	id = generalmisc.7
	desc = GENMISC.7
	picture = GFX_evt_savannah_a
	
	is_triggered_only = yes
	
	option = {
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				location = {
					NOR = {
						region = calimshan_region
						region = chult_region
						region = laerakond_region
						region = zakhara_region
						region = salju_shan_region
						region = lapaliiya_region
						region = anauroch_region
						region = quoya_desert_region
						region = raurin_region
					}
				}
			}
		}
		name = GENMISC.7a
		add_trait = desert_terrain_leader
	}
	
	option = {
		ai_chance = {
			factor = 10
		}
		name = GENMISC.7b
		add_trait = flat_terrain_leader
	}
	
	option = {
		name = GENMISC.7c
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				location = {
					NOR = {
						region = lapaliiya_region
						region = chultan_peninsula_region
						region = salju_shan_region
						region = zakhara_region
					}
				}
			}
		}
		add_trait = jungle_terrain_leader
	}
	
	option = {
		trigger = { ai = no }
		name = TB_OPT_MORE
		character_event = { id = generalmisc.8 }
	}
	
	option = {
		trigger = { ai = yes }
		ai_chance = {
			factor = 10
		}
		name = GENMISC.7c
		add_trait = mountain_terrain_leader
	}
	
	option = {
		trigger = {
			ai = yes
		}
		ai_chance = {
			factor = 10
		}
		name = GENMISC.7c
		add_trait = rough_terrain_leader
	}
	option = {
		trigger = {
			ai = yes
		}
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				location = {
					NOR = {
						region = icewind_dale_region
						region = sword_coast_north_region
						region = silver_marches_region
						region = savage_frontier_region
						region = tortured_lands_region
						region = narfell_region
						region = sossal_region
						region = the_endless_wastes_region
						region = ama_region
						region = horse_plains_region
						region = frozenfar_region
					}
				}
			}
		}
		name = GENMISC.7c
		add_trait = winter_soldier
	}
}

character_event = {
	id = generalmisc.8
	desc = GENMISC.7
	picture = GFX_evt_savannah_a
	
	is_triggered_only = yes
	
	option = {
		name = GENMISC.8a
		add_trait = mountain_terrain_leader
	}
	
	option = {
		name = GENMISC.8b
		add_trait = rough_terrain_leader
	}
	
	option = {
		name = GENMISC.8c
		add_trait = winter_soldier
	}
	
	option = {
		trigger = { ai = no }
		name = TB_OPT_BACK
		character_event = { id = generalmisc.7 }
	}
}

character_event = {
	id = generalmisc.9
	desc = GENMISC.9
	picture = GFX_evt_monastery_monks
	
	is_triggered_only = yes
	
	option = {
		name = GENMISC.9a
		add_character_modifier = {
			name = monk_diplo
			duration = -1
		}
	}
	
	option = {
		name = GENMISC.9b
		add_character_modifier = {
			name = monk_martial
			duration = -1
		}
	}
	
	option = {
		name = GENMISC.9c
		add_character_modifier = {
			name = monk_stewardship
			duration = -1
		}
	}
	
	option = {
		name = TB_OPT_MORE
		character_event = { id = generalmisc.10 }
	}
}

character_event = {
	id = generalmisc.10
	desc = GENMISC.9
	picture = GFX_evt_monastery_monks
	
	is_triggered_only = yes
	
	option = {
		name = GENMISC.10a
		add_character_modifier = {
			name = monk_intrigue
			duration = -1
		}
	}
	
	option = {
		name = GENMISC.10b
		add_character_modifier = {
			name = monk_learning
			duration = -1
		}
	}
	
	option = {
		name = GENMISC.10c
	}
	
	option = {
		name = TB_OPT_BACK
		character_event = { id = generalmisc.9 }
	}
}

character_event ={
	id = generalmisc.11
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOR = {
			trait = creature_aboleth
			trait = creature_illithid
			trait = creature_ulitharid
			trait = creature_elder_brain
			AND = {
				trait = creature_dragon
				gfx_culture_scope = {
					OR = {
						culture = amethyst_dragon
						culture = sapphire_dragon
						culture = topaz_dragon
						culture = emerald_dragon
						culture = crystal_dragon
					}
				}
			}
			olrox_has_specific_sorc_origin = yes
		}
	}
	
	weight_multiplier = {
		factor = 1
		modifier = {
			factor = 50
			trait = creature_gith
		}
		modifier = {
			factor = 40
			OR = {
				gfx_culture_scope = {
					culture = duergar
				}
				trait = creature_yikarian
			}
		}
		modifier = {
			factor = 25
			OR = {
				trait = creature_pureblood
				trait = creature_malison
				trait = creature_abomination
				gfx_culture_scope = {
					culture = derro
				}
			}
		}
		modifier = {
			factor = 10
			trait = creature_drow
		}
		modifier = {
			factor = 5
			gfx_culture_scope = {
				OR = {
					culture = crinti
					culture = chondathan
					culture = tashalan
					culture = thinguth
					culture = vilhonian
					culture = halruaan
				}
			}
		}
		modifier = {
			factor = 20
			OR = {
				mother_even_if_dead = {
					trait = psi_potential
				}
				true_father_even_if_dead = {
					trait = psi_potential
				}
			}
		}
		modifier = {
			factor = 10
			OR = {
				mother_even_if_dead = {
					OR = {
						mother_even_if_dead = {
							trait = psi_potential
						}
						true_father_even_if_dead = {
							trait = psi_potential
						}
					}
				}
				true_father_even_if_dead = {
					OR = {
						mother_even_if_dead = {
							trait = psi_potential
						}
						true_father_even_if_dead = {
							trait = psi_potential
						}
					}
				}
			}
		}
	}
	
	immediate = {
		set_character_flag = psionic_flag
		character_event = { id = generalmisc.12 years = 13 random = 1080 }
	}
}

character_event ={
	id = generalmisc.12
	desc = GENMISC.12
	picture = GFX_evt_ioun_stones
	
	is_triggered_only = yes
	
	option = {
		name = GENMISC.12a
		add_trait = psi_potential
		hidden_tooltip = {
			guardian = {
				if = {
					limit = {
						NOR = {
							is_father = ROOT
							is_mother = ROOT
						}
					}
					character_event = { id = generalmisc.13 }
				}
			}
			mother = {
				character_event = { id = generalmisc.13 }
			}
			father = {
				character_event = { id = generalmisc.13 }
			}
		}
	}
}

character_event = {
	id = generalmisc.13
	desc = {
		trigger = {
			any_child = {
				NOT = { character = FROM }
			}
		}
		text = GENMISC.13a
	}
	desc = {
		trigger = {
			any_child = {
				character = FROM
			}
		}
		text = GENMISC.13b
	}
	picture = GFX_evt_ioun_stones
	portrait = FROM
	
	is_triggered_only = yes
	
	option = {
		name = GENMISC.13c
		FROM = { add_trait = psi_potential }
	}
}

character_event = {
	id = generalmisc.14
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_character_modifier = small_psi_stress
			}
			remove_character_modifier = small_psi_stress
		}
		else_if = {
			limit = {
				has_character_modifier = medium_psi_stress
			}
			remove_character_modifier = medium_psi_stress
			add_character_modifier = {
				name = small_psi_stress
				duration = -1
			}
		}
		else_if = {
			limit = {
				has_character_modifier = big_psi_stress
			}
			remove_character_modifier = big_psi_stress
			add_character_modifier = {
				name = medium_psi_stress
				duration = -1
			}
		}
		if = {
			limit = {
				z_psion = yes # sanity check
			}
			repeat_event = { id = generalmisc.14 months = 4 }
		}
		else_if = {
			limit = {
				z_psion = no
			}
			remove_character_modifier = small_psi_stress
			remove_character_modifier = medium_psi_stress
			remove_character_modifier = big_psi_stress
		}
	}
}

character_event = {
	id = generalmisc.15
	desc = GENMISC.15
	picture = GFX_evt_mind_flayers_2
	
	is_triggered_only = yes
	
	option = {
		name = GENMISC.15a
		remove_trait = creature_illithid
		remove_trait = creature_ulitharid
		add_trait = creature_elder_brain
		set_graphical_culture = elder_brain
	}
}

character_event = {
	id = generalmisc.16
	desc = GENMISC.16
	picture = GFX_evt_ioun_stones
	
	is_triggered_only = yes
	
	option = {
		name = GENMISC.16a
		add_trait = psi_potential
	}
}

character_event = {
	id = generalmisc.17
	desc = GENMISC.17
	picture = GFX_evt_battle
	notification = yes
	
	is_triggered_only = yes
	
	trigger = {
		religion = martial_faith
	}
	
	option = {
		name = OK
		piety = 5
	}
}

#on_create_title
character_event = {
	id = generalmisc.18
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		FROM = {
			higher_real_tier_than = COUNT
		}
		ROOT = {
			religion = dead_three
		}
	}
	
	immediate = {
		FROM = {
			if = {
				limit = {
					real_tier = DUKE
				}
				ROOT = { prestige = 50 }
			}
			else_if = {
				limit = {
					real_tier = KING
				}
				ROOT = { prestige = 100 }
			}
			else_if = {
				limit = {
					real_tier = EMPEROR
				}
				ROOT = { prestige = 200 }
			}
		}
	}
}

character_event = {
	id = generalmisc.19
	desc = GENMISC.19
	picture = GFX_evt_bane_1
	
	is_triggered_only = yes
	
	option = {
		trigger = {
			OR = {
				z_cleric = yes
				z_paladin = yes
			}
		}
		name = GENMISC.19a
		piety = 200
		grant_title = k_black_altar
		k_black_altar = {
			add_law = true_cognatic_succession
			add_law = succ_divine_cleric
		}
	}
	
	option = {
		ai_chance = {
			factor = 0
			modifier = {
				factor = 0
				trait = chosen_bane
			}
		}
		name = GENMISC.19b
		piety = 400
		create_character = {
			age = 40
			attributes = {
				learning = 8
			}
			trait = scholarly_theologian
			random_traits = yes
			trait = master_cleric
			trait = zealous
			religion = dead_three
			culture = ROOT
			dynasty = culture
		}
		new_character = {
			character_event = { id = character_trait.1 }
			random_list = {
				5 = {
					add_trait = patron_bane
				}
				3 = {
					add_trait = patron_myrkul
				}
				2 = {
					add_trait = patron_bhaal
				}
				1 = {
					add_trait = patron_iyachtu_xvim
				}
			}
			grant_title = k_black_altar
			k_black_altar = {
				add_law = true_cognatic_succession
				add_law = succ_divine_cleric
			}
			if = {
				limit = {
					ROOT = { tier = EMPEROR }
				}
				set_defacto_liege = ROOT
			}
		}
	}
}

character_event = {
	id = generalmisc.20
	desc = GENMISC.20
	picture = GFX_evt_wish_1
	
	is_triggered_only = yes
	
	option = {
		name = GENMISC.20a
		prestige = 300
		create_character = {
			age = 40
			attributes = {
				learning = 8
			}
			trait = scholarly_theologian
			random_traits = yes
			trait = master_wizard
			trait = zealous
			trait = patron_mystra
			religion = arcane
			culture = ROOT
			dynasty = culture
		}
		new_character = {
			character_event = { id = character_trait.1 }
			grant_title = d_magister
			d_magister = {
				add_law = true_cognatic_succession
				add_law = succ_magister
			}
			if = {
				limit = {
					ROOT = { higher_real_tier_than = DUKE }
				}
				set_defacto_liege = ROOT
			}
		}
	}
}

character_event = {
	id = generalmisc.21
	desc = WIZINIT.34
	picture = GFX_evt_demons_1

	is_triggered_only = yes

	option = {
		name = WIZINIT.34.a
		set_character_flag = abyss_summon_demons
		character_event = { id = generalmisc.22 days = 1000 }
		location = {
			ROOT = {
				spawn_unit = {
					province = PREV
					home = PREV
					owner = ROOT
					leader = ROOT
					earmark = abysssummonedfiends
					troops = {
						light_infantry = { 700 700 }
						beast_troops = { 50 50 }
					}
					attrition = 0.5
					maintenance_multiplier = 0.1
					cannot_inherit = yes
					disband_on_peace = yes
					can_toggle_looting = no
					is_looter = no
					reinforces = no
				}
			}
		}
	}
}

character_event = {
	id = generalmisc.22
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		had_character_flag = {
			flag = abyss_summon_demons
			years = 2
		}
	}

	immediate = {
		clr_character_flag = abyss_summon_demons
		if = {
			limit = {
				has_earmarked_regiments = abysssummonedfiends
			}
			disband_event_forces = abysssummonedfiends
			character_event = { id = generalmisc.23 }
		}
	}
}

character_event = {
	id = generalmisc.23
	desc = WIZINIT.36
	picture = GFX_evt_demons_1
	notification = yes

	is_triggered_only = yes

	option = {
		name = OK
	}
}

character_event = {
	id = generalmisc.24
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		religion = abyssal_cult
		OR = {
			AND = {
				trait = impaler
				has_character_modifier = abyssal_impaler
			}
			AND = {
				trait = lustful
				has_character_modifier = abyssal_lustful
			}
			AND = {
				trait = gluttonous
				has_character_modifier = abyssal_gluttonous
			}
			AND = {
				trait = greedy
				has_character_modifier = abyssal_greedy
			}
			AND = {
				trait = slothful
				has_character_modifier = abyssal_slothful
			}
			AND = {
				trait = wroth
				has_character_modifier = abyssal_wroth
			}
			AND = {
				trait = envious
				has_character_modifier = abyssal_envious
			}
			AND = {
				trait = proud
				has_character_modifier = abyssal_proud
			}
			AND = {
				trait = cruel
				has_character_modifier = abyssal_cruel
			}
			AND = {
				trait = deceitful
				has_character_modifier = abyssal_deceitful
			}
			AND = {
				trait = possessed
				has_character_modifier = abyssal_possessed
			}
		}
	}
	
	immediate = {
		if = {
			limit = {
				trait = impaler
				NOT = { has_character_modifier = abyssal_impaler }
			}
			add_character_modifier = {
				name = abyssal_impaler
				duration = -1
			}
		}
		if = {
			limit = {
				trait = lustful
				NOT = { has_character_modifier = abyssal_lustful }
			}
			add_character_modifier = {
				name = abyssal_lustful
				duration = -1
			}
		}
		if = {
			limit = {
				trait = gluttonous
				NOT = { has_character_modifier = abyssal_gluttonous }
			}
			add_character_modifier = {
				name = abyssal_gluttonous
				duration = -1
			}
		}
		if = {
			limit = {
				trait = greedy
				NOT = { has_character_modifier = abyssal_greedy }
			}
			add_character_modifier = {
				name = abyssal_greedy
				duration = -1
			}
		}
		if = {
			limit = {
				trait = slothful
				NOT = { has_character_modifier = abyssal_slothful }
			}
			add_character_modifier = {
				name = abyssal_slothful
				duration = -1
			}
		}
		if = {
			limit = {
				trait = wroth
				NOT = { has_character_modifier = abyssal_wroth }
			}
			add_character_modifier = {
				name = abyssal_wroth
				duration = -1
			}
		}
		if = {
			limit = {
				trait = envious
				NOT = { has_character_modifier = abyssal_envious }
			}
			add_character_modifier = {
				name = abyssal_envious
				duration = -1
			}
		}
		if = {
			limit = {
				trait = proud
				NOT = { has_character_modifier = abyssal_proud }
			}
			add_character_modifier = {
				name = abyssal_proud
				duration = -1
			}
		}
		if = {
			limit = {
				trait = cruel
				NOT = { has_character_modifier = abyssal_cruel }
			}
			add_character_modifier = {
				name = abyssal_cruel
				duration = -1
			}
		}
		if = {
			limit = {
				trait = deceitful
				NOT = { has_character_modifier = abyssal_deceitful }
			}
			add_character_modifier = {
				name = abyssal_deceitful
				duration = -1
			}
		}
		if = {
			limit = {
				trait = possessed
				NOT = { has_character_modifier = abyssal_possessed }
			}
			add_character_modifier = {
				name = abyssal_possessed
				duration = -1
			}
		}
	}
}

character_event = {
	id = generalmisc.25
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { religion = abyssal_cult }
		OR = {
			has_character_modifier = abyssal_impaler
			has_character_modifier = abyssal_lustful
			has_character_modifier = abyssal_gluttonous
			has_character_modifier = abyssal_greedy
			has_character_modifier = abyssal_slothful
			has_character_modifier = abyssal_wroth
			has_character_modifier = abyssal_envious
			has_character_modifier = abyssal_proud
			has_character_modifier = abyssal_cruel
			has_character_modifier = abyssal_deceitful
			has_character_modifier = abyssal_possessed
		}
	}
	
	immediate = {
		remove_character_modifier = abyssal_impaler
		remove_character_modifier = abyssal_lustful
		remove_character_modifier = abyssal_gluttonous
		remove_character_modifier = abyssal_greedy
		remove_character_modifier = abyssal_slothful
		remove_character_modifier = abyssal_wroth
		remove_character_modifier = abyssal_envious
		remove_character_modifier = abyssal_proud
		remove_character_modifier = abyssal_cruel
		remove_character_modifier = abyssal_deceitful
		remove_character_modifier = abyssal_possessed
	}
}

character_event = {
	id = generalmisc.26
	desc = GENMISC.26
	picture = GFX_evt_orcs
	
	is_triggered_only = yes
	
	option = {
		name = GENMISC.26a
	}
}