namespace = CDR

# start delving
character_event = {
	id = CDR.200
	desc = EVTDESC_CDR_200
	picture = GFX_evt_library

	is_triggered_only = yes

	option = {
		name = EVTOPTA_CDR_200

		character_event = { id = CDR.201 days = 90 }
  }
}

# random delving result
character_event = {
	id = CDR.201
	desc = EVTDESC_CDR_201
	picture = GFX_evt_library

	is_triggered_only = yes

	option = {
		name = EVTOPTA_CDR_201
		random_list = {
			60 = {
				add_character_modifier = {
					name = forbidden_knowledge
					years = 5
				}
			}
			10 = {
				if = {
					limit = {
						trait = lunatic
					}
					add_character_modifier = {
						name = forbidden_knowledge
						years = 5
					}
				}
				else = {
					add_trait = lunatic
				}
			}
			10 = {
				add_trait = erudite
				if = {
					limit = {
						trait = detached_priest
					}
					hidden_tooltip = { remove_trait = detached_priest }
					add_trait = martial_cleric
					break = yes
				}
				if = {
					limit = {
						trait = martial_cleric
					}
					hidden_tooltip = { remove_trait = martial_cleric }
					add_trait = scholarly_theologian
					break = yes
				}
				if = {
					limit = {
						trait = scholarly_theologian
					}
					hidden_tooltip = { remove_trait = scholarly_theologian }
					add_trait = mastermind_theologian
				}
			}
			10 = {
				add_trait = diligent
				if = {
					limit = {
						trait = detached_priest
					}
					hidden_tooltip = { remove_trait = detached_priest }
					add_trait = martial_cleric
					break = yes
				}
				if = {
					limit = {
						trait = martial_cleric
					}
					hidden_tooltip = { remove_trait = martial_cleric }
					add_trait = scholarly_theologian
					break = yes
				}
				if = {
					limit = {
						trait = scholarly_theologian
					}
					hidden_tooltip = { remove_trait = scholarly_theologian }
					add_trait = mastermind_theologian
				}
			}
			10 = {
				if = {
					limit = {
						trait = cruel
					}
					add_trait = brave
				}
				else = {
					add_trait = cruel
				}
			}
		}
  }

	option = {
		name = EVTOPTB_CDR_201
		random = {
			chance = 30
			add_trait = content
		}
		piety = 30
  }
}

# minor gift
character_event = {
	id = CDR.300
	desc = EVTDESC_CDR_300
	picture = GFX_evt_treasure

	is_triggered_only = yes

	option = {
		name = EVTOPTA_CDR_300
		random_list = {
			4 = {
				add_artifact = berserker_axe
			}
			2 = {
				add_artifact = flame_tongue
			}
			2 = {
				add_artifact = frost_brand
			}
			2 = {
				add_artifact = life_drinker
			}
			2 = {
				add_artifact = mace_of_terror
			}
			2 = {
				add_artifact = oathbow
			}
			2 = {
				add_artifact = sword_of_sharpness
			}
			4 = {
				add_artifact = sword_of_life_stealing
			}
			4 = {
				add_artifact = sword_of_wounding
			}
			4 = {
				add_artifact = trident_of_warning
			}
			4 = {
				add_artifact = lesser_rod_pact_keeper
			}
			2 = {
				add_artifact = normal_rod_pact_keeper
			}
			2 = {
				add_artifact = staff_of_swarming_insects
			}
			2 = {
				add_artifact = staff_python
			}
			2 = {
				add_artifact = dagger_of_lifekeeping
			}
			2 = {
				add_artifact = sylvan_scimitar
			}
			2 = {
				add_artifact = sword_of_subtlety
			}
			2 = {
				add_artifact = arrowcatching_shield
			}
			2 = {
				add_artifact = wand_of_binding
			}
			2 = {
				add_artifact = wand_of_fear
			}
			2 = {
				add_artifact = wand_of_fireballs
			}
			2 = {
				add_artifact = wand_of_lightning
			}
			2 = {
				add_artifact = greater_wand_war_mage
			}
			4 = {
				add_artifact = dagger_of_venom
			}
			4 = {
				add_artifact = javelin_of_lightning
			}
			4 = {
				add_artifact = flensing_gauntlet
			}
			4 = {
				add_artifact = sentinel_shield
			}
			4 = {
				add_artifact = shield_missile_attraction
			}
			4 = {
				add_artifact = wand_magic_missile
			}
			4 = {
				add_artifact = wand_of_web
			}
			4 = {
				add_artifact = normal_wand_war_mage
			}
			4 = {
				add_artifact = glamoured_studded_leather
			}
			2 = {
				add_artifact = demon_armor
			}
			2 = {
				add_artifact = elven_chain
			}
			2 = {
				add_artifact = dragon_scale_mail
			}
			2 = {
				add_artifact = robe_of_eyes
			}
		}
		new_artifact = {
			set_creation_date = 1.1.1
		}
  }
}

# established cell
character_event = {
	id = CDR.400
	desc = EVTDESC_CDR_400
	picture = GFX_evt_secret_ceremony
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	option = {
		name = EVTOPTA_CDR_400
		event_target:target_cult_province = {
			add_province_modifier = {
				name = secret_cult_cell
				duration = -1
			}
		}
	}
}

# Valuable Obtained
character_event = {
	id = CDR.401
	desc = EVTDESC_CDR_401
	picture = GFX_evt_treasure

	trigger = {
		society_member_of = cult_of_the_dragon
		any_demesne_province = {
	    has_province_modifier = secret_cult_cell
		}
	}

	mean_time_to_happen = {
		months = 24
	}

	option = {
		name = EVTOPTA_CDR_401

		scaled_wealth = 0.2
	}
}

# Cell in trouble
character_event = {
	id = CDR.402
	desc = EVTDESC_CDR_402
	picture = GFX_evt_bad_news

	trigger = {
		society_member_of = cult_of_the_dragon
		any_demesne_province = {
	    has_province_modifier = secret_cult_cell
		}
	}

	mean_time_to_happen = {
		months = 48
	}

	option = { #save cell
		name = EVTOPTA_CDR_402

		scaled_wealth = -0.1
	}

	option = { #lose cell
		name = EVTOPTB_CDR_402

		detract_society_currency_minor_effect = yes
		any_demesne_province = {
			remove_province_modifier = secret_cult_cell
		}
	}
}

# Hostile Cell
character_event = {
	id = CDR.403
	desc = EVTDESC_CDR_403
	picture = GFX_evt_secret_ceremony

	trigger = {
		NOT = {
			society_member_of = cult_of_the_dragon
		}
		any_demesne_province = {
	    has_province_modifier = secret_cult_cell
		}
	}

	mean_time_to_happen = {
		months = 60
	}

	option = { #lose money
		name = EVTOPTA_CDR_403

		scaled_wealth = -0.05
	}

	option = { #destroy cell
		name = EVTOPTB_CDR_403

		scaled_wealth = -0.2
		random_list = {
			80 = {
				any_demesne_province = {
					remove_province_modifier = secret_cult_cell
				}
			}			
			20 = {
				prestige = -10
			}
		}
	}
}

# Good working cell
character_event = {
	id = CDR.404
	desc = EVTDESC_CDR_404
	picture = GFX_evt_secret_ceremony

	trigger = {
		society_member_of = cult_of_the_dragon
		any_demesne_province = {
	    has_province_modifier = secret_cult_cell
		}
	}

	mean_time_to_happen = {
		months = 120
	}

	option = {
		name = EVTOPTA_CDR_404

		add_society_currency_minor_effect = yes
	}
}

# Become undead
character_event = {
  id = CDR.500
  is_triggered_only = yes
  desc = EVTDESC_CDR_500
  picture = GFX_evt_death_knight

  option = { #vampire
    name = EVTOPTA_CDR_500

    add_trait = vampire
  }

	option = { #lich
    name = EVTOPTB_CDR_500
		trigger = {
			OR = {
				trait = expert_wizard
				trait = master_wizard
				trait = renowned_wizard
				trait = legendary_wizard
				trait = expert_sorcerer
				trait = master_sorcerer
				trait = renowned_sorcerer
				trait = legendary_sorcerer
				trait = expert_cleric
				trait = master_cleric
				trait = renowned_cleric
				trait = legendary_cleric
				trait = expert_warlock
				trait = master_warlock
				trait = renowned_warlock
				trait = legendary_warlock
			}
		}

    add_trait = lich
  }
}
